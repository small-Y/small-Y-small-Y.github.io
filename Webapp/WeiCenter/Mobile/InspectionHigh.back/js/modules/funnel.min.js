/*
 
 Highcharts funnel module

 (c) 2010-2016 Torstein Honsi

 License: www.highcharts.com/license
*/(function(b){"object"===typeof module&&module.exports?module.exports=b:b(Highcharts)})(function(b){var u=b.getOptions(),A=u.plotOptions,v=b.seriesTypes,K=b.merge,I=function(){},F=b.each,J=b.pick;A.funnel=K(A.pie,{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}});v.funnel=b.extendClass(v.pie,{type:"funnel",animate:I,translate:function(){var a=function(m,a){return/%$/.test(m)?a*parseInt(m,10)/100:parseInt(m,10)},b=0,f=this.chart,c=this.options,g=c.reversed,n=c.ignoreHiddenPoint,h=f.plotWidth,d=f.plotHeight,u=0,f=c.center,k=a(f[0],h),B=a(f[1],d),v=a(c.width,h),p,w,e=a(c.height,d),x=a(c.neckWidth,h),G=a(c.neckHeight,d),y=B-e/2+e-G,a=this.data,C,D,A="left"===c.dataLabels.position?1:0,E,q,H,t,l,z,r;this.getWidthAt=w=function(m){var a=B-e/2;return m>y||e===G?x:x+(v-x)*(1-(m-a)/(e-G))};this.getX=function(m,a){return k+(a?-1:1)*(w(g?d-m:m)/2+c.dataLabels.distance)};this.center=[k,B,e];this.centerX=k;F(a,function(a){n&&!1===a.visible||(b+=a.y)});F(a,function(a){r=null;D=b?a.y/b:0;q=B-e/2+u*e;l=q+D*e;p=w(q);E=k-p/2;H=E+p;p=w(l);t=k-p/2;z=t+p;q>y?(E=t=k-x/2,H=z=k+x/2):l>y&&(r=l,p=w(y),t=k-p/2,z=t+p,l=y);g&&(q=e-q,l=e-l,r=r?e-r:null);C=["M",E,q,"L",H,q,z,l];r&&C.push(z,r,t,r);C.push(t,l,"Z");a.shapeType="path";a.shapeArgs={d:C};a.percentage=100*D;a.plotX=k;a.plotY=(q+(r||l))/2;a.tooltipPos=[k,a.plotY];a.slice=I;a.half=A;n&&!1===a.visible||(u+=D)})},drawPoints:function(){var a=this,b=a.options,f=a.chart.renderer,c,g,n,h;F(a.data,function(d){c=d.options;h=d.graphic;n=d.shapeArgs;g={fill:d.color,stroke:J(c.borderColor,b.borderColor),"stroke-width":J(c.borderWidth,b.borderWidth)};h?h.attr(g).animate(n):d.graphic=f.path(n).attr(g).add(a.group)})},sortByAngle:function(a){a.sort(function(a,b){return a.plotY-b.plotY})},drawDataLabels:function(){var a=this.data,b=this.options.dataLabels.distance,f,c,g,n=a.length,h,d;for(this.center[2]-=2*b;n--;)g=a[n],c=(f=g.half)?1:-1,d=g.plotY,h=this.getX(d,f),g.labelPos=[0,d,h+(b-5)*c,d,h+b*c,d,f?"right":"left",0];v.pie.prototype.drawDataLabels.call(this)}});u.plotOptions.pyramid=b.merge(u.plotOptions.funnel,{neckWidth:"0%",neckHeight:"0%",reversed:!0});b.seriesTypes.pyramid=b.extendClass(b.seriesTypes.funnel,{type:"pyramid"})});