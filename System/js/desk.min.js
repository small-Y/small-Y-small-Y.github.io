SmartDeskTop = function(d, b) {
    return {
        init: function() {
            this.container = d;
            var a = b ? b : {};
            this.bTensile = a.bTensile ? a.bTensile : !1;
            this.imgWrapper = a.imgWrapper;
            this.videoWrapper = a.videoWrapper;
            this.id = a.id ? a.id : 0;
            this.bTensile ? this.videoWrapper && "" != this.videoWrapper ? /Android/.test(navigator.userAgent) ? $("#" + this.container).html('\x3cdiv class\x3d"desktopWrapper"\x3e\x3cimg src\x3d"' + this.imgWrapper + '" width\x3d"100%" height\x3d"100%" style\x3d"position:absolute;top:0;left:0;z-index:-1" onerror\x3d"this.style.display\x3d\'none\'"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Panel class\x3d"desktopPanel"\x3e\x3c/div\x3e') : $("#" + this.container).html('\x3cdiv class\x3d"desktopWrapper"\x3e\x3cvideo muted\x3d"muted" autoplay\x3d"autoplay" preload\x3d"none" loop\x3d"loop" poster\x3d"' + this.imgWrapper + '" style\x3d"position: absolute;top: 0;left: 0;width: 100%;height: 100%;object-fit: fill;"\x3e\t\t\x3csource src\x3d"' + this.videoWrapper + '" type\x3d"video/mp4" style\x3d"position:absolute;top:0;left:0;z-index:-1" onerror\x3d"this.style.display\x3d\'none\'"\x3e \x3c/video\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Panel class\x3d"desktopPanel"\x3e\x3c/div\x3e') : this.imgWrapper && "" != this.imgWrapper ? $("#" + this.container).html('\x3cdiv class\x3d"desktopWrapper"\x3e\x3cimg src\x3d"' + this.imgWrapper + '" width\x3d"100%" height\x3d"100%" style\x3d"position:absolute;top:0;left:0;z-index:-1" onerror\x3d"this.style.display\x3d\'none\'"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Panel class\x3d"desktopPanel"\x3e\x3c/div\x3e') : $("#" + this.container).html('\x3cdiv class\x3d"desktopWrapper"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Panel class\x3d"desktopPanel"\x3e\x3c/div\x3e') : ($("#" + this.container).html('\x3cdiv class\x3d"desktopWrapper"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Panel class\x3d"desktopPanel"\x3e\x3c/div\x3e'),
            this.imgWrapper && "" != this.imgWrapper && $("#" + this.container + " .desktopWrapper").css("background", "transparent url(" + this.imgWrapper + ") repeat center top"))
        },
        setup: function(a) {
            var c = a ? a : {}
              , b = this.bTensile;
            this.bTensile = c.bTensile ? c.bTensile : !1;
            this.imgWrapper = c.imgWrapper;
            b && $("#" + this.container).find(".desktopWrapper").empty();
            this.bTensile ? $("#" + this.container).find(".desktopWrapper").html('\x3cimg src\x3d"' + this.imgWrapper + '" width\x3d"100%" height\x3d"100%" style\x3d "position:absolute;top:0;left:0;z-index:-1"\x3e') : this.imgWrapper && $("#" + this.container).find(".desktopWrapper").css("background", "transparent url(" + this.imgWrapper + ") repeat center top");
            $("#" + this.container).fadeTo("fast", 500);
            a.bTheme || $.ajax({
                type: "post",
                url: "/System/srv/setWrapper.ejs",
                data: {
                    bTensile: this.bTensile,
                    imgWrapper: this.imgWrapper,
                    deskTop: TUI.env.desktop
                },
                dataType: "text",
                error: function(a) {
                    playSound("error");
                    toastr.error("\u8bbe\u7f6e\u684c\u9762\u5899\u7eb8\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u684c\u9762\u5899\u7eb8\u8bbe\u5b9a")
                },
                success: function(a) {
                    "OK" == a ? (playSound("info"),
                    toastr.info("\u8bbe\u7f6e\u60a8\u7684\u684c\u9762\u5899\u7eb8\u6210\u529f\uff01", "\u684c\u9762\u5899\u7eb8\u8bbe\u5b9a")) : (playSound("warning"),
                    toastr.warn("\u8bbe\u7f6e\u684c\u9762\u5899\u7eb8\u4fdd\u5b58\u5931\u8d25\uff01", "\u684c\u9762\u5899\u7eb8\u8bbe\u5b9a"))
                }
            })
        },
        clear: function() {
            $("#" + this.container).find(".desktopWrapper").empty();
            $("#" + this.container).find(".desktopWrapper").css("background", "");
            $("#" + this.container).fadeTo("fast", 500)
        },
        blur: function(a) {
            $("#" + this.container).find(".desktopWrapper").css("-webkit-filter", "blur(" + a + "px)")
        },
        show: function(a) {
            $("#" + this.container).fadeIn(a)
        },
        hide: function(a) {
            $("#" + this.container).fadeOut(a)
        },
        getPanel: function() {
            return this.container + "_Panel"
        }
    }
}
;
function Dialog(t, b) {
    b = $.extend({
        title: "\u81ea\u5b9a\u4e49\u6807\u9898",
        taskImg: "thingslabs.png",
        showTitle: !0,
        width: 640,
        height: 480,
        draggable: !0,
        showMin: !0,
        showMax: !0,
        reSize: !0,
        modal: !0,
        center: !1,
        fixed: !1,
        time: 0,
        appid: "",
        id: !1
    }, b);
    b.id = b.id ? b.id : "dialog-" + Dialog.__count;
    var k = b.id + "-overlay"
      , u = b.id + "-mask"
      , w = null
      , g = !1
      , l = !1
      , h = !1
      , m = !1
      , n = 0
      , p = 0
      , q = b.width
      , r = b.height
      , v = 500
      , x = b.showTitle ? '\x3cdiv class\x3d"bar"\x3e\x3cimg src\x3d"' + b.taskImg + '" border\x3d"0" alt\x3d"" onmousedown\x3d"return false;"\x3e\x3cspan class\x3d"title"\x3e' + b.title + '\x3c/span\x3e\x3ca class\x3d"close"\x3e\x3c/a\x3e' : "";
    b.showMax && (x += '\x3ca class\x3d"max"\x3e\x3c/a\x3e');
    b.showMin && (x += '\x3ca class\x3d"min"\x3e\x3c/a\x3e');
    var a = $('\x3cdiv id\x3d"' + b.id + '" class\x3d"dialog"\x3e' + (x + "\x3c/div\x3e") + '\x3cdiv class\x3d"main"\x3e\x3cdiv class\x3d"leftbar"\x3e\x3c/div\x3e\x3cdiv class\x3d"winSize"\x3e\x3cdiv class\x3d"sizeText"\x3e^_^\x26nbsp;\u7a97\u4f53\u8c03\u6574\u4e2d...\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"content"\x3e\x3c/div\x3e\x3cdiv class\x3d"rightbar"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"foot"\x3e\x3cdiv class\x3d"leftbuttombar"\x3e\x3c/div\x3e\x3cdiv class\x3d"buttombar"\x3e\x3c/div\x3e\x3cdiv class\x3d"rightbuttombar"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"' + u + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"barMove"\x3e\x3c/div\x3e\x3cdiv class\x3d"barMenu"\x3e\x3cdiv class\x3d"item appinfo"\x3e\x3ci class\x3d"fa fa-bookmark-o"\x3e\x3c/i\x3e\x26nbsp;\x26nbsp;\u5173\u4e8e...\x3c/div\x3e\x3chr\x3e\x3cdiv class\x3d"item shortcut"\x3e\x3ci class\x3d"fa fa-location-arrow" style\x3d"font-size: 9px;"\x3e\x3c/i\x3e\x26nbsp;\x26nbsp;\u684c\u9762\u5feb\u6377\x3c/div\x3e\x3cdiv class\x3d"item dockcut"\x3e\x3ci class\x3d"fa fa-thumb-tack"\x3e\x3c/i\x3e\x26nbsp;\x26nbsp;\u505c\u9760\u7801\u5934\x3c/div\x3e\x3chr\x3e\x3cdiv class\x3d"item max"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\u6700\u5927\u5316\x3c/div\x3e\x3cdiv class\x3d"item min"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\u6700\u5c0f\u5316\x3c/div\x3e\x3chr\x3e\x3cdiv class\x3d"item close"\x3e\x3ci class\x3d"fa fa-sign-out"\x3e\x3c/i\x3e\x26nbsp;\u9000\u51fa\x3c/div\x3e\x3cdiv class\x3d"pointer"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e');
    $("#" + t.container).append(a);
    location.hash = "#" + b.appid;
    TUI.env.us.isHashChange = !1;
    var y = function() {
        var c = $(window).width()
          , f = $(window).height()
          , e = 0;
        c < b.width ? b.width = c : e = (c - b.width) / 2;
        f - 40 < b.height ? (b.width = c - 20,
        b.height = f - 60,
        c = e = 10) : c = (f - b.height - 40) / 2;
        a.css({
            top: c,
            left: e,
            width: b.width,
            height: b.height
        });
        n = c;
        p = e;
        q = b.width;
        r = b.height
    };
    this.getZindex = function() {
        return parseInt(a.css("z-index"))
    }
    ;
    this.getTop = function() {
        return parseInt(a.css("top"))
    }
    ;
    this.getLeft = function() {
        return parseInt(a.css("left"))
    }
    ;
    this.getWidth = function() {
        return parseInt(a.css("width"))
    }
    ;
    this.getHeight = function() {
        return parseInt(a.css("height"))
    }
    ;
    this.getOpacity = function() {
        return parseInt(a.css("opacity"))
    }
    ;
    this.getShowFlag = function() {
        return l
    }
    ;
    this.setActive = function() {
        Dialog.__zindex++;
        a.css("z-index", Dialog.__zindex);
        a.css("box-shadow", "5px 5px 30px rgba(16, 153, 236,0.7)");
        a.animate({
            opacity: 1
        }, "normal");
        $("#" + u).removeClass()
    }
    ;
    this.setNormal = function(b) {
        a.css("box-shadow", "none");
        a.animate({
            opacity: 1
        }, "normal");
        $("#" + u).removeClass();
        $("#" + u).addClass("overlay")
    }
    ;
    this.setContent = function(c) {
        var f = a.find(".content");
        if ("object" == typeof c)
            switch (c.type.toLowerCase()) {
            case "id":
                a.find(".barMenu").remove();
                a.find(".winSize").remove();
                f.html($("#" + c.value).html());
                break;
            case "img":
                a.find(".barMenu").remove();
                a.find(".winSize").remove();
                f.html("\u52a0\u8f7d\u4e2d...");
                $('\x3cimg alt\x3d"" /\x3e').load(function() {
                    f.empty().append($(this));
                    y()
                }).attr("src", c.value);
                break;
            case "url":
                a.find(".barMenu").remove();
                a.find(".winSize").remove();
                f.html("\u52a0\u8f7d\u4e2d...");
                $.ajax({
                    url: c.value,
                    success: function(a) {
                        f.html(a);
                        y()
                    },
                    error: function(a, b, c) {
                        f.html("\u51fa\u9519\u5566")
                    }
                });
                break;
            case "iframe":
                f.append($('\x3ciframe marginwidth\x3d"0" marginheight\x3d"0" frameborder\x3d"0"  src\x3d"' + c.value + '" /\x3e'));
                $.ajax({
                    type: "post",
                    url: "/System/srv/openAppCount.ejs",
                    data: {
                        name: b.title,
                        url: c.value
                    },
                    dataType: "json",
                    context: this,
                    error: function(a) {},
                    success: function(a) {}
                });
                break;
            case "msgbox":
                a.find(".barMenu").remove();
                a.find(".winSize").remove();
                "input" == c.msg ? (f.html('\x3cdiv class\x3d"msgBox"\x3e\x3cdiv class\x3d"msgInput"\x3e\u8bf7\u8f93\u5165\u60a8\u7684\u4fe1\u606f\uff1a\x3cbr\x3e\x3cinput type\x3d"text" id\x3d"msgInput" value\x3d"' + c.value + '"\x3e\x3c/div\x3e\x3cdiv class\x3d"operate"\x3e\x3ca id\x3d"okBtn" class\x3d"inputButton"\x3e\x26nbsp;\u786e\x26nbsp;\u5b9a\x26nbsp;\x3c/a\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca id\x3d"cancelBtn" class\x3d"inputButton"\x3e\x26nbsp;\u53d6\x26nbsp;\u6d88\x26nbsp;\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                a.find("#okBtn").bind("click touchstart", {
                    btnType: 4
                }, this.close)) : "image" == c.msg ? (f.html('\x3cdiv class\x3d"msgBox"\x3e\x3cdiv class\x3d"msgInput"\x3e\x3cform name\x3d"form" action\x3d"" method\x3d"POST" enctype\x3d"multipart/form-data"\x3e\u8bf7\u9009\u62e9\u60a8\u7684\u56fe\u7247\uff1a\x3cbr\x3e\x3cinput id\x3d"fileToUpload" type\x3d"file" size\x3d"30" name\x3d"fileToUpload" accept\x3d"image/*"\x3e\x3c/form\x3e\x3c/div\x3e\x3cdiv class\x3d"operate"\x3e\x3ca id\x3d"okBtn" class\x3d"inputButton"\x3e\x26nbsp;\u786e\x26nbsp;\u5b9a\x26nbsp;\x3c/a\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca id\x3d"cancelBtn" class\x3d"inputButton"\x3e\x26nbsp;\u53d6\x26nbsp;\u6d88\x26nbsp;\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                a.find("#okBtn").bind("click touchstart", {
                    btnType: 5
                }, this.close)) : "password" == c.msg ? (f.html('\x3cdiv class\x3d"msgBox"\x3e\x3cdiv class\x3d"msgPass"\x3e\u65e7\u7684\u5bc6\u7801\uff1a\x3cinput type\x3d"password" id\x3d"oldPass"\x3e\x3cbr\x3e\u65b0\u7684\u5bc6\u7801\uff1a\x3cinput type\x3d"password" id\x3d"newPass1"\x3e\x3cbr\x3e\u786e\u8ba4\u5bc6\u7801\uff1a\x3cinput type\x3d"password" id\x3d"newPass2"\x3e\x3c/div\x3e\x3cdiv class\x3d"operate"\x3e\x3ca id\x3d"okBtn" class\x3d"inputButton"\x3e\x26nbsp;\u786e\x26nbsp;\u5b9a\x26nbsp;\x3c/a\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca id\x3d"cancelBtn" class\x3d"inputButton"\x3e\x26nbsp;\u53d6\x26nbsp;\u6d88\x26nbsp;\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                a.find("#okBtn").bind("click touchstart", {
                    btnType: 6
                }, this.close)) : (f.html('\x3cdiv class\x3d"msgBox"\x3e\x3cdiv class\x3d"msgIcon"\x3e\x3cimg src\x3d"/system/style/images/' + c.msg + '.png" width\x3d"64" height\x3d"64" border\x3d"0" alt\x3d""\x3e\x3c/div\x3e\x3cdiv class\x3d"msgText"\x3e\x26nbsp;\x26nbsp;\x26nbsp;' + c.value + '\x3c/div\x3e\x3cdiv class\x3d"operate"\x3e\x3ca id\x3d"okBtn" class\x3d"inputButton"\x3e\x26nbsp;\u786e\x26nbsp;\u5b9a\x26nbsp;\x3c/a\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ca id\x3d"cancelBtn" class\x3d"inputButton"\x3e\x26nbsp;\u53d6\x26nbsp;\u6d88\x26nbsp;\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e'),
                a.find("#okBtn").bind("click touchstart", {
                    btnType: 1
                }, this.close));
                a.find("#cancelBtn").bind("click touchstart", {
                    btnType: 2
                }, this.close);
                break;
            default:
                a.find(".barMenu").remove(),
                a.find(".winSize").remove(),
                f.html(c.value)
            }
        else
            f.html(c)
    }
    ;
    this.show = function() {
        if (void 0 == b.beforeShow || b.beforeShow()) {
            var c = function(a) {
                if (!TUI.env.ua.ie)
                    return $("#" + a).css("opacity");
                a = document.getElementById(a);
                return void 0 != a && void 0 != a.filters && void 0 != a.filters.alpha && void 0 != a.filters.alpha.opacity ? a.filters.alpha.opacity / 100 : 1
            };
            b.modal && $("#" + k).fadeTo(500, c(k));
            playSound("open");
            y();
            c = parseInt(a.css("left"));
            a.css({
                left: -$(window).width(),
                opacity: 0
            });
            a.animate({
                left: c,
                opacity: 1,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal", function() {
                void 0 != b.afterShow && b.afterShow();
                l = !0
            });
            0 != b.time && (w = setTimeout(this.close, b.time))
        }
    }
    ;
    this.hide = function(c) {
        if (l && (void 0 == b.beforeHide || b.beforeHide()))
            if (b.modal)
                a.find(".close").trigger(TUI.env.ua.ontouch ? "touchstart" : "mousedown");
            else
                return a.find(".barMenu").hide(),
                playSound("min"),
                h || m || (n = parseInt(a.css("top")),
                p = parseInt(a.css("left")),
                q = parseInt(a.css("width")),
                r = parseInt(a.css("height"))),
                a.animate({
                    top: -$(window).height() - 40,
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    a.removeClass();
                    a.addClass("dialog");
                    a.css("z-index", -1);
                    void 0 != b.afterHide && b.afterHide()
                }),
                b.modal && $("#" + k).fadeOut("normal"),
                m = h = l = !1
    }
    ;
    this.max = function() {
        h ? (a.find(".barMenu").hide(),
        playSound("rest"),
        a.find(".content iframe").hide(),
        a.removeClass(),
        a.addClass("dialog"),
        a.css("z-index", v),
        a.animate({
            top: n,
            left: p,
            width: q,
            height: r,
            avoidTransforms: !1,
            useTranslate3d: TUI.env.ua.has3d
        }, "normal", function() {
            a.find(".content iframe").fadeIn("fast")
        }),
        h = !1) : (a.find(".barMenu").hide(),
        playSound("max"),
        m || (n = parseInt(a.css("top")),
        p = parseInt(a.css("left")),
        q = parseInt(a.css("width")),
        r = parseInt(a.css("height"))),
        v = parseInt(a.css("z-index")),
        a.find(".content iframe").hide(),
        a.css("z-index", 1E6),
        a.animate({
            top: 0,
            left: 0,
            width: $(window).width(),
            height: $(window).height(),
            avoidTransforms: !1,
            useTranslate3d: TUI.env.ua.has3d
        }, "fast", function() {
            a.removeClass();
            a.addClass("dialog-max");
            a.find(".content iframe").fadeIn("fast")
        }),
        h = !0,
        m = !1);
        return !1
    }
    ;
    this.normal = function() {
        if (h || m)
            playSound("rest"),
            a.find(".content iframe").hide(),
            a.removeClass(),
            a.addClass("dialog"),
            a.css("z-index", v),
            a.animate({
                top: n,
                left: p,
                width: q,
                height: r,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal", function() {
                a.find(".content iframe").fadeIn("fast")
            }),
            m = h = !1;
        return !1
    }
    ;
    this.fullscreen = function() {
        m || (playSound("max"),
        h || (n = parseInt(a.css("top")),
        p = parseInt(a.css("left")),
        q = parseInt(a.css("width")),
        r = parseInt(a.css("height"))),
        h || (v = parseInt(a.css("z-index"))),
        a.find(".content iframe").hide(),
        a.css("z-index", 1E6),
        a.animate({
            top: 0,
            left: 0,
            width: $(window).width(),
            height: $(window).height(),
            avoidTransforms: !1,
            useTranslate3d: TUI.env.ua.has3d
        }, "fast", function() {
            a.removeClass();
            a.addClass("dialog-fullscreen");
            a.find(".content iframe").fadeIn("fast")
        }),
        h = !1,
        m = !0);
        return !1
    }
    ;
    this.rest = function() {
        var c = function(a) {
            if (!TUI.env.ua.ie)
                return $("#" + a).css("opacity");
            a = document.getElementById(a);
            return void 0 != a && void 0 != a.filters && void 0 != a.filters.alpha && void 0 != a.filters.alpha.opacity ? a.filters.alpha.opacity / 100 : 1
        };
        playSound("rest");
        b.modal && $("#" + k).fadeTo("normal", c(k));
        Dialog.__zindex++;
        a.css("z-index", Dialog.__zindex);
        a.find(".content iframe").hide();
        a.removeClass();
        a.addClass("dialog");
        a.css({
            left: p,
            opacity: 0
        });
        a.animate({
            top: n,
            width: q,
            height: r,
            opacity: 1,
            avoidTransforms: !1,
            useTranslate3d: TUI.env.ua.has3d
        }, "normal", function() {
            void 0 != b.afterShow && b.afterShow();
            l = !0;
            a.find(".content iframe").fadeIn("fast")
        });
        return !1
    }
    ;
    this.magic = function(b, f, e, g, k, h, l) {
        playSound("magic");
        a.find(".content iframe").hide();
        a.css("z-index", h);
        a.animate({
            top: b,
            left: f,
            width: e,
            height: g,
            opacity: k,
            avoidTransforms: !1,
            useTranslate3d: TUI.env.ua.has3d
        }, l, function() {
            a.find(".content iframe").fadeIn("fast")
        });
        1 == k && $("#" + u).removeClass()
    }
    ;
    this.close = function(c) {
        b.modal && (TUI.env.os[TUI.env.desktop - 1].ModalWindwos = null);
        var f = void 0 == c ? 3 : c.data.btnType;
        if (6 == f) {
            var e = $("#oldPass").prop("value");
            c = $("#newPass1").prop("value");
            var g = $("#newPass2").prop("value");
            if ("" == e) {
                toastr.warning("\u5fc5\u987b\u8f93\u5165\u539f\u5bc6\u7801\uff01\uff01", "\u4fee\u6539\u5bc6\u7801");
                return
            }
            if ("" == c) {
                toastr.warning("\u5fc5\u987b\u8f93\u5165\u65b0\u5bc6\u7801\uff01\uff01", "\u4fee\u6539\u5bc6\u7801");
                return
            }
            if (c != g) {
                toastr.warning("\u786e\u8ba4\u65b0\u5bc6\u7801\u4e0d\u76f8\u540c\uff01\uff01", "\u4fee\u6539\u5bc6\u7801");
                return
            }
            e = ["\u592a\u5f31", "\u5f31", "\u4e00\u822c", "\u8f83\u5f3a", "\u5f88\u5f3a"];
            c = TUI.Utils.checkPassWord(c);
            if (3 > c) {
                toastr.warning("\u65b0\u5bc6\u7801\u5f3a\u5ea6" + e[c] + "\uff0c\u8bf7\u4f7f\u75288\u4f4d\u53ca\u4ee5\u4e0a\u7684\u5b57\u6bcd+\u6570\u5b57+\u7279\u6b8a\u5b57\u7b26\u7ec4\u5408\uff01", "\u4fee\u6539\u5bc6\u7801");
                return
            }
        }
        if (void 0 == b.beforeClose || b.beforeClose())
            return !h && !m && 0 < b.appid.length && $.ajax({
                type: "post",
                url: "/System/srv/posDialog.ejs",
                data: {
                    appid: b.appid,
                    width: parseInt(a.css("width")),
                    height: parseInt(a.css("height")),
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {},
                success: function(a) {}
            }),
            a.find(".barMenu").hide(),
            playSound("close"),
            a.find(".content iframe").hide(),
            a.animate({
                left: $(window).width(),
                opacity: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal", function() {
                if (void 0 != b.afterClose)
                    if (4 == f) {
                        var a = $("#msgInput").prop("value");
                        $(this).remove();
                        l = !1;
                        b.afterClose(1, a)
                    } else if (5 == f)
                        "" != $("#fileToUpload").prop("value") && $.ajaxFileUpload({
                            url: "/system/srv/uploadpic.ejs?userid\x3d" + TUI.env.us.userName,
                            secureuri: !1,
                            fileElementId: "fileToUpload",
                            context: this,
                            dataType: "xml",
                            success: function(a, d) {
                                b.afterClose(1)
                            }
                        }),
                        $(this).remove(),
                        l = !1;
                    else if (6 == f) {
                        var a = $("#oldPass").prop("value")
                          , c = $("#newPass1").prop("value");
                        $("#newPass2").prop("value");
                        $(this).remove();
                        l = !1;
                        b.afterClose(1, a, c)
                    } else
                        $(this).remove(),
                        l = !1,
                        b.afterClose(f)
            }),
            4 > f && void 0 != b.afterClose && b.afterClose(f),
            b.modal && $("#" + k).fadeOut(500, function() {
                $(this).remove()
            }),
            clearTimeout(w),
            !1
    }
    ;
    (function() {
        function c(d) {
            var b = d || window.event;
            TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (d.preventDefault(),
            b = d.originalEvent.touches[0] || d.originalEvent.changedTouches[0]);
            d = parseInt(a.css("top")) + (b.clientY - e.y);
            var c = parseInt(a.css("left")) + (b.clientX - e.x);
            0 <= d && a.css({
                top: d,
                left: c
            });
            e.x = b.clientX;
            e.y = b.clientY
        }
        function f(b) {
            b = b || window.event;
            var d = parseInt(a.css("left")) + (b.clientX - e.x)
              , c = parseInt(a.css("width")) + (e.x - b.clientX);
            0 <= d && 150 < c && a.css({
                left: d,
                width: c
            });
            e.x = b.clientX
        }
        b.modal && (Dialog.__zindex++,
        $("#" + t.container).append('\x3cdiv id\x3d"' + k + '" class\x3d"dialog-overlay"\x3e\x3c/div\x3e'),
        $("#" + k).css({
            left: 0,
            top: 0,
            width: "100%",
            height: $(document).height(),
            "z-index": Dialog.__zindex,
            position: "absolute"
        }).hide());
        Dialog.__zindex++;
        a.css({
            "z-index": Dialog.__zindex,
            position: b.fixed ? "fixed" : "absolute"
        });
        var e = {
            x: 0,
            y: 0
        };
        TUI.env.ua.ontouch && "windows" != TUI.env.ua.os ? (a.find(".barMove").bind("touchstart", function(d) {
            b.draggable && (a.find(".winSize").show(),
            a.find(".barMenu").hide(),
            a.find(".content iframe").hide(),
            g = !1,
            d.preventDefault(),
            d = d.originalEvent.touches[0] || d.originalEvent.changedTouches[0],
            e.x = d.clientX,
            e.y = d.clientY,
            $(document).bind("touchmove", c))
        }),
        $(document).bind("touchend", function(b) {
            1 == parseInt(a.css("opacity")) && (a.find(".winSize").hide(),
            a.find(".content iframe").show());
            $(document).unbind("touchmove")
        })) : (a.find(".barMove").bind("mousedown", function(d) {
            b.draggable && (a.find(".winSize").show(),
            a.find(".barMenu").hide(),
            a.find(".content iframe").hide(),
            g = !1,
            d = d || window.event,
            e.x = d.clientX,
            e.y = d.clientY,
            $(document).bind("mousemove", c))
        }),
        $(document).bind("mouseup", function(b) {
            1 == parseInt(a.css("opacity")) && (a.find(".winSize").hide(),
            a.find(".content iframe").show());
            $(document).unbind("mousemove")
        }));
        if (b.reSize && "windows" == TUI.env.ua.os) {
            var h = function(b) {
                b = b || window.event;
                var d = parseInt(a.css("width")) + (b.clientX - e.x);
                150 < d && a.css({
                    width: d
                });
                e.x = b.clientX;
                d = parseInt(a.css("height")) + (b.clientY - e.y);
                100 < d && a.css({
                    height: d
                });
                e.y = b.clientY
            }
              , l = function(b) {
                b = b || window.event;
                var d = parseInt(a.css("left")) + (b.clientX - e.x)
                  , c = parseInt(a.css("width")) + (e.x - b.clientX);
                0 <= d && 150 < c && a.css({
                    left: d,
                    width: c
                });
                e.x = b.clientX;
                d = parseInt(a.css("height")) + (b.clientY - e.y);
                100 < d && a.css({
                    height: d
                });
                e.y = b.clientY
            }
              , m = function(b) {
                b = b || window.event;
                var d = parseInt(a.css("height")) + (b.clientY - e.y);
                100 < d && a.css({
                    height: d
                });
                e.y = b.clientY
            }
              , n = function(b) {
                b = b || window.event;
                var d = parseInt(a.css("width")) + (b.clientX - e.x);
                150 < d && a.css({
                    width: d
                });
                e.x = b.clientX
            };
            a.find(".leftbar").bind("mousedown", function(d) {
                b.draggable && (a.find(".winSize").show(),
                a.find(".barMenu").hide(),
                a.find(".content iframe").hide(),
                g = !1,
                e.x = (d || window.event).clientX,
                $(document).bind("mousemove", f))
            });
            a.find(".rightbar").bind("mousedown", function(d) {
                b.draggable && (a.find(".winSize").show(),
                a.find(".barMenu").hide(),
                a.find(".content iframe").hide(),
                g = !1,
                e.x = (d || window.event).clientX,
                $(document).bind("mousemove", n))
            });
            a.find(".buttombar").bind("mousedown", function(d) {
                b.draggable && (a.find(".winSize").show(),
                a.find(".barMenu").hide(),
                a.find(".content iframe").hide(),
                g = !1,
                e.y = (d || window.event).clientY,
                $(document).bind("mousemove", m))
            });
            a.find(".leftbuttombar").bind("mousedown", function(d) {
                b.draggable && (a.find(".winSize").show(),
                a.find(".barMenu").hide(),
                a.find(".content iframe").hide(),
                g = !1,
                d = d || window.event,
                e.x = d.clientX,
                e.y = d.clientY,
                $(document).bind("mousemove", l))
            });
            a.find(".rightbuttombar").bind("mousedown", function(d) {
                b.draggable && (a.find(".winSize").show(),
                a.find(".barMenu").hide(),
                a.find(".content iframe").hide(),
                g = !1,
                d = d || window.event,
                e.x = d.clientX,
                e.y = d.clientY,
                $(document).bind("mousemove", h))
            })
        }
        a.find(".min").bind(TUI.env.ua.clickEventDown, this.hide);
        a.find(".max").bind(TUI.env.ua.clickEventDown, this.max);
        a.find(".close").bind(TUI.env.ua.clickEventDown, {
            btnType: 0
        }, this.close);
        a.find(".barMenu .appinfo").bind(TUI.env.ua.clickEventDown, {
            options: b
        }, function(d) {
            for (var c = 0; c < TUI.env.cfg.system.installApp.length; c++)
                if (TUI.env.cfg.system.installApp[c].appid == d.data.options.appid) {
                    c = '\x3cdiv class\x3d"about"\x3e\x3cimg src\x3d"' + d.data.options.taskImg + '" onmousedown\x3d"return false;"/\x3e\x3cdiv class\x3d"name"\x3e' + TUI.env.cfg.system.installApp[c].name + '\x3c/div\x3e\x3cdiv class\x3d"version"\x3e\u7248\u672c\x26nbsp;' + TUI.env.cfg.system.installApp[c].version + '\x3c/div\x3e\x3cdiv class\x3d"resource"\x3e\x3chr\x3e' + TUI.env.cfg.system.installApp[c].description + '\x3chr\x3e\x3c/div\x3e\x3cdiv class\x3d"copy"\x3e\x26copy;' + (new Date).Format("yyyy") + "\x26nbsp;" + TUI.env.cfg.system.installApp[c].author + ".\x3c/div\x3e\x3c/div\x3e";
                    TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                        container: b.handle.container,
                        type: "html",
                        msg: "query",
                        value: c
                    },{
                        title: d.data.options.title,
                        taskImg: d.data.options.taskImg,
                        width: 300,
                        height: 350,
                        reSize: !1,
                        showMin: !1,
                        showMax: !1,
                        center: !0,
                        modal: !0
                    });
                    TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show();
                    break
                }
            a.find(".barMenu").hide();
            g = !1
        });
        a.find(".barMenu .shortcut").bind(TUI.env.ua.clickEventDown, {
            options: b
        }, function(b) {
            b.data.options.handle.setAppShortcut(b.data.options.appid, b.data.options.urlPath, b.data.options.title, b.data.options.taskImg);
            a.find(".barMenu").hide();
            g = !1
        });
        a.find(".barMenu .dockcut").bind(TUI.env.ua.clickEventDown, {
            options: b
        }, function(b) {
            b.data.options.handle.setAppDock(b.data.options.appid, b.data.options.urlPath, b.data.options.title, b.data.options.taskImg);
            a.find(".barMenu").hide();
            g = !1
        });
        a.find(".bar img").bind(TUI.env.ua.clickEventDown, function() {
            g ? (a.find(".barMenu").hide(),
            g = !1) : (a.find(".barMenu").show(),
            g = !0,
            $(this).oneTime(1E4, function() {
                a.find(".barMenu").hide();
                g = !1
            }))
        });
        a.bind(TUI.env.ua.clickEventUp, function() {
            a.css("opacity", 1);
            parseInt(a.css("z-index")) < Dialog.__zindex && (Dialog.__zindex++,
            a.css("z-index", Dialog.__zindex),
            void 0 != b.afterSwitch && b.afterSwitch())
        });
        0 != b.time && (w = setTimeout(this.close, b.time))
    }
    ).call(this);
    this.setContent(t);
    Dialog.__count++
}
Dialog.__zindex = 500;
Dialog.__count = 1;
Dialog.__top = 0;
Dialog.__left = 0;
Dialog.version = "1.0 beta";
function dialog(t, b) {
    var k = new Dialog(t,b);
    k.show();
    return k
}
;SmartDock = function(r, p) {
    var t = 0, m = 0, f = 0, e = 0, b = 0, g = 0, h = 0, n, k, q = 0;
    return {
        init: function() {
            this.container = r;
            var a = p ? p : {};
            this.minWidth = a.minWidth ? a.minWidth : 320;
            this.appCount = 0;
            $("#" + this.container).html('\x3cdiv class\x3d"apps"\x3e\x3cdiv class\x3d"l"\x3e\x3c/div\x3e\x3cul\x3e\x3c/ul\x3e \x3cdiv class\x3d"r"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"dragapp"\x3e\x3c/div\x3e');
            $("#" + this.container + " .apps").css("min-width", this.minWidth + "px");
            "" != TUI.env.us.appUrl && $("#" + this.container + " .apps").css("margin-left", "15%")
        },
        show: function() {
            $("#" + this.container).slideDown(600)
        },
        hide: function() {
            $("#" + this.container).slideUp(300)
        },
        addApp: function(a, l, d, u, p, r) {
            "0CB4D644-896A-4ADA-9D5F-58448BD04499" == d ? l = "/System/srv/userpic.ejs?userid\x3d" + TUI.env.us.userName : "0CB4D644-896A-4ADA-9D5F-58448BD04499" == d && (l = "/Webapp/Calendar/Resources/Images/" + (new Date).Format("MMdd") + ".png");
            $("#" + this.container + " ul").append('\t\t\x3cli class\x3d"app" id\x3d"' + this.container + "_" + d + '"\x3e \t\t\t\x3cdiv class\x3d"icon"\x3e \t\t\t\t\x3cdiv class\x3d"label"\x3e \t\t\t\t\t\x3cem\x3e' + a + '\x3c/em\x3e \t\t\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e \t\t\t\t\x3c/div\x3e \t\t\t    \x3cdiv class\x3d"number" id\x3d"' + this.container + "_" + d + '_Num"\x3e\x3c/div\x3e\t\t\t\t\t\t\x3cimg src\x3d"' + l + '"  onmousedown\x3d"return false;" alt\x3d"' + a + '" /\x3e \t\t\t\x3c/div\x3e \t\t\t\x3cdiv class\x3d"indicator"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"reflection"\x3e \t\t\t\t\x3cimg src\x3d"' + l + '" /\x3e \t\t\t\x3c/div\x3e\t\t\x3c/li\x3e ');
            $("#" + this.container + "_" + d).bind("windows" == TUI.env.ua.os ? "mouseup" : TUI.env.ua.clickEventUp, {
                handle: p,
                appName: a,
                appImg: l,
                appID: d,
                appLaunch: u,
                fn: r
            }, function(c) {
                0 == g && (localStorage[c.data.shortcutID + "-count"] = $(this).find(".number").html(),
                $(this).find(".number").hide(),
                c.data.fn(c));
                g = 0;
                $(document).unbind("windows" == TUI.env.ua.os ? "mousemove" : TUI.env.ua.clickEventMove);
                $(".HomeButton").removeClass("active");
                $(".ApplyButton").removeClass("active");
                $(".ThemeButton").removeClass("active");
                $(".StartMenu").hide();
                $(".AppMenu").hide();
                $(".ThemeMenu").hide();
                $(".TaskStatus .ClockList").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .UserMenu").hide();
                $(".messagepanel").css({
                    right: -280
                });
                $(".messagepanel").hide()
            });
            this.appCount++;
            4 <= this.appCount && $("#" + this.container + " .apps").css("width", 80 * this.appCount + 50 + "px");
            $("#" + this.container + "_" + d).animate({
                opacity: 1
            }, "slow");
            $("#" + this.container + "_" + d).bind("windows" == TUI.env.ua.os ? "mousedown" : TUI.env.ua.clickEventDown, {
                appID: d,
                appImg: l,
                parent: this
            }, function(c) {
                "0CB4D644-896A-4ADA-9D5F-58448BD04499" == c.data.appID ? c.data.appImg = "/System/srv/userpic.ejs?userid\x3d" + TUI.env.us.userName : "0CB4D644-896A-4ADA-9D5F-58448BD04499" == c.data.appID && (c.data.appImg = "/Webapp/Calendar/Resources/Images/" + (new Date).Format("MMdd") + ".png");
                var a = c || window.event;
                TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (c.preventDefault(),
                a = c.originalEvent.touches[0] || c.originalEvent.changedTouches[0]);
                b = $("#" + c.data.parent.container + " .dragapp");
                b.empty();
                b.append('\x3cdiv class\x3d"close"\x3e\x3c/div\x3e\x3cimg src\x3d"' + c.data.appImg + '" /\x3e ');
                b.css({
                    top: this.offsetParent.offsetTop + this.offsetTop,
                    left: this.offsetParent.offsetLeft + this.offsetLeft
                });
                b.find(".close").hide();
                e = this;
                t = a.clientY - (this.offsetParent.offsetTop + this.offsetTop);
                m = a.clientX - (this.offsetParent.offsetLeft + this.offsetLeft);
                f = this.offsetParent.offsetLeft + this.offsetLeft;
                g = 0;
                n = c.data.appID;
                k = "";
                $(document).bind("windows" == TUI.env.ua.os ? "mousemove" : TUI.env.ua.clickEventMove, {
                    parent: c.data.parent
                }, function(a) {
                    if (b) {
                        var c = new Date
                          , d = a || window.event;
                        TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (a.preventDefault(),
                        d = a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
                        f != d.clientX - m && (h = f < d.clientX - m ? 0 : 1,
                        b.css({
                            top: d.clientY - t,
                            left: d.clientX - m
                        }),
                        b.show(),
                        $(e).css({
                            opacity: 0
                        }),
                        -70 > d.clientY - t ? ($(e).hide(),
                        b.find(".close").show()) : ($(e).show(),
                        b.find(".close").hide(),
                        g = c.getTime() / 1E3,
                        f = d.clientX - m,
                        $("#" + a.data.parent.container + " .apps").find("li").each(function() {
                            if (this.id != a.data.parent.container + "_" + n && (h != q || this.id != k)) {
                                var c = this.offsetParent.offsetLeft + this.offsetLeft;
                                if (0 == h && f + 50 > c && f < c)
                                    return k = this.id,
                                    q = h,
                                    $(e).insertAfter($(this)),
                                    !1;
                                if (1 == h && f - 50 < c && f > c)
                                    return k = this.id,
                                    q = h,
                                    $(e).insertBefore($(this)),
                                    !1
                            }
                        })))
                    }
                })
            });
            $(document).bind("windows" == TUI.env.ua.os ? "mouseup" : TUI.env.ua.clickEventUp, {
                parent: this
            }, function(a) {
                b && 0 < g && ($(e).is(":hidden") ? (a.data.parent.delApp(n),
                b.fadeOut("normal"),
                b = 0,
                $.ajax({
                    type: "post",
                    url: "/System/srv/deldock.ejs",
                    data: {
                        appId: n,
                        deskTop: TUI.env.desktop
                    },
                    dataType: "json",
                    error: function(a) {},
                    success: function(a) {
                        TUI.env.cfg = a
                    }
                })) : (b.animate({
                    top: e.offsetParent.offsetTop + e.offsetTop,
                    left: e.offsetParent.offsetLeft + e.offsetLeft
                }, "normal", function(a) {
                    $(e).css({
                        opacity: 1
                    });
                    b.hide();
                    b = 0
                }),
                a = k.lastIndexOf("_"),
                0 < a && $.ajax({
                    type: "post",
                    url: "/System/srv/mdydock.ejs",
                    data: {
                        appId: n,
                        proID: k.substr(a + 1),
                        appDirect: q,
                        deskTop: TUI.env.desktop
                    },
                    dataType: "json",
                    error: function(a) {},
                    success: function(a) {
                        TUI.env.cfg = a
                    }
                })),
                g = 0);
                $(document).unbind("windows" == TUI.env.ua.os ? "mousemove" : TUI.env.ua.clickEventMove)
            })
        },
        delApp: function(a) {
            $("#" + this.container + "_" + a).remove();
            this.appCount--;
            4 <= this.appCount ? $("#" + this.container + " .apps").css("width", 80 * this.appCount + 50 + "px") : $("#" + this.container + " .apps").css("width", this.minWidth + "px")
        },
        clearApp: function() {
            $("#" + this.container + " ul").empty();
            this.appCount = 0;
            $("#" + this.container + " .apps").css("width", this.minWidth + "px")
        },
        setMsgCount: function(a, b) {
            $("#" + this.container + "_" + a + "_Num").unbind(TUI.env.ua.clickEventDown);
            0 < b.length ? ($("#" + this.container + "_" + a + "_Num").show(),
            $("#" + this.container + "_" + a + "_Num").html(b.length),
            $("#" + this.container + "_" + a + "_Num").bind(TUI.env.ua.clickEventDown, {
                msgList: b
            }, function(a) {
                for (var b = 0; b < a.data.msgList.length; b++)
                    toastr.info(a.data.msgList[b].content, a.data.msgList[b].title);
                return !1
            })) : ($("#" + this.container + "_" + a + "_Num").html(0),
            $("#" + this.container + "_" + a + "_Num").hide())
        },
        setMsgActive: function(a) {
            $("#" + this.container + "_" + a).addClass("active");
            $(this).oneTime(5E3, function() {
                $("#" + this.container + "_" + a).removeClass("active")
            })
        }
    }
}
;
SmartLogin = function(g, e) {
    return {
        init: function() {
            this.container = g;
            var a = e ? e : {};
            this.userName = a.userName ? a.userName : "";
            this.passWord = a.passWord ? a.passWord : "";
            this.handler = a.handler ? a.handler : function() {
                alert("unlocked!")
            }
            ;
            var a = new Date
              , c = ""
              , d = ""
              , c = 10 > a.getMinutes() ? a.getHours() + ":0" + a.getMinutes() : a.getHours() + ":" + a.getMinutes()
              , d = a.getMonth() + 1 + "\u6708" + a.getDate() + "\u65e5 " + "\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" ")[a.getDay()];
            "" == this.userName ? $("#" + this.container).html("\x3cdiv id\x3d" + this.container + '_Time class\x3d"loginTime"\x3e' + c + "\x3c/div\x3e\x3cdiv id\x3d" + this.container + '_Date class\x3d"loginDate"\x3e' + d + "\x3c/div\x3e\x3cdiv id\x3d" + this.container + '_Load class\x3d"loginLoading"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Form class\x3d"loginForm"\x3e\t\x3cdiv class\x3d"loginTitle"\x3e\u6b22\u8fce\x3c/div\x3e\t\x3cdiv class\x3d"loginsubTitle"\x3e\u5149\u4e34\uff0c\u53d1\u73b0\u5f00\u59cb . . .\x3c/div\x3e\t\x3cdiv class\x3d"loginUser"\x3e\u5e10 \u53f7\uff1a\x3cinput type\x3d"text" name\x3d"userName" id\x3d"userName" class\x3d"loginText" value\x3d"' + this.userName + '" placeholder\x3d"\u8bf7\u8f93\u5165\u5e10\u53f7" autocomplete\x3d"on" required\x3d"required"\x3e\x3c/div\x3e\t\x3cdiv class\x3d"loginPass"\x3e\u53e3 \u4ee4\uff1a\x3cinput type\x3d"password" name\x3d"passWord" id\x3d"passWord" class\x3d"loginText" value\x3d"' + this.passWord + '" placeholder\x3d"\u8bf7\u8f93\u5165\u53e3\u4ee4"  required\x3d"required"\x3e\x3c/div\x3e\t\x3cdiv id\x3d' + this.container + '_Info class\x3d"loginInfo"\x3e\x26nbsp;\x3c/div\x3e\t\x3cdiv id\x3d' + this.container + '_Slider class\x3d"loginSlider"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"ssoLogin"\x3e\x3ca href\x3d"/API/SSO/AccessToken?state\x3d*"\x3e\u7edf\u4e00\u8eab\u4efd\u8ba4\u8bc1\x3c/a\x3e\x3c/div\x3e') : $("#" + this.container).html("\x3cdiv id\x3d" + this.container + '_Time class\x3d"loginTime"\x3e' + c + "\x3c/div\x3e\x3cdiv id\x3d" + this.container + '_Date class\x3d"loginDate"\x3e' + d + "\x3c/div\x3e\x3cdiv id\x3d" + this.container + '_Load class\x3d"loginLoading"\x3e\x3c/div\x3e\x3cdiv id\x3d' + this.container + '_Form class\x3d"loginForm"\x3e\t\x3cdiv class\x3d"loginTitle"\x3e\u6b22\u8fce\x3c/div\x3e\t\x3cdiv class\x3d"loginsubTitle"\x3e\u56de\u6765\uff0c\u7cbe\u5f69\u6709\u4f60 . . .\x3c/div\x3e\t\x3cdiv class\x3d"loginUser"\x3e\u5e10 \u53f7\uff1a\x3cinput type\x3d"text" name\x3d"userName" id\x3d"userName" class\x3d"loginText" value\x3d"' + this.userName + '" placeholder\x3d"\u8bf7\u8f93\u5165\u5e10\u53f7" autocomplete\x3d"on" required\x3d"required"\x3e\x3c/div\x3e\t\x3cdiv class\x3d"loginPass"\x3e\u53e3 \u4ee4\uff1a\x3cinput type\x3d"password" name\x3d"passWord" id\x3d"passWord" class\x3d"loginText" value\x3d"' + this.passWord + '" placeholder\x3d"\u8bf7\u8f93\u5165\u53e3\u4ee4" required\x3d"required"\x3e\x3c/div\x3e\t\x3cdiv id\x3d' + this.container + '_Info class\x3d"loginInfo"\x3e\x26nbsp;\x3c/div\x3e\t\x3cdiv id\x3d' + this.container + '_Slider class\x3d"loginSlider"\x3e\x26nbsp;\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"ssoLogin"\x3e\x3ca href\x3d"/API/SSO/AccessToken?state\x3d*"\x3e\u7edf\u4e00\u8eab\u4efd\u8ba4\u8bc1\x3c/a\x3e\x3c/div\x3e');
            $(this).everyTime(15E3, "logintime", function() {
                var b = new Date;
                10 > b.getMinutes() ? $("#" + this.container + "_Time").html(b.getHours() + ":0" + b.getMinutes()) : $("#" + this.container + "_Time").html(b.getHours() + ":" + b.getMinutes());
                $("#" + this.container + "_Date").html(b.getMonth() + 1 + "\u6708" + b.getDate() + "\u65e5 " + "\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" ")[b.getDay()])
            });
            this.loginSlider = new Slider(this.container + "_Slider",{
                infoid: this.container + "_Load",
                loginHandle: this,
                callfunction: this.handler,
                handler: function() {
                    var b = $("#userName").prop("value")
                      , a = $("#passWord").prop("value");
                    "" == b ? (playSound("warn"),
                    toastr.warning("\u8bf7\u8f93\u5165\u60a8\u7684\u8d26\u6237\u540d\uff01", "\u8d26\u6237\u767b\u5f55"),
                    $("#userName").focus(),
                    this.reset()) : "" == a ? (playSound("warn"),
                    toastr.warning("\u8bf7\u8f93\u5165\u60a8\u7684\u8d26\u6237\u53e3\u4ee4\uff01", "\u8d26\u6237\u767b\u5f55"),
                    $("#passWord").focus(),
                    this.reset()) : ($("#userName").blur(),
                    $("#passWord").blur(),
                    this.loginHandle.userName = b,
                    this.callfunction(b, a))
                }
            });
            this.loginSlider.init();
            var f = this;
            $("#userName").keydown(function(a) {
                13 == a.keyCode && $("#passWord").focus()
            });
            $("#passWord").keydown(function(a) {
                if (13 == a.keyCode) {
                    a = $("#userName").prop("value");
                    var b = $("#passWord").prop("value");
                    "" == a ? (playSound("warn"),
                    toastr.warning("\u8bf7\u8f93\u5165\u60a8\u7684\u8d26\u6237\u540d\uff01", "\u8d26\u6237\u767b\u5f55"),
                    $("#userName").focus()) : "" == b ? (playSound("warn"),
                    toastr.warning("\u8bf7\u8f93\u5165\u60a8\u7684\u8d26\u6237\u53e3\u4ee4\uff01", "\u8d26\u6237\u767b\u5f55"),
                    $("#passWord").focus()) : ($("#userName").blur(),
                    $("#passWord").blur(),
                    f.userName = a,
                    f.handler(a, b))
                }
            })
        },
        clear: function() {
            $("#" + this.container + "_Load").hide()
        },
        reset: function() {
            $("#passWord").val("");
            $("#" + this.container + "_Load").hide();
            this.loginSlider.reset();
            $("#" + this.container + "_Form").fadeIn(500)
        },
        show: function(a) {
            var c = this;
            $("#" + this.container + "_Form").css({
                left: -800,
                opacity: 0
            });
            $("#" + this.container + "_Form").animate({
                left: $(window).width() / 2,
                opacity: 1
            }, a, function() {
                $("#" + c.container + "_Form").css({
                    left: "50%"
                })
            })
        },
        hide: function(a) {
            var c = this;
            $("#" + this.container + "_Form").fadeOut(a, function() {
                $("#" + c.container + "_Load").show()
            })
        }
    }
}
;
function reloadSound(b) {
    try {
        TUI.env.ua.webkit && b.load()
    } catch (a) {}
}
function playSound(b) {
    try {
        var a = document.getElementById(b + "_sound");
        4 == a.readyState && (a.currentTime = 0,
        a.play())
    } catch (e) {}
}
var myApp = TUI.namespace("myApp");
$(document).ready(function() {
    if (TUI.env.ua.html5)
        if (toastr.options = {
            closeButton: !0,
            debug: !1,
            positionClass: "toast-bottom-right",
            onclick: null,
            showDuration: "1000",
            hideDuration: "1000",
            timeOut: "8000",
            extendedTimeOut: "5000",
            showEasing: "swing",
            hideEasing: "linear",
            showMethod: "fadeIn",
            hideMethod: "fadeOut"
        },
        500 >= $(window).width())
            top.location.href = "/WebMobile/";
        else {
            document.body.onselectstart = document.body.oncontextmenu = function() {
                return !1
            }
            ;
            var b = null;
            $.ajax({
                type: "get",
                url: "System/srv/getTodayPic.ejs",
                dataType: "json",
                error: function(a) {},
                success: function(a) {
                    b = new SmartDeskTop("loginFrame",{
                        bTensile: !0,
                        imgWrapper: a.imgWrapper,
                        videoWrapper: a.videoWrapper,
                        bLogin: !0,
                        id: 0
                    });
                    b.init();
                    TUI.env.login = new SmartLogin(b.getPanel(),{
                        userName: $.cookie("fUser"),
                        passWord: "",
                        handler: function(a, b) {
                            TUI.env.login.hide(500);
                            var c = TUI.env.us.loginRand
                              , d = TUI.Utils.hex_sha1(TUI.env.login.userName + "-" + c)
                              , e = TUI.Utils.hex_sha1(TUI.env.login.userName + "-" + b)
                              , d = TUI.Utils.hex_sha1(d.substr(2 * Math.floor(c % 36 / 2), 4) + e.substr(2 * Math.floor(c % 36 / 2), 4))
                              , d = TUI.Utils.hex_sha1(d.substr(2 * Math.floor(c % 34 / 2), 6));
                            $.ajax({
                                type: "post",
                                url: "/System/srv/login.ejs",
                                data: {
                                    userName: TUI.env.login.userName,
                                    passHash: d.substr(2 * Math.floor(c % 32 / 2), 8)
                                },
                                dataType: "json",
                                error: function(a) {
                                    TUI.env.login.reset();
                                    TUI.env.login.show(700);
                                    playSound("error");
                                    toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u8d26\u6237\u767b\u5f55")
                                },
                                success: function(a) {
                                    TUI.env.us = a;
                                    if (a.loginStatus) {
                                        if (1 == a.userTypeNum) {
                                            var b = !1, d;
                                            for (d in a.rightList)
                                                for (var c = a.rightList[d], e = 0; e < c.length; e++) {
                                                    if (0 <= c[e].indexOf("desktop.") || 0 <= c[e].indexOf("pad.")) {
                                                        b = !0;
                                                        break
                                                    }
                                                    if (b)
                                                        break
                                                }
                                            if (!b) {
                                                TUI.env.login.reset();
                                                TUI.env.login.show(700);
                                                playSound("warn");
                                                toastr.warning("\u60a8\u8fd8\u6ca1\u6709\u684c\u9762\u5e94\u7528\u6388\u6743\uff01\uff01\uff01", "\u8d26\u6237\u767b\u5f55");
                                                return
                                            }
                                        }
                                        $.cookie("fUser", TUI.env.login.userName, {
                                            expires: 7
                                        });
                                        0 == TUI.env.os.length ? initDesktop() : (TUI.env.desktop = 1,
                                        $("#desktopFrame1").show(),
                                        $("#desktopFrame1").css({
                                            left: -($(window).width() + 50),
                                            opacity: 0
                                        }),
                                        $("#desktopFrame1").animate({
                                            left: 0,
                                            opacity: 1,
                                            avoidTransforms: !1,
                                            useTranslate3d: TUI.env.ua.has3d
                                        }, 1E3, function() {
                                            playSound("desktop")
                                        }),
                                        $("#loginFrame").animate({
                                            left: $(window).width() + 50,
                                            opacity: 0,
                                            avoidTransforms: !1,
                                            useTranslate3d: TUI.env.ua.has3d
                                        }, 1E3, function() {
                                            $("#loginFrame").hide()
                                        }));
                                        location.hash = "#desktop";
                                        TUI.env.us.isHashChange = !1
                                    } else
                                        TUI.env.login.reset(),
                                        TUI.env.login.show(700),
                                        playSound("warn"),
                                        toastr.warning(a.userMsg, "\u8d26\u6237\u767b\u5f55")
                                }
                            })
                        }
                    });
                    TUI.env.login.init()
                }
            });
            $(this).oneTime(1E3, function() {
                $("#warningCover").remove();
                $("#startingCover").remove();
                playSound("start");
                $.ajax({
                    type: "get",
                    url: "/System/srv/login.ejs",
                    dataType: "json",
                    error: function(a) {
                        $("#loginFrame").fadeOut(3500, function() {
                            self.location = "/"
                        });
                        playSound("error");
                        toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u8d26\u6237\u767b\u5f55")
                    },
                    success: function(a) {
                        TUI.env.us = a;
                        TUI.env.us.isSSOAuth && "" != TUI.env.us.ssoName ? $(".ssoLogin").html('\x3ca href\x3d"/API/SSO/AccessToken?state\x3d*"\x3e' + TUI.env.us.ssoName + "\x3c/a\x3e") : $(".ssoLogin").remove();
                        if (a.loginStatus) {
                            if (1 == a.userTypeNum) {
                                var e = !1, f;
                                for (f in a.rightList)
                                    for (var c = a.rightList[f], d = 0; d < c.length; d++) {
                                        if (0 <= c[d].indexOf("desktop.") || 0 <= c[d].indexOf("pad.")) {
                                            e = !0;
                                            break
                                        }
                                        if (e)
                                            break
                                    }
                                if (!e) {
                                    null != b && b.show(400);
                                    TUI.env.login.show(700);
                                    location.hash = "#login";
                                    toastr.warning("\u60a8\u8fd8\u6ca1\u6709\u684c\u9762\u5e94\u7528\u6388\u6743\uff01\uff01\uff01", "\u8d26\u6237\u767b\u5f55");
                                    return
                                }
                            }
                            0 == TUI.env.os.length ? initDesktop() : (TUI.env.desktop = 1,
                            $("#desktopFrame1").show(),
                            $("#desktopFrame1").css({
                                left: -($(window).width() + 50),
                                opacity: 0
                            }),
                            $("#desktopFrame1").animate({
                                left: 0,
                                opacity: 1,
                                avoidTransforms: !1,
                                useTranslate3d: TUI.env.ua.has3d
                            }, 1E3, function() {
                                playSound("desktop")
                            }),
                            $("#loginFrame").animate({
                                left: $(window).width() + 50,
                                opacity: 0,
                                avoidTransforms: !1,
                                useTranslate3d: TUI.env.ua.has3d
                            }, 1E3, function() {
                                $("#loginFrame").hide()
                            }));
                            location.hash = "#desktop";
                            TUI.env.us.isHashChange = !1
                        } else
                            null != b && b.show(400),
                            TUI.env.login.show(700),
                            location.hash = "#login"
                    }
                })
            });
            $(this).everyTime(3E4, "loginRand", function() {
                $.ajax({
                    type: "get",
                    url: "/System/srv/login.ejs",
                    dataType: "json",
                    error: function(a) {
                        $("#loginFrame").fadeOut(3500, function() {
                            self.location = "/"
                        })
                    },
                    success: function(a) {
                        TUI.env.us = a
                    }
                })
            })
        }
    else
        $("#startingCover").remove(),
        $("#warningCover").fadeIn(500)
});
function initDesktop() {
    TUI.env.desktop = 1;
    $(this).stop(!0).stopTime("loginRand");
    $.ajax({
        type: "get",
        url: "/System/srv/readconfig.ejs",
        dataType: "json",
        error: function(b) {
            $("#loginFrame").fadeOut(3500, function() {
                self.location = "/"
            });
            playSound("error");
            toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u4e2a\u4eba\u8bbe\u5b9a")
        },
        success: function(b) {
            TUI.env.cfg = b;
            void 0 != TUI.env.cfg.system.myTheme && 0 < TUI.env.cfg.system.myTheme.length && (document.getElementById("mytheme").href = TUI.env.cfg.system.myTheme + "/theme.css");
            TUI.env.os[0] = new SmartManage("desktopFrame1",{
                bTensile: TUI.env.cfg.desktop[0].bTensile,
                imgWrapper: TUI.env.cfg.desktop[0].imgWrapper,
                bLogin: !1,
                id: 1
            });
            TUI.env.os[0].init();
            TUI.env.os[0].show(0);
            myApp.close = function() {
                TUI.env.os[0].desktopTask.close()
            }
            ;
            $("#desktopFrame1").css({
                left: -($(window).width() + 50),
                opacity: 0
            });
            $("#desktopFrame1").animate({
                left: 0,
                opacity: 1,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, 1E3, function() {
                playSound("desktop")
            });
            $("#loginFrame").animate({
                left: $(window).width() + 50,
                opacity: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, 1E3, function() {
                $("#loginFrame").hide()
            })
        }
    })
}
;SmartManage = function(h, g) {
    return {
        init: function() {
            this.container = h;
            this.magicTimeSpan = 0;
            this.ModalWindwos = null;
            this.WindowHandle = [];
            this.WidgetHandle = [];
            var b = g ? g : {};
            this.desktopFrame = new SmartDeskTop(this.container,b);
            this.desktopFrame.init();
            "" == TUI.env.us.appUrl ? $("#" + this.desktopFrame.getPanel()).html('\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Task" class\x3d"taskbar"\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Home" class\x3d"homepanel"\x3e\t\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Dock" class\x3d"dock"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Widget" class\x3d"homepanel"\x3e\t\x3cdiv class\x3d"timeevent"\x3e\x3c/div\x3e\t\x3cdiv class\x3d"timeline"\x3e\t\t\x3cdiv class\x3d"linebar1"\x3e\t\t\t\x3clable class\x3d"startdate"\x3e\u5f53\u524d\x3c/lable\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"currbar"\x3e\t\t\t\x3clable class\x3d"currdate"\x3e\x3c/lable\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"linebar2"\x3e\t\t\t\x3clable class\x3d"enddate"\x3e\x3c/lable\x3e\t\t\x3c/div\x3e\t\x3c/div\x3e\x3c/div\x3e') : $("#" + this.desktopFrame.getPanel()).html('\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Task" class\x3d"taskbar"\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Home" class\x3d"homepanel"\x3e\t\x3ciframe id\x3d"' + this.desktopFrame.getPanel() + '_Insight" width\x3d"100%" height\x3d"100%" frameborder\x3d"0" src\x3d"' + TUI.env.us.appUrl + '"\x3e\x3c/iframe\x3e\t\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Dock" class\x3d"dock" style\x3d"width:80%"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.desktopFrame.getPanel() + '_Widget" class\x3d"homepanel"\x3e\t\x3cdiv class\x3d"timeevent"\x3e\x3c/div\x3e\t\x3cdiv class\x3d"timeline"\x3e\t\t\x3cdiv class\x3d"linebar1"\x3e\t\t\t\x3clable class\x3d"startdate"\x3e\u5f53\u524d\x3c/lable\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"currbar"\x3e\t\t\t\x3clable class\x3d"currdate"\x3e\x3c/lable\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"linebar2"\x3e\t\t\t\x3clable class\x3d"enddate"\x3e\x3c/lable\x3e\t\t\x3c/div\x3e\t\x3c/div\x3e\x3c/div\x3e');
            TUI.env.us.isHashChange = !0;
            window.onhashchange = function() {
                if (TUI.env.us.isHashChange) {
                    if ("" != location.hash && void 0 != location.hash) {
                        var a = location.hash.substr(1);
                        if ("login" == a)
                            $.ajax({
                                type: "get",
                                url: "/System/srv/logout.ejs",
                                error: function(a) {
                                    playSound("error");
                                    toastr[error]("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u6ce8\u9500\u8d26\u6237")
                                },
                                success: function(a) {
                                    top.location.href = "/"
                                }
                            });
                        else if ("desktop" == a)
                            TUI.env.os[0].hideAllHandle();
                        else if ("start" == a)
                            $("#" + TUI.env.os[0].desktopFrame.getPanel() + "_Task").find(".HomeButton").trigger(TUI.env.ua.clickEventDown),
                            TUI.env.us.isHashChange = !0;
                        else if ("app" == a)
                            $("#" + TUI.env.os[0].desktopFrame.getPanel() + "_Task").find(".ApplyButton").trigger(TUI.env.ua.clickEventDown),
                            TUI.env.us.isHashChange = !0;
                        else if ("theme" == a)
                            $("#" + TUI.env.os[0].desktopFrame.getPanel() + "_Task").find(".ThemeButton").trigger(TUI.env.ua.clickEventDown),
                            TUI.env.us.isHashChange = !0;
                        else if (TUI.env.os[0].checkHandle(a))
                            TUI.env.os[0].activeHandle(a);
                        else
                            for (var b = 0; b < TUI.env.cfg.system.installApp.length; b++)
                                if (TUI.env.cfg.system.installApp[b].appid == a) {
                                    a = new Dialog({
                                        container: TUI.env.os[0].container,
                                        type: "iframe",
                                        value: TUI.env.cfg.system.installApp[b].app.launch.local_path
                                    },{
                                        title: TUI.env.cfg.system.installApp[b].name,
                                        taskImg: TUI.env.cfg.system.installApp[b].urlPath + "/" + TUI.env.cfg.system.installApp[b].icons.logo,
                                        handle: TUI.env.os[TUI.env.desktop - 1],
                                        appid: TUI.env.cfg.system.installApp[b].appid,
                                        urlPath: TUI.env.cfg.system.installApp[b].urlPath,
                                        afterShow: function() {},
                                        afterHide: function() {
                                            this.handle.hideHandle(TUI.env.cfg.system.installApp[b].appid)
                                        },
                                        afterClose: function() {
                                            this.handle.delHandle(TUI.env.cfg.system.installApp[b].appid)
                                        },
                                        afterSwitch: function() {
                                            this.handle.switchHandle(TUI.env.cfg.system.installApp[b].appid)
                                        },
                                        modal: !1,
                                        center: !0,
                                        width: TUI.env.cfg.system.installApp[b].app.launch.width,
                                        height: TUI.env.cfg.system.installApp[b].app.launch.height
                                    });
                                    a.show();
                                    TUI.env.os[TUI.env.desktop - 1].addHandle(a, TUI.env.cfg.system.installApp[b].name, TUI.env.cfg.system.installApp[b].urlPath + "/" + TUI.env.cfg.system.installApp[b].icons.logo, TUI.env.cfg.system.installApp[b].appid);
                                    break
                                }
                    }
                } else
                    TUI.env.us.isHashChange = !0
            }
            ;
            this.desktopTask = new SmartTask(this.desktopFrame.getPanel() + "_Task",{
                handle: this,
                fn: function(a) {
                    a.data.handle.hideAllHandle()
                }
            });
            this.desktopTask.init();
            this.desktopDock = new SmartDock(this.desktopFrame.getPanel() + "_Dock");
            this.desktopDock.init();
            for (i = 0; i < TUI.env.cfg.desktop[b.id - 1].dockList.length; i++)
                0 <= TUI.env.cfg.desktop[b.id - 1].dockList[i].appid.indexOf("Pad-") ? this.desktopDock.addApp(TUI.env.cfg.desktop[b.id - 1].dockList[i].name, TUI.env.cfg.desktop[b.id - 1].dockList[i].logoPath, TUI.env.cfg.desktop[b.id - 1].dockList[i].appid, TUI.env.cfg.desktop[b.id - 1].dockList[i].urlPath, this, function(a) {
                    if (a.data.handle.checkHandle(a.data.appID))
                        a.data.handle.activeHandle(a.data.appID);
                    else
                        for (a.data.handle.desktopDock.setMsgActive(a.data.appID),
                        j = 0; j < TUI.env.cfg.desktop[b.id - 1].dockList.length; j++)
                            if (TUI.env.cfg.desktop[b.id - 1].dockList[j].appid == a.data.appID) {
                                var c = new Dialog({
                                    container: a.data.handle.container,
                                    type: "iframe",
                                    value: a.data.appLaunch
                                },{
                                    title: a.data.appName + "\u2014\u2014\u5de5\u4f5c\u53f0",
                                    taskImg: a.data.appImg,
                                    handle: a.data.handle,
                                    appid: a.data.appID,
                                    urlPath: TUI.env.cfg.desktop[b.id - 1].dockList[j].urlPath,
                                    afterShow: function() {},
                                    afterHide: function() {
                                        this.handle.hideHandle(a.data.appID)
                                    },
                                    afterClose: function() {
                                        this.handle.delHandle(a.data.appID)
                                    },
                                    afterSwitch: function() {
                                        this.handle.switchHandle(a.data.appID)
                                    },
                                    modal: !1,
                                    center: !0,
                                    width: 1024,
                                    height: 720
                                });
                                c.show();
                                a.data.handle.addHandle(c, a.data.appName, a.data.appImg, a.data.appID);
                                break
                            }
                }) : this.desktopDock.addApp(TUI.env.cfg.desktop[b.id - 1].dockList[i].name, TUI.env.cfg.desktop[b.id - 1].dockList[i].urlPath + "/" + TUI.env.cfg.desktop[b.id - 1].dockList[i].icons.logo, TUI.env.cfg.desktop[b.id - 1].dockList[i].appid, TUI.env.cfg.desktop[b.id - 1].dockList[i].app.launch.local_path, this, function(a) {
                    if (a.data.handle.checkHandle(a.data.appID))
                        a.data.handle.activeHandle(a.data.appID);
                    else
                        for (a.data.handle.desktopDock.setMsgActive(a.data.appID),
                        j = 0; j < TUI.env.cfg.desktop[b.id - 1].dockList.length; j++)
                            if (TUI.env.cfg.desktop[b.id - 1].dockList[j].appid == a.data.appID) {
                                var c = new Dialog({
                                    container: a.data.handle.container,
                                    type: "iframe",
                                    value: a.data.appLaunch
                                },{
                                    title: a.data.appName,
                                    taskImg: a.data.appImg,
                                    handle: a.data.handle,
                                    appid: a.data.appID,
                                    urlPath: TUI.env.cfg.desktop[b.id - 1].dockList[j].urlPath,
                                    afterShow: function() {},
                                    afterHide: function() {
                                        this.handle.hideHandle(a.data.appID)
                                    },
                                    afterClose: function() {
                                        this.handle.delHandle(a.data.appID)
                                    },
                                    afterSwitch: function() {
                                        this.handle.switchHandle(a.data.appID)
                                    },
                                    modal: !1,
                                    center: !0,
                                    width: TUI.env.cfg.desktop[b.id - 1].dockList[j].app.launch.width,
                                    height: TUI.env.cfg.desktop[b.id - 1].dockList[j].app.launch.height
                                });
                                c.show();
                                a.data.handle.addHandle(c, a.data.appName, a.data.appImg, a.data.appID);
                                break
                            }
                });
            this.desktopShortcut = new SmartShortcut(this.desktopFrame.getPanel() + "_Home");
            this.desktopShortcut.init();
            for (i = 0; i < TUI.env.cfg.desktop[b.id - 1].appList.length; i++)
                0 <= TUI.env.cfg.desktop[b.id - 1].appList[i].appid.indexOf("Pad-") ? this.desktopShortcut.addShortcut(TUI.env.cfg.desktop[b.id - 1].appList[i].name, TUI.env.cfg.desktop[b.id - 1].appList[i].name, TUI.env.cfg.desktop[b.id - 1].appList[i].logoPath, TUI.env.cfg.desktop[b.id - 1].appList[i].appid, TUI.env.cfg.desktop[b.id - 1].appList[i].urlPath, this, TUI.env.cfg.desktop[b.id - 1].appList[i].top, TUI.env.cfg.desktop[b.id - 1].appList[i].left, function(a) {
                    if (a.data.handle.checkHandle(a.data.shortcutID))
                        a.data.handle.activeHandle(a.data.shortcutID);
                    else
                        for (j = 0; j < TUI.env.cfg.desktop[b.id - 1].appList.length; j++)
                            if (TUI.env.cfg.desktop[b.id - 1].appList[j].appid == a.data.shortcutID) {
                                var c = new Dialog({
                                    container: a.data.handle.container,
                                    type: "iframe",
                                    value: a.data.shortcutLaunch
                                },{
                                    title: a.data.appName + "\u2014\u2014\u5de5\u4f5c\u53f0",
                                    taskImg: a.data.shortcutImg,
                                    handle: a.data.handle,
                                    appid: a.data.shortcutID,
                                    urlPath: TUI.env.cfg.desktop[b.id - 1].appList[j].urlPath,
                                    afterShow: function() {},
                                    afterHide: function() {
                                        this.handle.hideHandle(a.data.shortcutID)
                                    },
                                    afterClose: function() {
                                        this.handle.delHandle(a.data.shortcutID)
                                    },
                                    afterSwitch: function() {
                                        this.handle.switchHandle(a.data.shortcutID)
                                    },
                                    modal: !1,
                                    center: !0,
                                    width: 1024,
                                    height: 720
                                });
                                c.show();
                                a.data.handle.addHandle(c, a.data.shortcutName, a.data.shortcutImg, a.data.shortcutID);
                                break
                            }
                }) : this.desktopShortcut.addShortcut(TUI.env.cfg.desktop[b.id - 1].appList[i].name, TUI.env.cfg.desktop[b.id - 1].appList[i]["short"], TUI.env.cfg.desktop[b.id - 1].appList[i].urlPath + "/" + TUI.env.cfg.desktop[b.id - 1].appList[i].icons.logo, TUI.env.cfg.desktop[b.id - 1].appList[i].appid, TUI.env.cfg.desktop[b.id - 1].appList[i].app.launch.local_path, this, TUI.env.cfg.desktop[b.id - 1].appList[i].top, TUI.env.cfg.desktop[b.id - 1].appList[i].left, function(a) {
                    if (a.data.handle.checkHandle(a.data.shortcutID))
                        a.data.handle.activeHandle(a.data.shortcutID);
                    else
                        for (j = 0; j < TUI.env.cfg.desktop[b.id - 1].appList.length; j++)
                            if (TUI.env.cfg.desktop[b.id - 1].appList[j].appid == a.data.shortcutID) {
                                var c = new Dialog({
                                    container: a.data.handle.container,
                                    type: "iframe",
                                    value: a.data.shortcutLaunch
                                },{
                                    title: a.data.appName,
                                    taskImg: a.data.shortcutImg,
                                    handle: a.data.handle,
                                    appid: a.data.shortcutID,
                                    urlPath: TUI.env.cfg.desktop[b.id - 1].appList[j].urlPath,
                                    afterShow: function() {},
                                    afterHide: function() {
                                        this.handle.hideHandle(a.data.shortcutID)
                                    },
                                    afterClose: function() {
                                        this.handle.delHandle(a.data.shortcutID)
                                    },
                                    afterSwitch: function() {
                                        this.handle.switchHandle(a.data.shortcutID)
                                    },
                                    modal: !1,
                                    center: !0,
                                    width: TUI.env.cfg.desktop[b.id - 1].appList[j].app.launch.width,
                                    height: TUI.env.cfg.desktop[b.id - 1].appList[j].app.launch.height
                                });
                                c.show();
                                a.data.handle.addHandle(c, a.data.shortcutName, a.data.shortcutImg, a.data.shortcutID);
                                break
                            }
                });
            for (i = 0; i < TUI.env.cfg.desktop[b.id - 1].widgetList.length; i++)
                this.addWidget(new Widget({
                    container: this.desktopFrame.getPanel() + "_Home",
                    type: "iframe",
                    value: TUI.env.cfg.desktop[b.id - 1].widgetList[i].urlPath
                },{
                    handle: this,
                    appId: TUI.env.cfg.desktop[b.id - 1].widgetList[i].appid,
                    top: TUI.env.cfg.desktop[b.id - 1].widgetList[i].top,
                    right: TUI.env.cfg.desktop[b.id - 1].widgetList[i].right,
                    height: TUI.env.cfg.desktop[b.id - 1].widgetList[i].app.launch.height,
                    width: TUI.env.cfg.desktop[b.id - 1].widgetList[i].app.launch.width,
                    launchFile: TUI.env.cfg.desktop[b.id - 1].widgetList[i].app.launch.local_path,
                    fullscreen: TUI.env.cfg.desktop[b.id - 1].widgetList[i].app.launch.fullscreen,
                    boxshadow: TUI.env.cfg.desktop[b.id - 1].widgetList[i].app.launch.boxshadow
                }));
            $("#" + this.desktopFrame.getPanel() + "_Home").bind("mousewheel", {
                handle: this
            }, function(a, b) {
                a.data.handle.magicHandle(b);
                return !1
            })
        },
        show: function(b) {
            this.desktopFrame.show(b);
            $(this).oneTime(1E3, function() {
                this.desktopDock.show();
                this.desktopTask.show();
                this.desktopShortcut.show()
            })
        },
        hide: function(b) {
            this.desktopFrame.hide(b)
        },
        uninstall: function(b, a) {
            var c = this;
            this.delHandle(b);
            for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].appList.length; i++)
                if (TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].appid == b) {
                    $.ajax({
                        type: "post",
                        url: "/System/srv/delshortcut.ejs",
                        data: {
                            appId: b,
                            deskTop: TUI.env.desktop
                        },
                        dataType: "json",
                        error: function(a) {
                            playSound("error");
                            toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u684c\u9762\u5feb\u6377")
                        },
                        success: function(a) {
                            TUI.env.cfg = a;
                            playSound("info");
                            c.desktopShortcut.delShortcut(b);
                            toastr.success("\u5220\u9664\u5e94\u7528\u7a0b\u5e8f\u684c\u9762\u5feb\u6377\u6210\u529f\uff01", "\u5220\u9664\u684c\u9762\u5feb\u6377")
                        }
                    });
                    break
                }
            for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList.length; i++)
                TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].appid == b && $.ajax({
                    type: "post",
                    url: "/System/srv/deldock.ejs",
                    data: {
                        appId: b,
                        deskTop: TUI.env.desktop
                    },
                    dataType: "json",
                    error: function(a) {
                        playSound("error");
                        toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u505c\u9760\u680f\u5feb\u6377")
                    },
                    success: function(a) {
                        TUI.env.cfg = a;
                        playSound("info");
                        c.desktopDock.delApp(b);
                        toastr.success("\u5220\u9664\u5e94\u7528\u7a0b\u5e8f\u505c\u9760\u680f\u5feb\u6377\u6210\u529f\uff01", "\u5220\u9664\u505c\u9760\u680f\u5feb\u6377")
                    }
                })
        },
        setWidget: function(b, a, c) {
            var e = this
              , d = 0;
            for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList.length; i++)
                if (TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].appid == b) {
                    d = 1;
                    1 == c ? (e.delWidget(b),
                    toastr.success("\u4ece\u5f53\u524d\u7528\u6237\u684c\u9762\u79fb\u9664\u90e8\u4ef6\u6210\u529f\uff01", "\u79fb\u9664\u684c\u9762\u90e8\u4ef6")) : toastr.info("\u5f53\u524d\u90e8\u4ef6\u5df2\u653e\u7f6e\u4e8e\u60a8\u7684\u684c\u9762,\u8bf7\u67e5\u9605", "\u8bbe\u7f6e\u684c\u9762\u90e8\u4ef6");
                    break
                }
            0 == d && $.ajax({
                type: "post",
                url: "/System/srv/addwidget.ejs",
                data: {
                    appId: b,
                    urlPath: a,
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {
                    playSound("error");
                    toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u8bbe\u7f6e\u684c\u9762\u90e8\u4ef6")
                },
                success: function(a) {
                    TUI.env.cfg = a;
                    for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList.length; i++)
                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].appid == b) {
                            e.addWidget(new Widget({
                                container: e.desktopFrame.getPanel() + "_Home",
                                type: "iframe",
                                value: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].urlPath
                            },{
                                handle: e,
                                appId: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].appid,
                                top: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].top,
                                right: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].right,
                                height: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].app.launch.height,
                                width: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].app.launch.width,
                                launchFile: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].app.launch.local_path,
                                fullscreen: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].app.launch.fullscreen,
                                boxshadow: TUI.env.cfg.desktop[TUI.env.desktop - 1].widgetList[i].app.launch.boxshadow
                            }));
                            playSound("info");
                            break
                        }
                }
            })
        },
        setAppShortcut: function(b, a, c, e) {
            var d = this
              , f = 0;
            for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].appList.length; i++)
                if (TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].appid == b) {
                    f = 1;
                    $.ajax({
                        type: "post",
                        url: "/System/srv/delshortcut.ejs",
                        data: {
                            appId: b,
                            deskTop: TUI.env.desktop
                        },
                        dataType: "json",
                        error: function(a) {
                            playSound("error");
                            toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u684c\u9762\u5feb\u6377")
                        },
                        success: function(a) {
                            TUI.env.cfg = a;
                            playSound("info");
                            d.desktopShortcut.delShortcut(b);
                            toastr.success("\u5220\u9664\u5e94\u7528\u7a0b\u5e8f\u684c\u9762\u5feb\u6377\u6210\u529f\uff01", "\u5220\u9664\u684c\u9762\u5feb\u6377")
                        }
                    });
                    break
                }
            0 == f && $.ajax({
                type: "post",
                url: "/System/srv/addshortcut.ejs",
                data: {
                    appId: b,
                    urlPath: a,
                    title: c,
                    logoPath: e,
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {
                    playSound("error");
                    toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u6dfb\u52a0\u684c\u9762\u5feb\u6377")
                },
                success: function(a) {
                    TUI.env.cfg = a;
                    for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].appList.length; i++)
                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].appid == b) {
                            0 <= b.indexOf("Pad-") ? d.desktopShortcut.addShortcut(TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].name, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].name, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].logoPath, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].appid, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].urlPath, d, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].top, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].left, function(a) {
                                if (a.data.handle.checkHandle(a.data.shortcutID))
                                    a.data.handle.activeHandle(a.data.shortcutID);
                                else
                                    for (j = 0; j < TUI.env.cfg.desktop[TUI.env.desktop - 1].appList.length; j++)
                                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].appid == a.data.shortcutID) {
                                            var b = new Dialog({
                                                container: a.data.handle.container,
                                                type: "iframe",
                                                value: a.data.shortcutLaunch
                                            },{
                                                title: a.data.appName + "\u2014\u2014\u5de5\u4f5c\u53f0",
                                                taskImg: a.data.shortcutImg,
                                                handle: a.data.handle,
                                                appid: a.data.shortcutID,
                                                urlPath: TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].urlPath,
                                                afterShow: function() {},
                                                afterHide: function() {
                                                    this.handle.hideHandle(a.data.shortcutID)
                                                },
                                                afterClose: function() {
                                                    this.handle.delHandle(a.data.shortcutID)
                                                },
                                                afterSwitch: function() {
                                                    this.handle.switchHandle(a.data.shortcutID)
                                                },
                                                modal: !1,
                                                center: !0,
                                                width: 1024,
                                                height: 720
                                            });
                                            b.show();
                                            a.data.handle.addHandle(b, a.data.shortcutName, a.data.shortcutImg, a.data.shortcutID);
                                            break
                                        }
                            }) : d.desktopShortcut.addShortcut(TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].name, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i]["short"], TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].urlPath + "/" + TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].icons.logo, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].appid, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].app.launch.local_path, d, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].top, TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[i].left, function(a) {
                                if (a.data.handle.checkHandle(a.data.shortcutID))
                                    a.data.handle.activeHandle(a.data.shortcutID);
                                else
                                    for (j = 0; j < TUI.env.cfg.desktop[TUI.env.desktop - 1].appList.length; j++)
                                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].appid == a.data.shortcutID) {
                                            var b = new Dialog({
                                                container: a.data.handle.container,
                                                type: "iframe",
                                                value: a.data.shortcutLaunch
                                            },{
                                                title: a.data.appName,
                                                taskImg: a.data.shortcutImg,
                                                handle: a.data.handle,
                                                appid: a.data.shortcutID,
                                                urlPath: TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].urlPath,
                                                afterShow: function() {},
                                                afterHide: function() {
                                                    this.handle.hideHandle(a.data.shortcutID)
                                                },
                                                afterClose: function() {
                                                    this.handle.delHandle(a.data.shortcutID)
                                                },
                                                afterSwitch: function() {
                                                    this.handle.switchHandle(a.data.shortcutID)
                                                },
                                                modal: !1,
                                                center: !0,
                                                width: TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].app.launch.width,
                                                height: TUI.env.cfg.desktop[TUI.env.desktop - 1].appList[j].app.launch.height
                                            });
                                            b.show();
                                            a.data.handle.addHandle(b, a.data.shortcutName, a.data.shortcutImg, a.data.shortcutID);
                                            break
                                        }
                            });
                            break
                        }
                    playSound("info")
                }
            })
        },
        setAppDock: function(b, a, c, e) {
            var d = this
              , f = 0;
            for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList.length; i++)
                if (TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].appid == b) {
                    f = 1;
                    $.ajax({
                        type: "post",
                        url: "/System/srv/deldock.ejs",
                        data: {
                            appId: b,
                            deskTop: TUI.env.desktop
                        },
                        dataType: "json",
                        error: function(a) {
                            playSound("error");
                            toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u505c\u9760\u680f\u5feb\u6377")
                        },
                        success: function(a) {
                            TUI.env.cfg = a;
                            playSound("info");
                            d.desktopDock.delApp(b);
                            toastr.success("\u5220\u9664\u5e94\u7528\u7a0b\u5e8f\u505c\u9760\u680f\u5feb\u6377\u6210\u529f\uff01", "\u5220\u9664\u505c\u9760\u680f\u5feb\u6377")
                        }
                    });
                    break
                }
            0 == f && $.ajax({
                type: "post",
                url: "/System/srv/adddock.ejs",
                data: {
                    appId: b,
                    urlPath: a,
                    title: c,
                    logoPath: e,
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {
                    playSound("error");
                    toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u6dfb\u52a0\u505c\u9760\u680f\u5feb\u6377")
                },
                success: function(a) {
                    TUI.env.cfg = a;
                    for (i = 0; i < TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList.length; i++)
                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].appid == b) {
                            0 <= b.indexOf("Pad-") ? d.desktopDock.addApp(TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].name, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].logoPath, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].appid, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].urlPath, d, function(a) {
                                if (a.data.handle.checkHandle(a.data.appID))
                                    a.data.handle.activeHandle(a.data.appID);
                                else
                                    for (a.data.handle.desktopDock.setMsgActive(a.data.appID),
                                    j = 0; j < TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList.length; j++)
                                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].appid == a.data.appID) {
                                            var b = new Dialog({
                                                container: a.data.handle.container,
                                                type: "iframe",
                                                value: a.data.appLaunch
                                            },{
                                                title: a.data.appName + "\u2014\u2014\u5de5\u4f5c\u53f0",
                                                taskImg: a.data.appImg,
                                                handle: a.data.handle,
                                                appid: a.data.appID,
                                                urlPath: TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].urlPath,
                                                afterShow: function() {},
                                                afterHide: function() {
                                                    this.handle.hideHandle(a.data.appID)
                                                },
                                                afterClose: function() {
                                                    this.handle.delHandle(a.data.appID)
                                                },
                                                afterSwitch: function() {
                                                    this.handle.switchHandle(a.data.appID)
                                                },
                                                modal: !1,
                                                center: !0,
                                                width: 1024,
                                                height: 720
                                            });
                                            b.show();
                                            a.data.handle.addHandle(b, a.data.appName, a.data.appImg, a.data.appID);
                                            break
                                        }
                            }) : d.desktopDock.addApp(TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].name, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].urlPath + "/" + TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].icons.logo, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].appid, TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[i].app.launch.local_path, d, function(a) {
                                if (a.data.handle.checkHandle(a.data.appID))
                                    a.data.handle.activeHandle(a.data.appID);
                                else
                                    for (a.data.handle.desktopDock.setMsgActive(a.data.appID),
                                    j = 0; j < TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList.length; j++)
                                        if (TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].appid == a.data.appID) {
                                            var b = new Dialog({
                                                container: a.data.handle.container,
                                                type: "iframe",
                                                value: a.data.appLaunch
                                            },{
                                                title: a.data.appName,
                                                taskImg: a.data.appImg,
                                                handle: a.data.handle,
                                                appid: a.data.appID,
                                                urlPath: TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].urlPath,
                                                afterShow: function() {},
                                                afterHide: function() {
                                                    this.handle.hideHandle(a.data.appID)
                                                },
                                                afterClose: function() {
                                                    this.handle.delHandle(a.data.appID)
                                                },
                                                afterSwitch: function() {
                                                    this.handle.switchHandle(a.data.appID)
                                                },
                                                modal: !1,
                                                center: !0,
                                                width: TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].app.launch.width,
                                                height: TUI.env.cfg.desktop[TUI.env.desktop - 1].dockList[j].app.launch.height
                                            });
                                            b.show();
                                            a.data.handle.addHandle(b, a.data.appName, a.data.appImg, a.data.appID);
                                            break
                                        }
                            });
                            break
                        }
                    playSound("info")
                }
            })
        },
        addWidget: function(b) {
            this.WidgetHandle[this.WidgetHandle.length] = b;
            $(this).oneTime(500, function() {
                b.show()
            })
        },
        delWidget: function(b) {
            for (i = 0; i < this.WidgetHandle.length; i++)
                if (this.WidgetHandle[i].getAppId() == b) {
                    this.WidgetHandle[i].close();
                    delete this.WidgetHandle[i];
                    this.WidgetHandle.splice(i, 1);
                    break
                }
        },
        hideWidget: function() {
            for (i = 0; i < this.WidgetHandle.length; i++)
                this.WidgetHandle[i].hide()
        },
        addHandle: function(b, a, c, e) {
            this.WindowHandle[this.WindowHandle.length] = [b, e];
            this.desktopTask.addTaskButton(a, c, e, this, function(a) {
                a.data.handle.activeHandle(a.data.taskID)
            });
            this.switchHandle(e)
        },
        delHandle: function(b) {
            for (i = 0; i < this.WindowHandle.length; i++)
                if (this.WindowHandle[i][1] == b) {
                    delete this.WindowHandle[i];
                    this.WindowHandle.splice(i, 1);
                    this.desktopTask.delTaskButton(b);
                    break
                }
            for (i = this.WindowHandle.length - 1; 0 <= i; i--)
                if (this.WindowHandle[i][1] != b && this.WindowHandle[i][0].getShowFlag()) {
                    this.desktopTask.setTaskActive(this.WindowHandle[i][1]);
                    this.WindowHandle[i][0].setActive();
                    break
                }
        },
        hideHandle: function(b) {
            this.desktopTask.setTaskNormal(b);
            for (i = this.WindowHandle.length - 1; 0 <= i; i--)
                if (this.WindowHandle[i][1] != b && this.WindowHandle[i][0].getShowFlag()) {
                    this.desktopTask.setTaskActive(this.WindowHandle[i][1]);
                    this.WindowHandle[i][0].setActive();
                    break
                }
        },
        hideAllHandle: function() {
            for (i = 0; i < this.WindowHandle.length; i++)
                this.WindowHandle[i][0].getShowFlag() && (this.WindowHandle[i][0].hide(),
                this.desktopTask.setTaskNormal(this.WindowHandle[i][1]));
            this.desktopTask.clear()
        },
        showAllHandle: function() {
            var b = 0;
            for (i = 0; i < this.WindowHandle.length; i++)
                if (i < this.WindowHandle.length - 1) {
                    this.desktopTask.setTaskNormal(this.WindowHandle[i][1]);
                    b++;
                    var a = b / this.WindowHandle.length;
                    .75 > a && (a = .75);
                    .9 < a && (a = .9);
                    this.WindowHandle[i][0].rest();
                    this.WindowHandle[i][0].setNormal(a)
                } else
                    this.desktopTask.setTaskActive(this.WindowHandle[i][1]),
                    this.WindowHandle[i][0].rest(),
                    this.WindowHandle[i][0].setActive()
        },
        activeHandle: function(b) {
            var a = 0;
            for (i = 0; i < this.WindowHandle.length; i++)
                if (this.WindowHandle[i][1] != b) {
                    if (this.WindowHandle[i][0].getShowFlag()) {
                        this.desktopTask.setTaskNormal(this.WindowHandle[i][1]);
                        a++;
                        var c = a / this.WindowHandle.length;
                        .75 > c && (c = .75);
                        .9 < c && (c = .9);
                        this.WindowHandle[i][0].setNormal(c)
                    }
                } else
                    this.desktopTask.setTaskActive(b),
                    this.WindowHandle[i][0].getShowFlag() ? this.WindowHandle[i][0].setActive() : this.WindowHandle[i][0].rest()
        },
        switchHandle: function(b) {
            var a = 0;
            for (i = 0; i < this.WindowHandle.length; i++)
                if (this.WindowHandle[i][1] != b) {
                    if (this.WindowHandle[i][0].getShowFlag()) {
                        this.desktopTask.setTaskNormal(this.WindowHandle[i][1]);
                        a++;
                        var c = a / this.WindowHandle.length;
                        .75 > c && (c = .75);
                        .9 < c && (c = .9);
                        this.WindowHandle[i][0].setNormal(c)
                    }
                } else
                    this.desktopTask.setTaskActive(b),
                    this.WindowHandle[i][0].setActive()
        },
        magicHandle: function(b) {
            if (!(0 == b || 2 > this.WindowHandle.length)) {
                var a = new Date;
                if (1 <= a.getTime() / 1E3 - this.magicTimeSpan) {
                    this.magicTimeSpan = a.getTime() / 1E3;
                    a = [];
                    for (i = 0; i < this.WindowHandle.length; i++)
                        this.WindowHandle[i][0].getShowFlag() && (a[a.length] = [this.WindowHandle[i][0], this.WindowHandle[i][1], this.WindowHandle[i][0].getTop(), this.WindowHandle[i][0].getLeft(), this.WindowHandle[i][0].getWidth(), this.WindowHandle[i][0].getHeight(), this.WindowHandle[i][0].getZindex()]);
                    if (0 != a.length) {
                        a.sort(function(a, b) {
                            return a[6] < b[6] ? -1 : 1
                        });
                        if (0 > b)
                            for (b = [a[0][2], a[0][3], a[0][4], a[0][5], a[0][6]],
                            i = 0; i < a.length; i++)
                                i == a.length - 1 ? (a[i][2] = b[0],
                                a[i][3] = b[1],
                                a[i][4] = b[2],
                                a[i][5] = b[3],
                                a[i][6] = b[4]) : (a[i][2] = a[i + 1][2],
                                a[i][3] = a[i + 1][3],
                                a[i][4] = a[i + 1][4],
                                a[i][5] = a[i + 1][5],
                                a[i][6] = a[i + 1][6]);
                        else
                            for (b = [a[a.length - 1][2], a[a.length - 1][3], a[a.length - 1][4], a[a.length - 1][5], a[a.length - 1][6]],
                            i = a.length - 1; 0 <= i; i--)
                                0 == i ? (a[i][2] = b[0],
                                a[i][3] = b[1],
                                a[i][4] = b[2],
                                a[i][5] = b[3],
                                a[i][6] = b[4]) : (a[i][2] = a[i - 1][2],
                                a[i][3] = a[i - 1][3],
                                a[i][4] = a[i - 1][4],
                                a[i][5] = a[i - 1][5],
                                a[i][6] = a[i - 1][6]);
                        a.sort(function(a, b) {
                            return a[6] < b[6] ? -1 : 1
                        });
                        this.desktopTask.setTaskActive(a[a.length - 1][1]);
                        for (i = b = 0; i < a.length; i++) {
                            b++;
                            var c = b / a.length;
                            .75 > c && (c = .75);
                            .9 < c && (c = .9);
                            i == a.length - 1 && (c = 1);
                            a[i][0].magic(a[i][2], a[i][3], a[i][4], a[i][5], c, a[i][6], 600);
                            1 > c ? this.desktopTask.setTaskNormal(a[i][1]) : this.desktopTask.setTaskActive(a[i][1])
                        }
                    }
                }
            }
        },
        checkHandle: function(b) {
            for (i = 0; i < this.WindowHandle.length; i++)
                if (this.WindowHandle[i][1] == b)
                    return !0;
            return !1
        },
        disActionWindow: function() {
            for (i = 0; i < this.WindowHandle.length; i++)
                this.WindowHandle[i][0].getZindex() < Dialog.__zindex && this.WindowHandle[i][0].disAction()
        }
    }
}
;
SmartShortcut = function(g, v) {
    var h = 0, k = 0, l = 0, m = 0, c = 0, f = 0, e = 0, n;
    return {
        init: function() {
            this.container = g;
            this.shortcutCount = 0;
            $(".homepanel").bind(TUI.env.ua.clickEventDown, function(b) {
                $(".homepanel .shortcut .close").hide()
            })
        },
        show: function() {
            0 == parseInt($("#" + this.container).css("left")) ? $("#" + this.container).fadeIn(600) : ($("#" + this.container).css({
                left: -$(window).width()
            }),
            $("#" + this.container).animate({
                left: 0,
                opacity: 1
            }, "slow"))
        },
        hide: function() {
            $("#" + this.container).animate({
                left: $(window).width(),
                opacity: 0
            }, "normal")
        },
        addShortcut: function(b, p, d, a, g, q, r, t, u) {
            "0CB4D644-896A-4ADA-9D5F-58448BD04499" == a ? d = "/System/srv/userpic.ejs?userid\x3d" + TUI.env.us.userName : "0CB4D644-896A-4ADA-9D5F-58448BD04499" == a && (d = "/Webapp/Calendar/Resources/Images/" + (new Date).Format("MMdd") + ".png");
            $("#" + this.container).append('\x3cdiv id\x3d"' + this.container + "_" + a + '" class\x3d"shortcut"\x3e\x3cdiv class\x3d"content"\x3e\x3cdiv class\x3d"number"\x3e\x3c/div\x3e\x3cdiv class\x3d"close"\x3e\x3c/div\x3e\x3cimg src\x3d"' + d + '" border\x3d"0" alt\x3d"" onmousedown\x3d"return false;"\x3e\x3cdiv class\x3d"name" translate\x3d"no"\x3e' + p + "\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");
            $("#" + this.container + "_" + a).css({
                top: r,
                left: t,
                opacity: 0
            });
            $(this).oneTime(300, function() {
                $("#" + this.container + "_" + a).animate({
                    opacity: 1
                }, "slow")
            });
            this.shortcutCount++;
            $("#" + this.container + "_" + a).find(".content").bind("windows" == TUI.env.ua.os ? "mouseup" : TUI.env.ua.clickEventUp, {
                handle: this,
                appName: b,
                shortcutName: p,
                shortcutImg: d,
                shortcutID: a,
                shortcutLaunch: g,
                handle: q,
                fn: u
            }, function(a) {
                0 == f && (0 < e && 1 < (new Date).getTime() / 1E3 - e ? $(".homepanel .shortcut .close").show() : (localStorage[a.data.shortcutID + "-count"] = $(this).find(".number").html(),
                $(this).find(".number").hide(),
                a.data.fn(a)));
                $(".HomeButton").removeClass("active");
                $(".ApplyButton").removeClass("active");
                $(".ThemeButton").removeClass("active");
                $(".StartMenu").hide();
                $(".AppMenu").hide();
                $(".ThemeMenu").hide();
                $(".TaskStatus .ClockList").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .UserMenu").hide();
                $(".messagepanel").css({
                    right: -280
                });
                $(".messagepanel").hide()
            });
            $("#" + this.container + "_" + a).find(".close").bind("windows" == TUI.env.ua.os ? "mousedown" : TUI.env.ua.clickEventDown, {
                shortcutID: a,
                handle: $("#" + this.container + "_" + a)
            }, function(a) {
                $.ajax({
                    type: "post",
                    url: "/System/srv/delshortcut.ejs",
                    data: {
                        appId: a.data.shortcutID,
                        deskTop: TUI.env.desktop
                    },
                    dataType: "json",
                    error: function(a) {},
                    success: function(b) {
                        TUI.env.cfg = b;
                        a.data.handle.remove();
                        playSound("info")
                    }
                });
                return !1
            });
            $("#" + this.container + "_" + a).bind("windows" == TUI.env.ua.os ? "mousedown" : TUI.env.ua.clickEventDown, {
                shortcutID: a
            }, function(a) {
                var b = a || window.event;
                TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (a.preventDefault(),
                b = a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
                c = $(this);
                h = b.clientY - this.offsetTop;
                k = b.clientX - this.offsetLeft;
                l = b.clientY;
                m = b.clientX;
                f = 0;
                n = a.data.shortcutID;
                e = (new Date).getTime() / 1E3;
                $(this).oneTime(1500, function() {
                    0 == f && 0 < e && 1 < (new Date).getTime() / 1E3 - e && $(".homepanel .shortcut .close").show()
                });
                $(document).bind("windows" == TUI.env.ua.os ? "mousemove" : TUI.env.ua.clickEventMove, function(a) {
                    if (c) {
                        var b = new Date
                          , d = a || window.event;
                        TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (a.preventDefault(),
                        d = a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
                        if (10 < Math.abs(d.clientY - l) || 10 < Math.abs(d.clientX - m))
                            f = b.getTime() / 1E3;
                        0 < d.clientY - h ? c.css({
                            top: d.clientY - h,
                            left: d.clientX - k,
                            opacity: .7
                        }) : c.css({
                            top: 0,
                            left: d.clientX - k,
                            opacity: .7
                        })
                    }
                });
                return !1
            });
            $(document).bind("windows" == TUI.env.ua.os ? "mouseup" : TUI.env.ua.clickEventUp, function(a) {
                var b = a = 0;
                0 != c && (a = parseInt(c.css("top")),
                b = parseInt(c.css("left")),
                c.css({
                    opacity: 1
                }),
                c = 0,
                0 < f && $.ajax({
                    type: "post",
                    url: "/System/srv/mdyshortcut.ejs",
                    data: {
                        appId: n,
                        top: a,
                        left: b,
                        deskTop: TUI.env.desktop
                    },
                    dataType: "json",
                    error: function(a) {},
                    success: function(a) {
                        TUI.env.cfg = a
                    }
                }));
                e = 0;
                $(document).unbind("windows" == TUI.env.ua.os ? "mousemove" : TUI.env.ua.clickEventMove)
            })
        },
        delShortcut: function(b) {
            $("#" + this.container + "_" + b).remove()
        },
        setMsgCount: function(b, c) {
            $("#" + this.container + "_" + b).find(".number").unbind(TUI.env.ua.clickEventDown);
            0 < c.length ? ($("#" + this.container + "_" + b).find(".number").show(),
            $("#" + this.container + "_" + b).find(".number").html(c.length),
            $("#" + this.container + "_" + b).find(".number").bind(TUI.env.ua.clickEventDown, {
                msgList: c
            }, function(b) {
                for (var a = 0; a < b.data.msgList.length; a++)
                    toastr.info(b.data.msgList[a].content, b.data.msgList[a].title);
                return !1
            })) : ($("#" + this.container + "_" + b).find(".number").html(0),
            $("#" + this.container + "_" + b).find(".number").hide())
        }
    }
}
;
Slider = function(e, d) {
    return {
        init: function() {
            this.container = e;
            var a = d ? d : {};
            this.handler = a.handler ? a.handler : function() {
                alert("unlocked!")
            }
            ;
            this.callfunction = a.callfunction ? a.callfunction : function() {
                alert("unlocked!")
            }
            ;
            this.mode = a.mode ? a.mode : "click";
            this.waver = a.waver ? a.waver : 150;
            this.infoid = a.infoid ? a.infoid : "";
            this.loginHandle = a.loginHandle;
            $("#" + this.container).html('\x3cdiv class\x3d"track"\x3e\x3cdiv class\x3d"track-message"\x3e\u79fb\u52a8\u6ed1\u5757\u6765\u767b\u5f55\x3c/div\x3e\x3cdiv class\x3d"handle"\x3e\x3c/div\x3e\x3c/div\x3e');
            this.handle = $("#" + this.container + " .handle");
            this.track = $("#" + this.container + " .track");
            this.message = $("#" + this.container + " .track-message");
            var b = this;
            TUI.env.ua.ontouch ? ("noclick" == this.mode ? this.handle.bind("touchstart", function(a) {
                a.preventDefault();
                b.initX(a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
                $("html").bind("touchmove", {
                    slider: b
                }, b.slideNoClick1)
            }) : this.handle.bind("touchstart", function(a) {
                a.preventDefault();
                b.initX(a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
                $("html").bind("touchmove", {
                    slider: b
                }, b.slide1);
                $("html").one("touchend", {
                    slider: b
                }, b.release)
            }),
            "windows" == TUI.env.ua.os && ("noclick" == this.mode ? this.handle.mouseover(function(a) {
                b.initX(a);
                $("html").bind("mousemove", {
                    slider: b
                }, b.slideNoClick2)
            }) : this.handle.mousedown(function(a) {
                b.initX(a);
                $("html").bind("mousemove", {
                    slider: b
                }, b.slide2);
                $("html").one("mouseup", {
                    slider: b
                }, b.release)
            }))) : "noclick" == this.mode ? this.handle.mouseover(function(a) {
                b.initX(a);
                $("html").bind("mousemove", {
                    slider: b
                }, b.slideNoClick2)
            }) : this.handle.mousedown(function(a) {
                b.initX(a);
                $("html").bind("mousemove", {
                    slider: b
                }, b.slide2);
                $("html").one("mouseup", {
                    slider: b
                }, b.release)
            })
        },
        initX: function(a) {
            this.track.get(0);
            var b = this.track.get(0).offsetTop;
            this.track.get(0);
            var c = this.track.get(0).offsetHeight
              , d = this.handle.get(0).offsetLeft;
            this.handle.get(0);
            this.min = 0;
            this.zero = d;
            this.delta = a.clientX - this.zero;
            this.max = 218;
            this.maxY = b + c + this.waver;
            this.minY = b - this.waver
        },
        slideX: function(a) {
            return Math.max(this.min, Math.min(a.clientX - this.zero - this.delta, this.max))
        },
        slide1: function(a) {
            var b = a.data.slider;
            a.preventDefault();
            a = b.slideX(a.originalEvent.touches[0] || a.originalEvent.changedTouches[0]);
            b.handle.css("left", a);
            b.message.css("opacity", Math.max(0, 1 - 2 * a / b.max))
        },
        slide2: function(a) {
            var b = a.data.slider;
            a = b.slideX(a);
            b.handle.css("left", a);
            b.message.css("opacity", Math.max(0, 1 - 2 * a / b.max))
        },
        slideNoClick1: function(a) {
            var b = a.data.slider;
            a.preventDefault();
            var c = a.originalEvent.touches[0] || a.originalEvent.changedTouches[0];
            b.slide(c);
            (b.handle.css("left").replace(/[^0-9]/g, "") == b.max || c.clientY > b.maxY || c.clientY < b.minY) && b.release(a)
        },
        slideNoClick2: function(a) {
            var b = a.data.slider;
            b.slide(a);
            (b.handle.css("left").replace(/[^0-9]/g, "") == b.max || a.clientY > b.maxY || a.clientY < b.minY) && b.release(a)
        },
        release: function(a) {
            a = a.data.slider;
            TUI.env.ua.ontouch ? ($("html").unbind("touchmove"),
            "windows" == TUI.env.ua.os && $("html").unbind("mousemove")) : $("html").unbind("mousemove");
            a.handle.css("left").replace(/[^0-9]/g, "") == a.max ? a.handler() : a.reset()
        },
        setMessage: function(a) {
            this.message.html(a)
        },
        reset: function() {
            this.handle.animate({
                left: 0
            }, 400);
            this.message.animate({
                opacity: 1
            }, 400)
        },
        COLORS: {
            plain: 0,
            red: 1,
            green: 2
        }
    }
}
;
SmartTask = function(u, t) {
    var r = 0
      , k = {}
      , f = []
      , m = {}
      , l = 0
      , n = {}
      , g = []
      , p = {}
      , q = 0;
    return {
        init: function() {
            this.containerBar = u;
            var b = t ? t : {};
            this.home = b.handle;
            this.themelist = {
                Flag: 1,
                Message: "",
                tList: [],
                wList: []
            };
            this.fn = b.fn;
            this.isThemeEdit = this.isAppEdit = !1;
            this.msgReadCount = 0;
            this.msgWeather = 1;
            $("#" + this.containerBar).html('\x3cdiv id\x3d"' + this.containerBar + '_System" class\x3d"SystemButton"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.containerBar + '_Button" class\x3d"TaskButton"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.containerBar + '_Status" class\x3d"TaskStatus"\x3e\t\t\x3cdiv class\x3d"WeatherList"\x3e\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3cdiv class\x3d"today"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"future"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"Search"\x3e\x3cinput type\x3d"search" name\x3d"" placeholder\x3d"\u8f93\u5165\u4f60\u8981\u641c\u7d22\u7684\u5185\u5bb9"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3ci class\x3d"fa fa-search"\x3e\x3c/i\x3e\x3c/div\x3e\t\t\x3cdiv class\x3d"Message"\x3e\x3cimg src\x3d"/System/style/images/msg1.png"/\x3e\x3cdiv class\x3d"number" style\x3d"display: none;"\x3e0\x3c/div\x3e\x3c/div\x3e\t\t\x3cdiv class\x3d"Weather"\x3e\t\t\t\x3cdiv class\x3d"icon"\x3e\x3cimg src\x3d"/@Start/Weather/99.png"/\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"info"\x3e\u2014\u2103\x3c/div\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"Sayma"\x3e\x3cimg src\x3d"/System/style/images/task.png"/\x3e\x3c/div\x3e\t\t\x3cdiv class\x3d"Clock"\x3e\x3c/div\x3e\t\t\x3cdiv class\x3d"ClockList"\x3e\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3cdiv class\x3d"now"\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"today"\x3e\x3c/div\x3e\t\t\x3c/div\x3e\t\t\x3cdiv class\x3d"Picture"\x3e\x3cimg src\x3d"/System/srv/userpic.ejs?userid\x3d' + TUI.env.us.userName + '"/\x3e\x3c/div\x3e\t\t\x3cdiv class\x3d"UserMenu"\x3e\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3cul\x3e\t\t\t\t\x3cli class\x3d"doUserInfo"\x3e\x3ci class\x3d"fa fa-edit"\x3e\x3c/i\x3e\x26nbsp;\u4e2a\u6027\u7b7e\u540d\x3c/li\x3e\t\t\t\t\x3cli class\x3d"doUserPic"\x3e\x3ci class\x3d"fa fa-camera"\x3e\x3c/i\x3e\x26nbsp;\u4e0a\u4f20\u5934\u50cf\x3c/li\x3e\t\t\t\t\x3cli class\x3d"doUserPass"\x3e\x3ci class\x3d"fa fa-key"\x3e\x3c/i\x3e\x26nbsp;\u4fee\u6539\u5bc6\u7801\x3c/li\x3e\t\t\t\t\x3chr\x3e\t\t\t\t\x3cli class\x3d"doUserCenter"\x3e\x3ci class\x3d"fa fa-user"\x3e\x3c/i\x3e\x26nbsp;\u4e2a\u4eba\u4e2d\u5fc3\x3c/li\x3e\t\t\t\t\x3cli class\x3d"fullScreen"\x3e\x3ci class\x3d"fa fa-arrows-alt"\x3e\x3c/i\x3e\x26nbsp;\u5168\u5c4f\u6a21\u5f0f\x3c/li\x3e\t\t\t\t\x3cli class\x3d"exitScreen"\x3e\x3ci class\x3d"fa fa-arrows"\x3e\x3c/i\x3e\x26nbsp;\u9000\u51fa\u5168\u5c4f\x3c/li\x3e\t\t\t\t\x3chr\x3e\t\t\t\t\x3cli class\x3d"doUserLogout"\x3e\x3ci class\x3d"fa fa-sign-out"\x3e\x3c/i\x3e\x26nbsp;\u6ce8\u9500\u9000\u51fa\x3c/li\x3e\t\t\t\x3c/ul\x3e\t\t\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"' + this.containerBar + '_ShowDesktop" class\x3d"TaskShowDesktop"\x3e\x3c/div\x3e');
            $(".ClockList .now").thooClock({
                size: 150,
                dialColor: "#1099EC",
                secondHandColor: "#DDBD45",
                minuteHandColor: "#1199ec",
                hourHandColor: "#1199ec",
                alarmHandColor: "#D84C49",
                alarmHandTipColor: "#DDBD45",
                showNumerals: !0,
                brandText: "ThingsLabs"
            });
            this.loadReadMsg();
            this.loadTimeLine();
            this.dispDateTime();
            this.dispWeather();
            $(this).everyTime(15E3, function() {
                this.dispDateTime()
            });
            $(this).everyTime(9E5, function() {
                1 == this.msgWeather && this.dispWeather();
                this.loadReadMsg()
            });
            this.sysID = "#" + this.containerBar + "_home";
            this.cssName = "HomeButton";
            this.bPannelBoard = this.bDashBoard = !1;
            this.addSystemButton("\u5f00\u59cb...", "HomeButton", "home");
            this.addSystemButton("\u5e94\u7528\u4e2d\u5fc3", "ApplyButton", "apply");
            this.addSystemButton("\u4e2a\u6027\u4e3b\u9898", "ThemeButton", "theme");
            this.loadSystemMenu();
            $("#" + this.containerBar + "_Status").find(".Sayma").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(".TaskStatus .UserMenu").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .ClockList").hide();
                a.data.handle.bPannelBoard && ($("#desktopFrame1").animate({
                    left: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width() - 420,
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width(),
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: -420,
                        display: "none"
                    });
                    $("pannelFrame").empty()
                }),
                a.data.handle.bPannelBoard = !1);
                a.data.handle.bDashBoard ? ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                $(".timeevent").empty()) : (a.data.handle.clear(1),
                $("#desktopFrame1_Panel_Home").hide(),
                $("#desktopFrame1").find(".desktopWrapper").addClass("blur"),
                $(".TaskStatus .Search").show(),
                $("#desktopFrame1_Panel_Widget").css({
                    opacity: 0,
                    top: $(window).height(),
                    overflow: "hidden",
                    display: "block"
                }),
                $("#desktopFrame1_Panel_Widget").animate({
                    top: 40,
                    opacity: 1,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                a.data.handle.bDashBoard = !0,
                a.data.handle.dispTimeLine(""));
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".Message").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(".TaskStatus .UserMenu").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .ClockList").hide();
                a.data.handle.bPannelBoard ? ($("#desktopFrame1").animate({
                    left: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width() - 420,
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width(),
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: -420,
                        display: "none"
                    });
                    $("pannelFrame").empty()
                }),
                a.data.handle.bPannelBoard = !1) : ($(this).find("img").attr("src", "/System/style/images/msg1.png"),
                $(this).find(".number").hide(),
                $("#pannelFrame").html('\x3ciframe allowtransparency\x3d"true" style\x3d"background-color:transparent;position:relative" marginwidth\x3d"0" marginheight\x3d"0" width\x3d"100%" height\x3d"100%" frameborder\x3d"no" scrolling\x3d"no" hidefocus\x3d"" src\x3d"/Webapp/Sayma/Mobile/top.html"\x3e\x3c/iframe\x3e'),
                $("#desktopFrame1").animate({
                    left: -420,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width(),
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width() - 420,
                    opacity: 1,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: 0,
                        display: "block"
                    })
                }),
                a.data.handle.bPannelBoard = !0);
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                $(".timeevent").empty());
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".Search i").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.dispTimeLine($(".TaskStatus .Search input").val())
            });
            $("#" + this.containerBar + "_Status").find(".Search input").keydown({
                handle: this
            }, function(a) {
                13 == a.keyCode && a.data.handle.dispTimeLine($(".TaskStatus .Search input").val())
            });
            $("#" + this.containerBar + "_Status").find(".Clock").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(".TaskStatus .UserMenu").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .ClockList").show();
                a.data.handle.bPannelBoard && ($("#desktopFrame1").animate({
                    left: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width() - 420,
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width(),
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: -420,
                        display: "none"
                    });
                    $("pannelFrame").empty()
                }),
                a.data.handle.bPannelBoard = !1);
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                $(".timeevent").empty());
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".Weather").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(".TaskStatus .UserMenu").hide();
                $(".TaskStatus .ClockList").hide();
                $(".TaskStatus .WeatherList").show();
                a.data.handle.bPannelBoard && ($("#desktopFrame1").animate({
                    left: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width() - 420,
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width(),
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: -420,
                        display: "none"
                    });
                    $("pannelFrame").empty()
                }),
                a.data.handle.bPannelBoard = !1);
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                $(".timeevent").empty());
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".Picture").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(".TaskStatus .ClockList").hide();
                $(".TaskStatus .WeatherList").hide();
                $(".TaskStatus .UserMenu").show();
                a.data.handle.bPannelBoard && ($("#desktopFrame1").animate({
                    left: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal"),
                $("#pannelFrame").css({
                    left: $(window).width() - 420,
                    right: "unset",
                    display: "block"
                }),
                $("#pannelFrame").animate({
                    left: $(window).width(),
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "normal", function() {
                    $("#pannelFrame").css({
                        left: "unset",
                        right: -420,
                        display: "none"
                    });
                    $("pannelFrame").empty()
                }),
                a.data.handle.bPannelBoard = !1);
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                $(".timeevent").empty());
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .doUserInfo").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "input",
                    value: TUI.env.us.userInfo
                },{
                    title: "\u4e2a\u6027\u7b7e\u540d",
                    width: 350,
                    height: 150,
                    handle: a.data.handle,
                    afterClose: function(a, c) {
                        1 == a && $.ajax({
                            type: "post",
                            url: "/System/srv/setUserInfo.ejs",
                            data: {
                                userID: TUI.env.us.userID,
                                userInfo: c
                            },
                            dataType: "json",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u4e2a\u6027\u7b7e\u540d")
                            },
                            success: function(a) {
                                a.flag ? TUI.env.us = a.data : (playSound("warn"),
                                toastr.warning(a.msg, "\u4e2a\u6027\u7b7e\u540d"))
                            }
                        })
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .doUserPic").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "image",
                    value: TUI.env.us.userName
                },{
                    title: "\u4e0a\u4f20\u5934\u50cf",
                    width: 350,
                    height: 150,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        1 == a && (a = new Date,
                        $(".TaskStatus .Picture img").prop("src", "/System/srv/userpic.ejs?userid\x3d" + TUI.env.us.userName + "\x26timespan\x3d" + a.getTime()))
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .doUserPass").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "password",
                    value: TUI.env.us.userID
                },{
                    title: "\u4fee\u6539\u5bc6\u7801",
                    width: 330,
                    height: 205,
                    handle: a.data.handle,
                    afterClose: function(a, c, b) {
                        1 == a && $.ajax({
                            type: "post",
                            url: "/System/srv/setUserPass.ejs",
                            data: {
                                userID: TUI.env.us.userID,
                                oldPass: TUI.Utils.hex_sha1(TUI.env.us.userName + "-" + c),
                                newPass: TUI.Utils.hex_sha1(TUI.env.us.userName + "-" + b)
                            },
                            dataType: "json",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u4fee\u6539\u5bc6\u7801")
                            },
                            success: function(a) {
                                a.flag ? (TUI.env.us = a.data,
                                top.location.href = "/") : (playSound("warn"),
                                toastr.error(a.msg, "\u4fee\u6539\u5bc6\u7801"))
                            }
                        })
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .doUserCenter").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                a.data.appcfg = {
                    update_url: "http://webstore.thingslabs.com/service/update/fax",
                    appid: "0CB4D644-896A-4ADA-9D5F-58448BD04498",
                    apptype: "Things",
                    name: "\u4e2a\u4eba\u4e2d\u5fc3",
                    description: "\u7ba1\u7406\u79c1\u4eba\u8d26\u6237\u53ca\u4fe1\u606f",
                    author: "ThingsLabs",
                    version: "1.0.1",
                    app: {
                        launch: {
                            enable: !0,
                            local_path: "/WebApp/Account/",
                            container: "system",
                            sort: 3,
                            height: 678,
                            width: 960
                        },
                        mobile: {
                            enable: !1,
                            local_path: "/WebApp/Account/Mobile/",
                            container: "system"
                        }
                    },
                    icons: {
                        logo: "icon_256.png"
                    },
                    isUserApp: !1,
                    urlPath: "/Webapp/Account"
                };
                if (TUI.env.os[TUI.env.desktop - 1].checkHandle(a.data.appcfg.appid))
                    TUI.env.os[TUI.env.desktop - 1].activeHandle(a.data.appcfg.appid);
                else {
                    var d = new Dialog({
                        container: a.data.handle.home.container,
                        type: "iframe",
                        value: a.data.appcfg.app.launch.local_path
                    },{
                        title: a.data.appcfg.name,
                        taskImg: a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo,
                        handle: TUI.env.os[TUI.env.desktop - 1],
                        appid: a.data.appcfg.appid,
                        urlPath: a.data.appcfg.urlPath,
                        afterShow: function() {},
                        afterHide: function() {
                            this.handle.hideHandle(a.data.appcfg.appid)
                        },
                        afterClose: function() {
                            this.handle.delHandle(a.data.appcfg.appid)
                        },
                        afterSwitch: function() {
                            this.handle.switchHandle(a.data.appcfg.appid)
                        },
                        modal: !1,
                        center: !0,
                        width: a.data.appcfg.app.launch.width,
                        height: a.data.appcfg.app.launch.height
                    });
                    d.show();
                    TUI.env.os[TUI.env.desktop - 1].addHandle(d, a.data.appcfg.name, a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo, a.data.appcfg.appid)
                }
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .fullScreen").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                a = document.documentElement;
                var d = a.requestFullScreen || a.webkitRequestFullScreen || a.mozRequestFullScreen || a.msRequestFullscreen;
                "undefined" != typeof d && d && d.call(a);
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .exitScreen").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                document.exitFullscreen ? document.exitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitCancelFullScreen ? document.webkitCancelFullScreen() : document.msExitFullscreen && document.msExitFullscreen();
                return !1
            });
            $("#" + this.containerBar + "_Status").find(".UserMenu .doUserLogout").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "warn",
                    value: "\u60a8\u786e\u5b9a\u8981\u6ce8\u9500ThingsOS\u684c\u9762\u5417\uff1f"
                },{
                    title: "\u6ce8\u9500\u684c\u9762",
                    width: 400,
                    height: 155,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        1 == a && $.ajax({
                            type: "get",
                            url: "/System/srv/logout.ejs",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u6ce8\u9500\u684c\u9762")
                            },
                            success: function(a) {
                                top.location.href = "/"
                            }
                        })
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            $("#" + this.containerBar + "_Button").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear(1)
            });
            $("#" + this.containerBar + "_ShowDesktop").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this.home
            }, this.fn);
            $("#desktopFrame1_Panel_Widget").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear(1)
            });
            $("#desktopFrame1_Panel_Home").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear()
            });
            TUI.env.us.firstPass && $("#" + this.containerBar + "_Status").find(".UserMenu .doUserPass").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)
        },
        dispTimeItem: function(b, a) {
            if ("calendar" == a.type) {
                var d = TUI.Utils.decode64(a.content)
                  , d = d.replace(/\n/g, "\x3cbr\x3e")
                  , d = d.replace(/\s/g, "\x26nbsp;")
                  , d = d.replace(RegExp('([""])', "g"), '\\"');
                if ("" == b || 0 <= a.appname.indexOf(b) || 0 <= a.title.indexOf(b) || 0 <= d.indexOf(b))
                    return "" == a.imagefile ? $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e' + a.title + '\x3c/h3\x3e\x3cp style\x3d"text-align: center;color: #9E9E9E!important;margin: 10px!important;"\x3e' + a.time + "\x3c/p\x3e" + d + "\x3c/div\x3e\x3c/li\x3e") : $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e' + a.title + '\x3c/h3\x3e\x3cp style\x3d"text-align: center;color: #9E9E9E!important;margin: 10px!important;"\x3e' + a.time + "\x3c/p\x3e" + d + '\x3cbr\x3e\x3cimg src\x3d"' + a.imagefile + '" width\x3d"100%" border\x3d"0" alt\x3d""/\x3e\x3c/div\x3e\x3c/li\x3e')
            } else if ("bulletin" == a.type) {
                if ("" == b || 0 <= a.appname.indexOf(b) || 0 <= a.title.indexOf(b) || 0 <= a.content.indexOf(b) || 0 <= a.deptname.indexOf(b) || 0 <= a.contact.indexOf(b))
                    return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e' + a.title + "\x3c/h3\x3e\x3cp\x3e" + a.content + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u516c\u544a\u65f6\u95f4\uff1a\x3c/b\x3e" + a.time + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u516c\u544a\u90e8\u95e8\uff1a\x3c/b\x3e" + a.deptname + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u8054\u7cfb\u65b9\u5f0f\uff1a\x3c/b\x3e" + a.contact + a.mobile + "\x3c/p\x3e\x3c/div\x3e\x3c/li\x3e")
            } else if ("note" == a.type) {
                if ("" == b || 0 <= a.appname.indexOf(b) || 0 <= a.title.indexOf(b) || 0 <= a.content.indexOf(b))
                    return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e' + a.title + "\x3c/h3\x3e" + a.time + "\x3cbr\x3e" + a.content + "\x3c/div\x3e\x3c/li\x3e")
            } else if ("message" == a.type) {
                if ("" == b || 0 <= a.appname.indexOf(b) || 0 <= a.title.indexOf(b) || 0 <= a.content.indexOf(b))
                    return 0 <= a.content.indexOf("\x3ctable\x3e") || 0 <= a.content.indexOf("\x3cbr\x3e") ? $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e' + a.title + "\x3c/h3\x3e\x3cp\x3e" + a.time + "\x3c/p\x3e" + a.content + "\x3c/div\x3e\x3c/li\x3e") : $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e' + a.title + "\x3c/h3\x3e\x3cp\x3e" + a.time + "\x3c/p\x3e" + a.content + "\x3c/div\x3e\x3c/li\x3e")
            } else if ("knowledge" == a.type) {
                for (var c = "", d = 0; d < a.imagefile.length; d++)
                    c += '\x3cimg src\x3d"' + a.imagefile[d] + '" width\x3d"100%" border\x3d"0" alt\x3d""/\x3e';
                var e = unescape(unescape(a.subject))
                  , d = unescape(unescape(a.content));
                if ("" == b || 0 <= a.name.indexOf(b) || 0 <= e.indexOf(b) || 0 <= d.indexOf(b))
                    return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.name + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e' + e + "\x3c/h3\x3e" + d + c + "\x3c/div\x3e\x3c/li\x3e")
            } else if ("inspect" == a.type) {
                if (c = "",
                2 <= a.RecordStatus && (c = '\x3cspan class\x3d"btn"\x3e\u53d1\u8d77\u5de5\u5355\x3c/span\x3e'),
                d = "\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.RecordTime + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.RecordWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5bf9\u8c61\uff1a\x3c/b\x3e" + a.ObjectName + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u72b6\u6001\uff1a\x3c/b\x3e" + [{
                    name: "\u6b63\u5e38\u72b6\u6001",
                    color: "#1BBFAF",
                    y: 0
                }, {
                    name: "\u901a\u77e5\u72b6\u6001",
                    color: "#1099EC",
                    y: 0
                }, {
                    name: "\u544a\u8b66\u72b6\u6001",
                    color: "#DDBD45",
                    y: 0
                }, {
                    name: "\u6545\u969c\u72b6\u6001",
                    color: "#D84C49",
                    y: 0
                }, {
                    name: "\u762b\u75ea\u72b6\u6001",
                    color: "#a52623",
                    y: 0
                }][a.RecordStatus].name + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5185\u5bb9\uff1a\x3c/b\x3e" + unescape(a.RecordInfo) + "\x3c/p\x3e",
                "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.RecordName.indexOf(b))
                    return "" != a.VideoFile ? (e = a.VideoFile.substr(0, a.VideoFile.indexOf(".")),
                    c = $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + c + '\x3c/lable\x3e\x3cdiv class\x3d"htmlpanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.RecordName + "\u7684\u5de1\u68c0\x3c/h3\x3e" + (d + ('\x3cvideo width\x3d"100%" controls preload\x3d"none" poster\x3d"' + e + '.jpg" style\x3d"margin-top: 8px;"\x3e\t\t\t\t\x3csource src\x3d"' + e + '.mp4" type\x3d"video/mp4"\x3e\t\t\t\x3c/video\x3e')) + "\x3c/div\x3e\x3c/li\x3e")) : c = $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + c + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.RecordName + "\u7684\u5de1\u68c0\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e"),
                    c.find(".btn").bind(TUI.env.ua.clickEventUp, {
                        handle: c,
                        config: a
                    }, function(a) {
                        $.ajax({
                            type: "PUT",
                            url: "/API/WorkSheet",
                            data: {
                                apptag: a.data.config.AppTag,
                                typename: "\u5de1\u68c0" + RecordStatusText[a.data.config.RecordStatus],
                                where: a.data.config.RecordWhere,
                                what: "\u60a8\u6709\u4e00\u4e2a\u6765\u81ea" + TUI.env.us.fullName + "\u7684\u5de1\u68c0\u95ee\u9898\u9700\u8981\u5904\u7406\uff01",
                                why: a.data.config.RecordInfo,
                                autoFlow: !0,
                                fromType: "Inspect",
                                fromid: 0,
                                objectid: a.data.config.ObjectID,
                                fulltag: a.data.config.ObjectFullTag,
                                objecttype: a.data.config.ObjectType
                            },
                            dataType: "json",
                            context: this,
                            error: function(a) {
                                toastr.error("\u7f51\u7edc\u4e0d\u7ed9\u529b", "\u53d1\u8d77\u5de5\u5355")
                            },
                            success: function(a) {
                                a.flag ? ($(this).find(".btn").remove(),
                                toastr.success("\u53d1\u8d77\u5de5\u5355\u6210\u529f\uff01", "\u53d1\u8d77\u5de5\u5355")) : (playSound("warn"),
                                toastr.warning(a.info, "\u53d1\u8d77\u5de5\u5355"))
                            }
                        })
                    }),
                    c
            } else if ("event" == a.type) {
                if (c = "",
                d = "\x3cp\x3e\x3cb\x3e\u5904\u7f6e\uff1a\x3c/b\x3e" + a.OperateInfo + "\u3010" + a.OperateName + "\u3011\x3c/p\x3e",
                "" == a.OperateName && (d = ""),
                0 == a.OperateStatus && (c = '\x3cspan class\x3d"btn"\x3e\u53d1\u8d77\u5de5\u5355\x3c/span\x3e'),
                d = "\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.EventTime + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.EventWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u7c7b\u578b\uff1a\x3c/b\x3e" + a.EventType + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5185\u5bb9\uff1a\x3c/b\x3e" + a.EventInfo + "\x3c/p\x3e" + d,
                "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.EventFrom.indexOf(b))
                    return c = $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + c + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.EventFrom + "\u7684\u4e8b\u4ef6\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e"),
                    c.find(".btn").bind(TUI.env.ua.clickEventUp, {
                        handle: c,
                        config: a
                    }, function(a) {
                        $.ajax({
                            type: "PUT",
                            url: "/API/WorkSheet",
                            data: {
                                apptag: a.data.config.AppTag,
                                typename: a.data.config.EventType,
                                where: a.data.config.EventWhere,
                                what: "\u60a8\u6709\u4e00\u4e2a\u6765\u81ea" + TUI.env.us.fullName + "\u7684\u7d27\u6025\u4e8b\u4ef6\u9700\u8981\u5904\u7406\uff01",
                                why: a.data.config.EventInfo,
                                autoFlow: !0,
                                fromType: "Event",
                                fromid: a.data.config.EventID,
                                objectid: a.data.config.ObjectID,
                                fulltag: a.data.config.ObjectFullTag,
                                objecttype: a.data.config.ObjectType
                            },
                            dataType: "json",
                            context: a.data.handle,
                            error: function(a) {
                                toastr.error("\u7f51\u7edc\u4e0d\u7ed9\u529b\uff01", "\u53d1\u8d77\u5de5\u5355")
                            },
                            success: function(a) {
                                a.flag ? ($(this).find(".btn").remove(),
                                toastr.success("\u53d1\u8d77\u5de5\u5355\u6210\u529f\uff01", "\u53d1\u8d77\u5de5\u5355")) : (playSound("warn"),
                                toastr.warning(a.info, "\u53d1\u8d77\u5de5\u5355"))
                            }
                        })
                    }),
                    c
            } else if ("transition" == a.type) {
                if (c = "",
                d = "\x3cp\x3e\x3cb\x3e\u5904\u7f6e\uff1a\x3c/b\x3e" + a.OperateInfo + "\u3010" + a.OperateName + "\u3011\x3c/p\x3e",
                "" == a.OperateName && (d = ""),
                0 == a.OperateStatus && (c = '\x3cspan class\x3d"btn"\x3e\u53d1\u8d77\u5de5\u5355\x3c/span\x3e'),
                d = "\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.TransTime + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.TransWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u7c7b\u578b\uff1a\x3c/b\x3e" + a.TransType + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5185\u5bb9\uff1a\x3c/b\x3e" + a.TransInfo + "\x3c/p\x3e" + d,
                "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.TransName.indexOf(b))
                    return c = $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + c + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e' + a.TransName + "\u7684\u5f02\u52a8\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e"),
                    c.find(".btn").bind(TUI.env.ua.clickEventUp, {
                        handle: c,
                        config: a
                    }, function(a) {
                        $.ajax({
                            type: "PUT",
                            url: "/API/WorkSheet",
                            data: {
                                apptag: a.data.config.AppTag,
                                typename: a.data.config.TransType,
                                where: a.data.config.TransWhere,
                                what: "\u60a8\u6709\u4e00\u4e2a\u6765\u81ea" + TUI.env.us.fullName + "\u7684\u5f02\u52a8\u65e5\u5fd7\u9700\u8981\u5904\u7406\uff01",
                                why: a.data.config.TransInfo,
                                autoFlow: !0,
                                fromType: "Transition",
                                fromid: a.data.config.TransitionID,
                                objectid: a.data.config.ObjectID,
                                fulltag: a.data.config.ObjectFullTag,
                                objecttype: a.data.config.ObjectType
                            },
                            dataType: "json",
                            context: a.data.handle,
                            error: function(a) {
                                toastr.error("\u7f51\u7edc\u4e0d\u7ed9\u529b\uff01", "\u53d1\u8d77\u5de5\u5355")
                            },
                            success: function(a) {
                                a.flag ? ($(this).find(".btn").remove(),
                                toastr.success("\u53d1\u8d77\u5de5\u5355\u6210\u529f\uff01", "\u53d1\u8d77\u5de5\u5355")) : (playSound("warn"),
                                toastr.warning(a.info, "\u53d1\u8d77\u5de5\u5355"))
                            }
                        })
                    }),
                    c
            } else if ("control" == a.type) {
                if (d = "\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.ActionTime + "~" + a.ActionStatusTime + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.ActionWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u7c7b\u578b\uff1a\x3c/b\x3e" + a.RuleName + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u72b6\u6001\uff1a\x3c/b\x3e" + " \u7b49\u5f85\u4e2d \u8fd0\u884c\u4e2d \u6682\u505c \u5931\u8d25 \u6210\u529f".split(" ")[a.ActionStatus] + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u64cd\u4f5c\uff1a\x3c/b\x3e" + a.ActionStatusWhat + "\x3c/p\x3e",
                "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.OperateName.indexOf(b))
                    return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.OperateName + "\u7684\u63a7\u5236\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e")
            } else if ("alarm" == a.type) {
                if (d = "\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.AlarmTime + "~" + a.AlarmStatusTime + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.AlarmWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u7c7b\u578b\uff1a\x3c/b\x3e" + a.RuleName + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u72b6\u6001\uff1a\x3c/b\x3e" + " \u4e00\u822c\u4fe1\u606f \u544a\u8b66 \u7d27\u6025 \u5371\u9669 \u6b63\u5e38".split(" ")[a.AlarmStatus] + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u64cd\u4f5c\uff1a\x3c/b\x3e" + a.AlarmStatusWhat + "\x3c/p\x3e",
                "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.OperateName.indexOf(b))
                    return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.OperateName + "\u7684\u62a5\u8b66\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e")
            } else if ("worksheet" == a.type && (d = "\x3cp\x3e\x3cb\x3e\u5355\u53f7\uff1a\x3c/b\x3e" + a.WorkRecordID + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u65f6\u95f4\uff1a\x3c/b\x3e" + a.WorkWhen + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u4f4d\u7f6e\uff1a\x3c/b\x3e" + a.WorkWhere + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u539f\u56e0\uff1a\x3c/b\x3e" + a.WorkWhy + "\u3010" + a.WorkTypeName + "\u3011\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5185\u5bb9\uff1a\x3c/b\x3e" + a.WorkWhat + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u72b6\u6001\uff1a\x3c/b\x3e" + a.HowStatusName + "\x3c/p\x3e\x3cp\x3e\x3cb\x3e\u5904\u7f6e\uff1a\x3c/b\x3e" + a.HowResult + "\u3010" + a.HowPeopleName + "\u3011\x3c/p\x3e",
            "" == b || 0 <= a.appname.indexOf(b) || 0 <= d.indexOf(b) || 0 <= a.WorkWhoName.indexOf(b)))
                return $('\x3cli\x3e\x3clable\x3e\x3cimg src\x3d"' + a.appicon + '" width\x3d"24px" border\x3d"0" alt\x3d"" style\x3d"margin: 0px 5px 2px 0;vertical-align: middle;"/\x3e' + a.appname + '\x3c/lable\x3e\x3cdiv class\x3d"infopanel"\x3e\x3ch3\x3e\u6765\u81ea' + a.WorkWhoName + "\u7684\u5de5\u5355\x3c/h3\x3e" + d + "\x3c/div\x3e\x3c/li\x3e");
            return null
        },
        loadReadMsg: function() {
            $.ajax({
                type: "get",
                url: "/System/srv/readMsg.ejs?startTime\x3d" + (new Date).Format("yyyy-MM-dd"),
                dataType: "json",
                context: this,
                error: function(b) {},
                success: function(b) {
                    for (var a = 0; a < b.app.length; a++)
                        TUI.env.os[0].desktopDock.setMsgCount(b.app[a].appid, b.app[a].msgList),
                        TUI.env.os[0].desktopShortcut.setMsgCount(b.app[a].appid, b.app[a].msgList);
                    0 == b.msg.length ? ($("#" + this.containerBar + "_Status").find(".Message img").attr("src", "/System/style/images/msg1.png"),
                    $("#" + this.containerBar + "_Status").find(".Message .number").hide()) : ($("#" + this.containerBar + "_Status").find(".Message img").attr("src", "/System/style/images/msg2.png"),
                    $("#" + this.containerBar + "_Status").find(".Message .number").show(),
                    $("#" + this.containerBar + "_Status").find(".Message .number").html(b.msg.length))
                }
            })
        },
        loadTimeLine: function() {
            var b = new Date;
            b.setHours(0, 0, 0, 0);
            var a = b.DateAdd("d", -60)
              , b = b.DateAdd("d", 1);
            $.ajax({
                type: "get",
                url: "/System/srv/readTimeline.ejs?startTime\x3d" + a.Format("yyyy-MM-dd"),
                dataType: "json",
                context: this,
                error: function(a) {},
                success: function(a) {
                    k = a.data;
                    f = a.date
                }
            })
        },
        dispHourLine: function(b) {
            n = {};
            g = [];
            p = {};
            q = 0;
            b.sort(function(a, c) {
                return TUI.Utils.parseDate(a.time) < TUI.Utils.parseDate(c.time) ? 1 : -1
            });
            for (var a = 0; a < b.length; a++) {
                var d = TUI.Utils.parseDate(b[a].time);
                void 0 == n[d.Format("hh:00")] && (n[d.Format("hh:00")] = [],
                g.push(d.Format("hh:00")));
                n[d.Format("hh:00")].push(b[a])
            }
            $(".timeevent").empty();
            $(".timeevent").html('\x3cbr\x3e\x3ch2 id\x3d"hTimeDay"\x3e' + TUI.Utils.parseDate(b[0].time).Format("M\u6708d\u65e5") + '\x26nbsp;\x3cspan class\x3d"timelineMore"\x3e\u4ec5\u67e5\u770b\u4e3b\u8981\u6d3b\u52a8\x3c/span\x3e\x3c/h2\x3e');
            $(".timeevent").css({
                top: "0px"
            });
            $(".timeline .linebar1").css({
                height: "0px"
            });
            $(".timeline .currbar").css({
                top: "30px"
            });
            $(".timeline .linebar2").css({
                top: "50px"
            });
            $(".timeline .currbar .currdate").html("");
            $("#hTimeDay").find(".timelineMore").bind(TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.dispTimeLine("");
                return !1
            });
            for (a = 0; a < g.length; a++)
                if (0 < n[g[a]].length) {
                    b = 0;
                    d = $('\x3ch2 id\x3d"hTimeLine' + a + '"\x3e' + g[a] + '\x3c/h2\x3e\x3cul id\x3d"mTimeLine' + a + '"\x3e\x3c/ul\x3e');
                    $(".homepanel .timeevent").append(d);
                    n[g[a]].sort(function(a, c) {
                        return TUI.Utils.parseDate(a.time) > TUI.Utils.parseDate(c.time) ? 1 : -1
                    });
                    n[g[a]].sort(function(a, c) {
                        return a.ishtml < c.ishtml ? 1 : -1
                    });
                    for (var c = 0; c < n[g[a]].length; c++) {
                        var e = this.dispTimeItem("", n[g[a]][c]);
                        null != e && ($("#mTimeLine" + a).append(e),
                        b++)
                    }
                    0 < b ? (p[g[a]] = q,
                    q += b) : d.remove()
                }
            0 < g.length && ($(".linebar1 .startdate").html(g[0]),
            $(".linebar2 .enddate").html(g[g.length - 1]));
            $(".timeline").bind(TUI.env.ua.clickEventDown, function(a) {
                r = 1
            });
            $(".timeline").bind(TUI.env.ua.clickEventUp, function(a) {
                r = 0
            });
            $(".timeline").bind(TUI.env.ua.clickEventMove, function(a) {
                if (1 == r) {
                    a = a.clientY - 50;
                    30 > a && (a = 30);
                    a > $(window).height() - 88 && (a = $(window).height() - 88);
                    $(".timeline .linebar1").css({
                        height: a - 30 + "px"
                    });
                    $(".timeline .currbar").css({
                        top: a + "px"
                    });
                    $(".timeline .linebar2").css({
                        top: a + 20 + "px"
                    });
                    var c = Math.floor((a - 30) * g.length / ($(window).height() - 120))
                      , d = $(window).height() - $(".timeevent").height() - 100;
                    if (c < g.length) {
                        var b = p[g[c]]
                          , b = ((c + 1 == g.length ? b : p[g[c + 1]]) - b) * d / q * (a - 30 - c * ($(window).height() - 120) / g.length) / ((c + 1) * ($(window).height() - 120) / g.length - c * ($(window).height() - 120) / g.length) + b * d / q;
                        0 < b || 0 >= a - 30 ? b = 0 : b < d && (b = d);
                        $(".timeevent").css({
                            top: b + "px"
                        })
                    } else
                        $(".timeevent").css({
                            top: d + "px"
                        });
                    0 >= c || c >= g.length - 1 ? $(".timeline .currbar .currdate").html("") : void 0 != p[g[c]] ? $(".timeline .currbar .currdate").html(g[c]) : $(".timeline .currbar .currdate").html("")
                }
            });
            $("#desktopFrame1_Panel_Widget").bind("mousewheel", {
                handle: this
            }, function(a, c) {
                var d = parseInt($(".timeline .currbar").css("top")) - 3 * c;
                30 > d && (d = 30);
                d >= $(window).height() - 88 && (d = $(window).height() - 88);
                $(".timeline .linebar1").css({
                    height: d - 30 + "px"
                });
                $(".timeline .currbar").css({
                    top: d + "px"
                });
                $(".timeline .linebar2").css({
                    top: d + 20 + "px"
                });
                var b = Math.floor((d - 30) * g.length / ($(window).height() - 120))
                  , e = $(window).height() - $(".timeevent").height() - 100;
                if (b < g.length) {
                    var h = p[g[b]]
                      , h = ((b + 1 == g.length ? h : p[g[b + 1]]) - h) * e / q * (d - 30 - b * ($(window).height() - 120) / g.length) / ((b + 1) * ($(window).height() - 120) / g.length - b * ($(window).height() - 120) / g.length) + h * e / q;
                    0 < h || 0 >= d - 30 ? h = 0 : h < e && (h = e);
                    $(".timeevent").css({
                        top: h + "px"
                    })
                } else
                    $(".timeevent").css({
                        top: e + "px"
                    });
                0 >= b || b >= g.length - 1 ? $(".timeline .currbar .currdate").html("") : void 0 != p[g[b]] ? $(".timeline .currbar .currdate").html(g[b]) : $(".timeline .currbar .currdate").html("");
                return !1
            })
        },
        dispTimeLine: function(b) {
            var a = 0
              , d = 0
              , c = new Date;
            c.setMinutes(0, 0);
            c = c.DateAdd("h", -2);
            m = {};
            l = 0;
            $(".timeevent").empty();
            $(".timeevent").html('\x3cbr\x3e\x3ch2  id\x3d"CurrentHead" class\x3d"mCurrent"\x3e\u5f53\u524d\x3c/h2\x3e\x3cul id\x3d"Current" class\x3d"mCurrent"\x3e\x3c/ul\x3e\x3ch2 id\x3d"TodayHead"  class\x3d"mToday"\x3e\u4eca\u65e5\u65e9\u4e9b\u65f6\u5019\x3c/h2\x3e\x3cul id\x3d"Today" class\x3d"mToday"\x3e\x3c/ul\x3e\x3ch2 id\x3d"YesterdayHead" class\x3d"mYesterday"\x3e\u6628\u5929\x3c/h2\x3e\x3cul id\x3d"Yesterday" class\x3d"mYesterday"\x3e\x3c/ul\x3e');
            $(".timeevent").css({
                top: "0px"
            });
            $(".timeline .linebar1").css({
                height: "0px"
            });
            $(".timeline .currbar").css({
                top: "30px"
            });
            $(".timeline .linebar2").css({
                top: "50px"
            });
            $(".timeline .currbar .currdate").html("");
            if (0 < f.length) {
                k[f[0]].sort(function(a, c) {
                    return TUI.Utils.parseDate(a.time) > TUI.Utils.parseDate(c.time) ? 1 : -1
                });
                k[f[0]].sort(function(a, c) {
                    return a.ishtml < c.ishtml ? 1 : -1
                });
                for (var e = 0; e < k[f[0]].length; e++)
                    if (TUI.Utils.parseDate(k[f[0]][e].time) >= c) {
                        var h = this.dispTimeItem(b, k[f[0]][e]);
                        null != h && (6 > a && $("#Current").append(h),
                        a++)
                    } else
                        h = this.dispTimeItem(b, k[f[0]][e]),
                        null != h && (6 > d && $("#Today").append(h),
                        d++);
                0 == a ? $(".mCurrent").remove() : 6 < a && ($("#CurrentHead").html('\u5f53\u524d\x26nbsp;\x3cspan class\x3d"timelineMore"\x3e\u67e5\u770b\u5168\u90e8' + a + "\u4e2a\u6d3b\u52a8\x3c/span\x3e"),
                $("#CurrentHead").find(".timelineMore").bind(TUI.env.ua.clickEventUp, {
                    handle: this,
                    msg: k[f[0]]
                }, function(a) {
                    a.data.handle.dispHourLine(a.data.msg);
                    return !1
                }));
                0 == d ? $(".mToday").remove() : 6 < d && ($("#TodayHead").html('\u4eca\u65e5\u65e9\u4e9b\u65f6\u5019\x26nbsp;\x3cspan class\x3d"timelineMore"\x3e\u67e5\u770b\u5168\u90e8' + d + "\u4e2a\u6d3b\u52a8\x3c/span\x3e"),
                $("#TodayHead").find(".timelineMore").bind(TUI.env.ua.clickEventUp, {
                    handle: this,
                    msg: k[f[0]]
                }, function(a) {
                    a.data.handle.dispHourLine(a.data.msg);
                    return !1
                }));
                if (0 < a || 0 < d)
                    m[f[0]] = l,
                    l += (6 < a ? 6 : a) + (6 < d ? 6 : d)
            }
            for (d = 1; d < f.length; d++)
                if (1 == d) {
                    c = 0;
                    k[f[d]].sort(function(a, c) {
                        return TUI.Utils.parseDate(a.time) > TUI.Utils.parseDate(c.time) ? 1 : -1
                    });
                    k[f[d]].sort(function(a, c) {
                        return a.ishtml < c.ishtml ? 1 : -1
                    });
                    for (e = 0; e < k[f[d]].length; e++)
                        if (h = this.dispTimeItem(b, k[f[d]][e]),
                        null != h)
                            if (6 > c)
                                $("#Yesterday").append(h),
                                c++;
                            else
                                break;
                    0 == c ? $(".mYesterday").remove() : 6 <= c && ($("#YesterdayHead").html('\u6628\u5929\x26nbsp;\x3cspan class\x3d"timelineMore"\x3e\u67e5\u770b\u5168\u90e8' + k[f[d]].length + "\u4e2a\u6d3b\u52a8\x3c/span\x3e"),
                    $("#YesterdayHead").find(".timelineMore").bind(TUI.env.ua.clickEventUp, {
                        handle: this,
                        msg: k[f[d]]
                    }, function(a) {
                        a.data.handle.dispHourLine(a.data.msg);
                        return !1
                    }));
                    0 < c && (m[f[d]] = l,
                    l += c)
                } else if (0 < k[f[d]].length) {
                    var c = 0
                      , g = $('\x3ch2 id\x3d"hTimeLine' + d + '"\x3e' + TUI.Utils.parseDate(f[d]).Format("M\u6708d\u65e5") + '\x3c/h2\x3e\x3cul id\x3d"mTimeLine' + d + '"\x3e\x3c/ul\x3e');
                    $(".homepanel .timeevent").append(g);
                    k[f[d]].sort(function(a, c) {
                        return TUI.Utils.parseDate(a.time) > TUI.Utils.parseDate(c.time) ? 1 : -1
                    });
                    k[f[d]].sort(function(a, c) {
                        return a.ishtml < c.ishtml ? 1 : -1
                    });
                    for (e = 0; e < k[f[d]].length; e++)
                        if (h = this.dispTimeItem(b, k[f[d]][e]),
                        null != h)
                            if (6 > c)
                                $("#mTimeLine" + d).append(h),
                                c++;
                            else
                                break;
                    0 == c ? g.remove() : 6 <= c && ($("#hTimeLine" + d).html(TUI.Utils.parseDate(f[d]).Format("M\u6708d\u65e5") + '\x26nbsp;\x3cspan class\x3d"timelineMore"\x3e\u67e5\u770b\u5168\u90e8' + k[f[d]].length + "\u4e2a\u6d3b\u52a8\x3c/span\x3e"),
                    $("#hTimeLine" + d).find(".timelineMore").bind(TUI.env.ua.clickEventUp, {
                        handle: this,
                        msg: k[f[d]]
                    }, function(a) {
                        a.data.handle.dispHourLine(a.data.msg);
                        return !1
                    }));
                    0 < c && (m[f[d]] = l,
                    l += c)
                }
            0 < f.length && (0 < a ? $(".linebar1 .startdate").html("\u5f53\u524d") : $(".linebar1 .startdate").html(TUI.Utils.parseDate(f[0]).Format("M\u6708d\u65e5")),
            $(".linebar2 .enddate").html(TUI.Utils.parseDate(f[f.length - 1]).Format("M\u6708d\u65e5")));
            $(".timeline").bind(TUI.env.ua.clickEventDown, function(a) {
                r = 1
            });
            $(".timeline").bind(TUI.env.ua.clickEventUp, function(a) {
                r = 0
            });
            $(".timeline").bind(TUI.env.ua.clickEventMove, function(a) {
                if (1 == r) {
                    a = a.clientY - 50;
                    30 > a && (a = 30);
                    a > $(window).height() - 88 && (a = $(window).height() - 88);
                    $(".timeline .linebar1").css({
                        height: a - 30 + "px"
                    });
                    $(".timeline .currbar").css({
                        top: a + "px"
                    });
                    $(".timeline .linebar2").css({
                        top: a + 20 + "px"
                    });
                    var c = Math.floor((a - 30) * f.length / ($(window).height() - 120))
                      , d = $(window).height() - $(".timeevent").height() - 100;
                    if (c < f.length) {
                        var b = m[TUI.Utils.parseDate(f[c]).Format("yyyy-MM-dd")]
                          , b = ((c + 1 == f.length ? b : m[TUI.Utils.parseDate(f[c + 1]).Format("yyyy-MM-dd")]) - b) * d / l * (a - 30 - c * ($(window).height() - 120) / f.length) / ((c + 1) * ($(window).height() - 120) / f.length - c * ($(window).height() - 120) / f.length) + b * d / l;
                        0 < b || 0 >= a - 30 ? b = 0 : b < d && (b = d);
                        $(".timeevent").css({
                            top: b + "px"
                        })
                    } else
                        $(".timeevent").css({
                            top: d + "px"
                        });
                    0 >= c || c >= f.length - 1 ? $(".timeline .currbar .currdate").html("") : void 0 != m[TUI.Utils.parseDate(f[c]).Format("yyyy-MM-dd")] ? $(".timeline .currbar .currdate").html(TUI.Utils.parseDate(f[c]).Format("M\u6708d\u65e5")) : $(".timeline .currbar .currdate").html("")
                }
            });
            $("#desktopFrame1_Panel_Widget").bind("mousewheel", {
                handle: this
            }, function(a, c) {
                var d = parseInt($(".timeline .currbar").css("top")) - 3 * c;
                30 > d && (d = 30);
                d >= $(window).height() - 88 && (d = $(window).height() - 88);
                $(".timeline .linebar1").css({
                    height: d - 30 + "px"
                });
                $(".timeline .currbar").css({
                    top: d + "px"
                });
                $(".timeline .linebar2").css({
                    top: d + 20 + "px"
                });
                var b = Math.floor((d - 30) * f.length / ($(window).height() - 120))
                  , e = $(window).height() - $(".timeevent").height() - 100;
                if (b < f.length) {
                    var h = m[TUI.Utils.parseDate(f[b]).Format("yyyy-MM-dd")]
                      , h = ((b + 1 == f.length ? h : m[TUI.Utils.parseDate(f[b + 1]).Format("yyyy-MM-dd")]) - h) * e / l * (d - 30 - b * ($(window).height() - 120) / f.length) / ((b + 1) * ($(window).height() - 120) / f.length - b * ($(window).height() - 120) / f.length) + h * e / l;
                    0 < h || 0 >= d - 30 ? h = 0 : h < e && (h = e);
                    $(".timeevent").css({
                        top: h + "px"
                    })
                } else
                    $(".timeevent").css({
                        top: e + "px"
                    });
                0 >= b || b >= f.length - 1 ? $(".timeline .currbar .currdate").html("") : void 0 != m[TUI.Utils.parseDate(f[b]).Format("yyyy-MM-dd")] ? $(".timeline .currbar .currdate").html(TUI.Utils.parseDate(f[b]).Format("M\u6708d\u65e5")) : $(".timeline .currbar .currdate").html("");
                return !1
            })
        },
        dispWeather: function() {
            $.ajax({
                type: "get",
                url: TUI.Utils.isIntranet(TUI.env.us.loginIPAddr) ? "/API/Weather" : "/API/Weather?areacode\x3d" + TUI.env.us.loginIPAddr,
                dataType: "json",
                context: this,
                error: function(b) {
                    this.msgWeather = 0
                },
                success: function(b) {
                    if (b.flag) {
                        $("#" + this.containerBar + "_Status").find(".Weather .icon").html('\x3cimg src\x3d"/@Start/Weather/' + b.data.now.code + '.png"/\x3e');
                        $("#" + this.containerBar + "_Status").find(".Weather .info").html(b.data.now.feels_like + "\u2103");
                        $("#" + this.containerBar + "_Status").find(".WeatherList .today ul").empty();
                        $("#" + this.containerBar + "_Status").find(".WeatherList .today ul").append('\x3cli class\x3d"weather-icon"\x3e\x3ci class\x3d"icon-weather-' + b.data.now.code + '"\x3e\x3c/i\x3e\x3c/li\x3e\t\x3cli style\x3d"line-height:34px;position: relative;top: 10px;color: #FF9800;"\x3e\t\t\x3cdiv class\x3d"feels-like"\x3e' + b.data.now.feels_like + '\u2103\x3c/div\x3e\t\t\x3cdiv class\x3d"weather-text"\x3e' + b.data.now.text + '\x3c/div\x3e\t\x3c/li\x3e\t\x3cli style\x3d"line-height:34px;position: relative;top: 10px;"\x3e\t\t\x3cdiv class\x3d"city-name"\x3e' + b.data.city_name + '\x3c/div\x3e\t\t\x3cdiv class\x3d"visibility"\x3e' + b.data.now.wind_direction + '\x3c/div\x3e\t\x3c/li\x3e\t\x3cli style\x3d"line-height:20px;position: relative;top: 10px;"\x3e\t\t\x3cdiv class\x3d"aqi"\x3eA\x26nbsp;Q\x26nbsp;I\x26nbsp;\x26nbsp;' + b.data.now.air_quality.city.aqi + '\x3c/div\x3e\t\t\x3cdiv class\x3d"pm25"\x3ePM2.5\x26nbsp;' + b.data.now.air_quality.city.pm25 + '\x3c/div\x3e\t\t\x3cdiv class\x3d"quality"\x3e' + b.data.now.air_quality.city.quality + "\x3c/div\x3e\t\x3c/li\x3e");
                        $("#" + this.containerBar + "_Status").find(".WeatherList .future ul").empty();
                        for (var a = 1; 4 > a; a++)
                            $("#" + this.containerBar + "_Status").find(".WeatherList .future ul").append("\x3cli\x3e\x3cspan\x3e" + b.data.future[a].day + '\x3c/sapn\x3e\x3cbr\x3e\x3ci class\x3d"icon-weather-' + (0 == a ? b.data.future[a].code2 : b.data.future[a].code1) + '"\x3e\x3c/i\x3e\x3cbr\x3e\x3cspan\x3e' + b.data.future[a].low + "~" + b.data.future[a].high + "\u2103\x3c/sapn\x3e\x3cbr\x3e\x3cspan\x3e" + b.data.future[a].text + " / " + b.data.future[a].quality + "\x3c/sapn\x3e\x3cbr\x3e\x3cspan\x3e" + b.data.future[a].wind2 + "\x3c/sapn\x3e\x3c/li\x3e")
                    } else
                        this.msgWeather = 0,
                        $("#" + this.containerBar + "_Status").find(".Weather").remove(),
                        $("#" + this.containerBar + "_Status").find(".Message").css({
                            right: "172px"
                        }),
                        $("#" + this.containerBar + "_Status").find(".Search").css({
                            right: "215px"
                        })
                }
            })
        },
        dispDateTime: function() {
            $.ajax({
                type: "get",
                url: "/System/srv/login.ejs",
                dataType: "json",
                context: this,
                error: function(a) {
                    $("#" + this.containerBar + "_Status").find(".Clock").html('\x3cfont color\x3d"#ffff00"\x3e\u7f51\u7edc\u8131\u673a\x3cbr\x3e\u6b63\u5728\u91cd\u65b0\u8fde\u63a5...\x3c/font\x3e')
                },
                success: function(a) {
                    if (a.loginStatus) {
                        a = new Date;
                        var c = a.getHours();
                        a.getMinutes();
                        $("#" + this.containerBar + "_Status").find(".Clock").html((12 <= c ? "\u4e0b\u5348" : "\u4e0a\u5348") + (12 < c ? c - 12 : c) + ":" + TUI.Utils.formatNumber(a.getMinutes(), "00") + "\x3cbr\x3e" + (a.getMonth() + 1) + "\u6708" + a.getDate() + "\u65e5\x26nbsp;" + "\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d".split(" ")[a.getDay()])
                    } else
                        top.location.href = "/"
                }
            });
            var b = new Date
              , a = calendar.solar2lunar();
            $(".ClockList .today").html("\x3cdiv\x3e" + b.Format("yyyy-MM-dd") + "\x26nbsp;" + "\u5468\u65e5 \u5468\u4e00 \u5468\u4e8c \u5468\u4e09 \u5468\u56db \u5468\u4e94 \u5468\u516d".split(" ")[b.getDay()] + '\x3c/div\x3e\x3cdiv class\x3d"day"\x3e' + b.getDate() + '\x3c/div\x3e\x3cdiv style\x3d"line-height: 22px;"\x3e\u519c\u5386' + a.IMonthCn + a.IDayCn + "\x3cbr\x3e" + a.gzYear + "\u5e74" + a.gzMonth + "\u6708" + a.gzDay + "\u65e5\x3cbr\x3e" + a.Animal + "\u5e74\x26nbsp;" + (a.isTerm ? a.Term : "") + "\x3c/div\x3e")
        },
        clear: function(b) {
            $(".HomeButton").removeClass("active");
            $(".ApplyButton").removeClass("active");
            $(".ThemeButton").removeClass("active");
            $(".StartMenu").hide();
            $(".AppMenu").hide();
            $(".ThemeMenu").hide();
            $(".TaskStatus .ClockList").hide();
            $(".TaskStatus .WeatherList").hide();
            $(".TaskStatus .UserMenu").hide();
            this.bPannelBoard && ($("#desktopFrame1").animate({
                left: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal"),
            $("#pannelFrame").css({
                left: $(window).width() - 420,
                right: "unset",
                display: "block"
            }),
            $("#pannelFrame").animate({
                left: $(window).width(),
                opacity: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal", function() {
                $("#pannelFrame").css({
                    left: "unset",
                    right: -420,
                    display: "none"
                });
                $("pannelFrame").empty()
            }),
            this.bPannelBoard = !1);
            1 != b && ($("#desktopFrame1_Panel_Home").show(),
            $("#desktopFrame1_Panel_Widget").hide(),
            $("#desktopFrame1").find(".desktopWrapper").removeClass("blur"),
            $(".TaskStatus .Search").hide(),
            this.bDashBoard = !1)
        },
        close: function() {
            this.bPannelBoard && ($("#desktopFrame1").animate({
                left: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal"),
            $("#pannelFrame").css({
                left: $(window).width() - 420,
                right: "unset",
                display: "block"
            }),
            $("#pannelFrame").animate({
                left: $(window).width(),
                opacity: 0,
                avoidTransforms: !1,
                useTranslate3d: TUI.env.ua.has3d
            }, "normal", function() {
                $("#pannelFrame").css({
                    left: "unset",
                    right: -420,
                    display: "none"
                });
                $("pannelFrame").empty()
            }),
            this.bPannelBoard = !1)
        },
        show: function() {
            $("#" + this.containerBar).slideDown("normal")
        },
        hide: function() {
            $("#" + this.containerBar).slideUp("normal")
        },
        loadSystemMenu: function() {
            var b = $("#" + this.containerBar + "_System").find(".StartMenu .AppList");
            b.empty();
            var a = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/system/style/images/about.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e\u5173\u4e8e\u672c\u673a\x3c/span\x3e\x3c/div\x3e');
            a.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear();
                $.ajax({
                    type: "get",
                    url: "/System/srv/about.ejs",
                    context: a.data.handle.home,
                    error: function(a) {
                        playSound("error");
                        toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u5173\u4e8eThingsOS")
                    },
                    success: function(a) {
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                            container: this.container,
                            type: "html",
                            msg: "query",
                            value: a
                        },{
                            title: "\u5173\u4e8e\u672c\u673a",
                            width: 300,
                            height: 350,
                            reSize: !1,
                            showMin: !1,
                            showMax: !1,
                            center: !0,
                            modal: !0
                        });
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
                    }
                })
            });
            b.append(a);
            for (var d = 0; d < TUI.env.cfg.system.installApp.length; d++)
                TUI.env.cfg.system.installApp[d].isUserApp || "system" != TUI.env.cfg.system.installApp[d].app.launch.container && "personal" != TUI.env.cfg.system.installApp[d].app.launch.container || (a = "0CB4D644-896A-4ADA-9D5F-58448BD04499" == TUI.env.cfg.system.installApp[d].appid ? $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/System/srv/userpic.ejs?userid\x3d' + TUI.env.us.userName + '" onmousedown\x3d"return false;" style\x3d"border-radius: 8px;-moz-border-radius: 8px;-webkit-border-radius: 8px;"/\x3e\x3cbr\x3e\x3cspan\x3e' + TUI.env.cfg.system.installApp[d]["short"] + "\x3c/span\x3e\x3c/div\x3e") : "73C98149-620B-4F05-A75A-79B6C626D992" == TUI.env.cfg.system.installApp[d].appid ? $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/Webapp/Calendar/Resources/Images/' + (new Date).Format("MMdd") + '.png" onmousedown\x3d"return false;" style\x3d"border-radius: 8px;-moz-border-radius: 8px;-webkit-border-radius: 8px;"/\x3e\x3cbr\x3e\x3cspan\x3e' + TUI.env.cfg.system.installApp[d]["short"] + "\x3c/span\x3e\x3c/div\x3e") : $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"' + TUI.env.cfg.system.installApp[d].urlPath + "/" + TUI.env.cfg.system.installApp[d].icons.logo + '" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e' + TUI.env.cfg.system.installApp[d]["short"] + "\x3c/span\x3e\x3c/div\x3e"),
                a.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                    handle: this,
                    appcfg: TUI.env.cfg.system.installApp[d]
                }, function(a) {
                    a.data.handle.clear();
                    if (TUI.env.os[TUI.env.desktop - 1].checkHandle(a.data.appcfg.appid))
                        TUI.env.os[TUI.env.desktop - 1].activeHandle(a.data.appcfg.appid);
                    else {
                        var c = new Dialog({
                            container: a.data.handle.home.container,
                            type: "iframe",
                            value: a.data.appcfg.app.launch.local_path
                        },{
                            title: a.data.appcfg.name,
                            taskImg: a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo,
                            handle: TUI.env.os[TUI.env.desktop - 1],
                            appid: a.data.appcfg.appid,
                            urlPath: a.data.appcfg.urlPath,
                            afterShow: function() {},
                            afterHide: function() {
                                this.handle.hideHandle(a.data.appcfg.appid)
                            },
                            afterClose: function() {
                                this.handle.delHandle(a.data.appcfg.appid)
                            },
                            afterSwitch: function() {
                                this.handle.switchHandle(a.data.appcfg.appid)
                            },
                            modal: !1,
                            center: !0,
                            width: a.data.appcfg.app.launch.width,
                            height: a.data.appcfg.app.launch.height
                        });
                        c.show();
                        TUI.env.os[TUI.env.desktop - 1].addHandle(c, a.data.appcfg.name, a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo, a.data.appcfg.appid)
                    }
                }),
                b.append(a))
        },
        loadSystemApp: function(b) {
            var a = $("#" + this.containerBar + "_System").find(".AppMenu .AppList .tab1content");
            a.empty();
            var d = $("#" + this.containerBar + "_System").find(".AppMenu .AppList .tab2content");
            d.empty();
            for (var c = 0; c < TUI.env.cfg.system.installApp.length; c++)
                if ((TUI.env.cfg.system.installApp[c].isUserApp || "webapp" == TUI.env.cfg.system.installApp[c].app.launch.container || "sysapp" == TUI.env.cfg.system.installApp[c].app.launch.container || "smartapp" == TUI.env.cfg.system.installApp[c].app.launch.container || "proxy" == TUI.env.cfg.system.installApp[c].app.launch.container || "url" == TUI.env.cfg.system.installApp[c].app.launch.container) && (0 <= TUI.env.cfg.system.installApp[c].name.indexOf(b) || 0 <= TUI.env.cfg.system.installApp[c].description.indexOf(b)) && TUI.env.cfg.system.installApp[c].app.launch.enable) {
                    var e = $('\x3cdiv class\x3d"item' + (TUI.env.us.isUserSuper || TUI.env.cfg.system.installApp[c].isUserApp ? " user" : "") + '"\x3e\x3cimg src\x3d"' + TUI.env.cfg.system.installApp[c].urlPath + "/" + TUI.env.cfg.system.installApp[c].icons.logo + '" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e' + TUI.env.cfg.system.installApp[c]["short"] + '\x3c/span\x3e\x3cdiv class\x3d"uninstall"\x3e\x3c/div\x3e\x3c/div\x3e');
                    e.find(".uninstall").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        item: e,
                        appcfg: TUI.env.cfg.system.installApp[c]
                    }, function(a) {
                        a.data.handle.clear();
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                            container: a.data.handle.home.container,
                            type: "msgbox",
                            msg: "warn",
                            value: "\u60a8\u662f\u5426\u786e\u5b9a\u5378\u8f7d\u300a" + a.data.appcfg.name + "\u300b\uff1f\u6b64\u64cd\u4f5c\u5c06\u5f71\u54cd\u4f7f\u7528\u4e2d\u7684\u7528\u6237\uff0c\u5e76\u4e14\u4e0d\u53ef\u64a4\u9500\uff01\uff01"
                        },{
                            title: "\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f",
                            width: 400,
                            height: 155,
                            handle: a.data.handle,
                            appId: a.data.appcfg.appid,
                            urlPath: a.data.appcfg.urlPath,
                            afterClose: function(a) {
                                1 == a && this.handle.delAppUser(this.appId, this.urlPath)
                            },
                            reSize: !1,
                            showMin: !1,
                            showMax: !1,
                            center: !0,
                            modal: !0
                        });
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show();
                        return !1
                    });
                    e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        appcfg: TUI.env.cfg.system.installApp[c]
                    }, function(a) {
                        a.data.handle.clear();
                        if (TUI.env.os[TUI.env.desktop - 1].checkHandle(a.data.appcfg.appid))
                            TUI.env.os[TUI.env.desktop - 1].activeHandle(a.data.appcfg.appid);
                        else {
                            var c = new Dialog({
                                container: a.data.handle.home.container,
                                type: "iframe",
                                value: a.data.appcfg.app.launch.local_path
                            },{
                                title: a.data.appcfg.name,
                                taskImg: a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo,
                                handle: TUI.env.os[TUI.env.desktop - 1],
                                appid: a.data.appcfg.appid,
                                urlPath: a.data.appcfg.urlPath,
                                afterShow: function() {},
                                afterHide: function() {
                                    this.handle.hideHandle(a.data.appcfg.appid)
                                },
                                afterClose: function() {
                                    this.handle.delHandle(a.data.appcfg.appid)
                                },
                                afterSwitch: function() {
                                    this.handle.switchHandle(a.data.appcfg.appid)
                                },
                                modal: !1,
                                center: !0,
                                width: a.data.appcfg.app.launch.width,
                                height: a.data.appcfg.app.launch.height
                            });
                            c.show();
                            TUI.env.os[TUI.env.desktop - 1].addHandle(c, a.data.appcfg.name, a.data.appcfg.urlPath + "/" + a.data.appcfg.icons.logo, a.data.appcfg.appid)
                        }
                    });
                    a.append(e)
                }
            if (!TUI.env.us.isUserSuper)
                for (c = 0; c < TUI.env.cfg.system.installApp.length; c++)
                    if (void 0 != TUI.env.cfg.system.installApp[c].app.pad && TUI.env.cfg.system.installApp[c].app.pad.enable && void 0 != TUI.env.cfg.system.installApp[c].app.pad.webapp)
                        for (var h = TUI.env.cfg.system.installApp[c].app.pad.webapp, f = 0; f < h.length; f++)
                            void 0 != h[f].local_path && (h[f].logo = TUI.env.cfg.system.installApp[c].urlPath + "/Pad/" + h[f].id + "/icon.png",
                            e = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"' + TUI.env.cfg.system.installApp[c].urlPath + "/Pad/" + h[f].id + '/icon.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e' + h[f].text + "\x3c/span\x3e\x3c/div\x3e"),
                            e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                                handle: this,
                                padapp: h[f]
                            }, function(a) {
                                a.data.handle.clear();
                                if (TUI.env.os[TUI.env.desktop - 1].checkHandle("Pad-" + a.data.padapp.id))
                                    TUI.env.os[TUI.env.desktop - 1].activeHandle("Pad-" + a.data.padapp.id);
                                else {
                                    var c = new Dialog({
                                        container: a.data.handle.home.container,
                                        type: "iframe",
                                        value: a.data.padapp.local_path
                                    },{
                                        title: a.data.padapp.text + "\u2014\u2014\u5de5\u4f5c\u53f0",
                                        taskImg: a.data.padapp.logo,
                                        handle: TUI.env.os[TUI.env.desktop - 1],
                                        appid: "Pad-" + a.data.padapp.id,
                                        urlPath: a.data.padapp.local_path,
                                        afterShow: function() {},
                                        afterHide: function() {
                                            this.handle.hideHandle("Pad-" + a.data.padapp.id)
                                        },
                                        afterClose: function() {
                                            this.handle.delHandle("Pad-" + a.data.padapp.id)
                                        },
                                        afterSwitch: function() {
                                            this.handle.switchHandle("Pad-" + a.data.padapp.id)
                                        },
                                        modal: !1,
                                        center: !0,
                                        width: 1024,
                                        height: 720
                                    });
                                    c.show();
                                    TUI.env.os[TUI.env.desktop - 1].addHandle(c, a.data.padapp.text, a.data.padapp.logo, "Pad-" + a.data.padapp.id)
                                }
                            }),
                            a.append(e));
            e = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/System/style/images/plus.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e\u6dfb\u52a0\u5e94\u7528\x3c/span\x3e\x3c/div\x3e');
            e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.handle.home.container,
                    type: "iframe",
                    value: "tools/upload_apply/"
                },{
                    title: "\u5e94\u7528\u7a0b\u5e8f",
                    width: 450,
                    height: 310,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        3 == a && $("#" + this.handle.containerBar + "_System").find(".ApplyButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            a.append(e);
            for (c = 0; c < TUI.env.cfg.system.installWidget.length; c++)
                if (0 <= TUI.env.cfg.system.installWidget[c].name.indexOf(b) || 0 <= TUI.env.cfg.system.installWidget[c].description.indexOf(b))
                    e = $('\x3cdiv class\x3d"item' + (TUI.env.us.isUserSuper || TUI.env.cfg.system.installWidget[c].isUserWidget ? " user" : "") + '"\x3e\x3cimg src\x3d"' + TUI.env.cfg.system.installWidget[c].urlPath + "/" + TUI.env.cfg.system.installWidget[c].icons.logo + '" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e' + TUI.env.cfg.system.installWidget[c].name + '\x3c/span\x3e\x3cdiv class\x3d"uninstall"\x3e\x3c/div\x3e\x3c/div\x3e'),
                    e.find(".uninstall").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        item: e,
                        appcfg: TUI.env.cfg.system.installWidget[c]
                    }, function(a) {
                        a.data.handle.clear();
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                            container: a.data.handle.home.container,
                            type: "msgbox",
                            msg: "warn",
                            value: "\u60a8\u662f\u5426\u786e\u5b9a\u5378\u8f7d\u300a" + a.data.appcfg.name + "\u300b\uff1f\u6b64\u64cd\u4f5c\u5c06\u5f71\u54cd\u4f7f\u7528\u4e2d\u7684\u7528\u6237\uff0c\u5e76\u4e14\u4e0d\u53ef\u64a4\u9500\uff01"
                        },{
                            title: "\u5378\u8f7d\u684c\u9762\u90e8\u4ef6",
                            width: 400,
                            height: 155,
                            handle: a.data.handle,
                            appId: a.data.appcfg.appid,
                            urlPath: a.data.appcfg.urlPath,
                            afterClose: function(a) {
                                1 == a && this.handle.delWidget(this.appId, this.urlPath)
                            },
                            reSize: !1,
                            showMin: !1,
                            showMax: !1,
                            center: !0,
                            modal: !0
                        });
                        TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show();
                        return !1
                    }),
                    e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        appcfg: TUI.env.cfg.system.installWidget[c]
                    }, function(a) {
                        a.data.handle.clear();
                        a.data.handle.home.setWidget(a.data.appcfg.appid, a.data.appcfg.urlPath, 2)
                    }),
                    d.append(e);
            e = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/System/style/images/plus.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e\u6dfb\u52a0\u90e8\u4ef6\x3c/span\x3e\x3c/div\x3e');
            e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.handle.home.container,
                    type: "iframe",
                    value: "tools/upload_widget/"
                },{
                    title: "\u5b89\u88c5\u684c\u9762\u90e8\u4ef6",
                    width: 450,
                    height: 310,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        3 == a && $("#" + this.handle.containerBar + "_System").find(".ApplyButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            d.append(e)
        },
        loadSystemTheme: function(b) {
            var a = $("#" + this.containerBar + "_System").find(".ThemeMenu .ThemeList .tab1content");
            a.empty();
            var d = $("#" + this.containerBar + "_System").find(".ThemeMenu .ThemeList .tab2content");
            d.empty();
            for (var c = 0; c < this.themelist.tList.length; c++)
                if (0 <= this.themelist.tList[c].fileName.indexOf(b)) {
                    var e = $('\x3cdiv class\x3d"item' + (TUI.env.us.isUserSuper || this.themelist.tList[c].isUserTheme ? " user" : "") + '"\x3e\x3cimg src\x3d"' + this.themelist.tList[c].urlPath + '/snapshot.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e' + this.themelist.tList[c].fileName + '\x3c/span\x3e\x3cdiv class\x3d"uninstall"\x3e\x3c/div\x3e\x3c/div\x3e');
                    e.find(".uninstall").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        item: e,
                        themecfg: this.themelist.tList[c]
                    }, function(a) {
                        $(a.data.item).remove();
                        $.ajax({
                            url: "/System/srv/deltheme.ejs?themepath\x3d" + a.data.themecfg.fileName + "\x26isUser\x3d" + (a.data.themecfg.isUserTheme ? "user" : "system"),
                            dataType: "text",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u5220\u9664\u7528\u6237\u4e3b\u9898\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u7528\u6237\u4e3b\u9898")
                            },
                            success: function(a) {
                                "FAIL" == a && (playSound("warn"),
                                toastr.warning("\u5220\u9664\u7528\u6237\u4e3b\u9898\u5931\u8d25\uff01", "\u5220\u9664\u7528\u6237\u4e3b\u9898"))
                            }
                        });
                        return !1
                    });
                    e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                        handle: this,
                        themecfg: this.themelist.tList[c]
                    }, function(a) {
                        a.data.handle.clear();
                        a.data.handle.home.desktopFrame.clear();
                        a.data.handle.home.desktopFrame.setup({
                            bTensile: !0,
                            imgWrapper: a.data.themecfg.themePath + "/i/wrapper.jpg",
                            bTheme: !0
                        });
                        document.getElementById("mytheme").href = a.data.themecfg.themePath + "/theme.css";
                        $.ajax({
                            type: "post",
                            url: "/System/srv/setTheme.ejs",
                            data: {
                                imgTheme: a.data.themecfg.themePath,
                                deskTop: TUI.env.desktop
                            },
                            dataType: "text",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u8bbe\u7f6e\u7cfb\u7edf\u4e3b\u9898\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u8bbe\u7f6e\u7cfb\u7edf\u4e3b\u9898")
                            },
                            success: function(a) {
                                "OK" == a ? (playSound("info"),
                                toastr.success("\u8bbe\u7f6e\u60a8\u7684\u7cfb\u7edf\u4e3b\u9898\u6210\u529f\uff01\uff01", "\u8bbe\u7f6e\u7cfb\u7edf\u4e3b\u9898")) : (playSound("warn"),
                                toastr.warning("\u8bbe\u7f6e\u7cfb\u7edf\u4e3b\u9898\u5931\u8d25\uff01", "\u8bbe\u7f6e\u7cfb\u7edf\u4e3b\u9898"))
                            }
                        })
                    });
                    a.append(e)
                }
            e = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/System/style/images/plus2.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e\u6dfb\u52a0\u4e3b\u9898\x3c/span\x3e\x3c/div\x3e');
            e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.handle.home.container,
                    type: "iframe",
                    value: "tools/upload_theme/"
                },{
                    title: "\u5e94\u7528\u4e3b\u9898",
                    width: 450,
                    height: 310,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        3 == a && $("#" + this.handle.containerBar + "_System").find(".ThemeButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            a.append(e);
            for (c = 0; c < this.themelist.wList.length; c++)
                0 <= this.themelist.wList[c].fileName.indexOf(b) && (e = $('\x3cdiv class\x3d"item' + (TUI.env.us.isUserSuper || this.themelist.wList[c].isUserWrapper ? " user" : "") + '"\x3e\x3cimg src\x3d"' + this.themelist.wList[c].urlPath + '" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan class\x3d"wbtn1"\x3e\x26nbsp;\u5e73\x26nbsp;\u94fa\x26nbsp;\x3c/span\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x3cspan class\x3d"wbtn2"\x3e\x26nbsp;\u62c9\x26nbsp;\u4f38\x26nbsp;\x3c/span\x3e\x3cdiv class\x3d"uninstall"\x3e\x3c/div\x3e\x3c/div\x3e'),
                e.find(".uninstall").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                    handle: this,
                    item: e,
                    themecfg: this.themelist.wList[c]
                }, function(a) {
                    $(a.data.item).remove();
                    $.ajax({
                        url: "/System/srv/delimage.ejs?filename\x3d" + a.data.themecfg.fileName + "\x26isUser\x3d" + (a.data.themecfg.isUserWrapper ? "user" : "system"),
                        dataType: "text",
                        error: function(a) {
                            playSound("error");
                            toastr.error("\u5220\u9664\u7528\u6237\u5899\u7eb8\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u5220\u9664\u7528\u6237\u5899\u7eb8")
                        },
                        success: function(a) {
                            toastr.success(a, "\u5220\u9664\u7528\u6237\u5899\u7eb8")
                        }
                    });
                    return !1
                }),
                e.find(".wbtn1").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                    handle: this,
                    themecfg: this.themelist.wList[c]
                }, function(a) {
                    a.data.handle.clear();
                    a.data.handle.home.desktopFrame.setup({
                        bTensile: !1,
                        imgWrapper: a.data.themecfg.srcPath
                    })
                }),
                e.find(".wbtn2").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                    handle: this,
                    themecfg: this.themelist.wList[c]
                }, function(a) {
                    a.data.handle.clear();
                    a.data.handle.home.desktopFrame.setup({
                        bTensile: !0,
                        imgWrapper: a.data.themecfg.srcPath
                    })
                }),
                e.find("img").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                    handle: this,
                    themecfg: this.themelist.wList[c]
                }, function(a) {
                    a.data.handle.clear();
                    a.data.handle.home.desktopFrame.setup({
                        bTensile: !0,
                        imgWrapper: a.data.themecfg.srcPath
                    })
                }),
                d.append(e));
            e = $('\x3cdiv class\x3d"item"\x3e\x3cimg src\x3d"/System/style/images/plus2.png" onmousedown\x3d"return false;"/\x3e\x3cbr\x3e\x3cspan\x3e\u6dfb\u52a0\u5899\u7eb8\x3c/span\x3e\x3c/div\x3e');
            e.bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.handle.home.container,
                    type: "iframe",
                    value: "tools/upload_wrapper/"
                },{
                    title: "\u684c\u9762\u5899\u7eb8",
                    width: 450,
                    height: 310,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        3 == a && $("#" + this.handle.containerBar + "_System").find(".ThemeButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            });
            d.append(e)
        },
        addSystemButton: function(b, a, d) {
            "home" == d ? ($("#" + this.containerBar + "_System ul").append('\t\t\x3cli\x3e \t\t\t\x3cdiv  id\x3d"' + this.containerBar + "_" + d + '" class\x3d"' + a + '"\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"StartMenu"\x3e\t\t\t\t\x3cdiv class\x3d"AppList"\x3e\x3c/div\x3e\t\t\t\t\x3cdiv class\x3d"UserOperate"\x3e\t\t\t\t\t\x3cdiv class\x3d"DoLock"\x3e\x3ci class\x3d"fa fa-lock"\x3e\x3c/i\x3e\x26nbsp;\u9501 \u5b9a\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"Logout"\x3e\x3ci class\x3d"fa fa-sign-out"\x3e\x3c/i\x3e\x26nbsp;\u6ce8 \u9500\x3c/div\x3e\t\t\t\t\x3c/div\x3e\t\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3c/div\x3e\t\t\x3c/li\x3e '),
            $("#" + this.containerBar + "_" + d).bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1);
                $(".HomeButton").removeClass("active");
                $(".ApplyButton").removeClass("active");
                $(".ThemeButton").removeClass("active");
                $(this).addClass("active");
                $(".StartMenu").show();
                $(".AppMenu").hide();
                $(".ThemeMenu").hide();
                location.hash = "#start";
                TUI.env.us.isHashChange = !1
            }),
            $("#" + this.containerBar + "_System").find(".StartMenu .DoLock").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "query",
                    value: "\u60a8\u662f\u5426\u786e\u5b9a\u9501\u5b9aThingsOS\u684c\u9762\uff1f"
                },{
                    title: "\u9501\u5b9a\u684c\u9762",
                    width: 400,
                    height: 155,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        1 == a && ($("#loginFrame").show(),
                        $("#loginFrame").css({
                            left: $(window).width() + 50,
                            opacity: 0
                        }),
                        $("#loginFrame").animate({
                            left: 0,
                            opacity: 1,
                            avoidTransforms: !1,
                            useTranslate3d: TUI.env.ua.has3d
                        }, 1E3, function() {
                            TUI.env.login.reset();
                            TUI.env.login.show(700);
                            TUI.env.desktop = 0
                        }),
                        $("#desktopFrame1").animate({
                            left: -($(window).width() + 50),
                            opacity: 0,
                            avoidTransforms: !1,
                            useTranslate3d: TUI.env.ua.has3d
                        }, 1E3, function() {
                            $("#desktopFrame1").hide()
                        }))
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            }),
            $("#" + this.containerBar + "_System").find(".StartMenu .Logout").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.clear();
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos = new Dialog({
                    container: a.data.parent.container,
                    type: "msgbox",
                    msg: "warn",
                    value: "\u60a8\u786e\u5b9a\u8981\u6ce8\u9500ThingsOS\u684c\u9762\u5417\uff1f"
                },{
                    title: "\u6ce8\u9500\u684c\u9762",
                    width: 400,
                    height: 155,
                    handle: a.data.handle,
                    afterClose: function(a) {
                        1 == a && $.ajax({
                            type: "get",
                            url: "/System/srv/logout.ejs",
                            error: function(a) {
                                playSound("error");
                                toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u6ce8\u9500\u8d26\u6237")
                            },
                            success: function(a) {
                                top.location.href = "/"
                            }
                        })
                    },
                    reSize: !1,
                    showMin: !1,
                    showMax: !1,
                    center: !0,
                    modal: !0
                });
                TUI.env.os[TUI.env.desktop - 1].ModalWindwos.show()
            })) : "apply" == d ? ($("#" + this.containerBar + "_System ul").append('\t\t\x3cli\x3e \t\t\t\x3cdiv  id\x3d"' + this.containerBar + "_" + d + '" class\x3d"' + a + '"\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"AppMenu"\x3e\t\t\t\t\x3cdiv class\x3d"AppList"\x3e\t\t\t\t\t\x3cdiv class\x3d"tab1 active"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab1content"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab2"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab2content"\x3e\x3c/div\x3e\t\t\t\t\x3c/div\x3e\t\t\t\t\x3cdiv class\x3d"AppSearch"\x3e\t\t\t\t\t\x3cdiv class\x3d"searchBtn"\x3e\x3ci class\x3d"fa fa-search"\x3e\x3c/i\x3e\x3c/div\x3e\t\t\t\t\t\x3cinput type\x3d"text" class\x3d"searchKey" placeholder\x3d"\u641c\u7d22..." required\x3e\t\t\t\t\t\x3cdiv class\x3d"edit"\x3e\u7ba1 \u7406\x3c/div\x3e\t\t\t\t\x3c/div\x3e\t\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3c/div\x3e\t\t\x3c/li\x3e '),
            $("#" + this.containerBar + "_" + d).bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1);
                $(".HomeButton").removeClass("active");
                $(".ApplyButton").removeClass("active");
                $(".ThemeButton").removeClass("active");
                $(this).addClass("active");
                $(".StartMenu").hide();
                $(".AppMenu").show();
                $(".ThemeMenu").hide();
                $(".AppMenu .AppSearch .edit").removeClass("active");
                $(".AppMenu .AppList .tab1").addClass("active");
                $(".AppMenu .AppList .tab2").removeClass("active");
                $(".AppMenu .AppList .tab1content").show();
                $(".AppMenu .AppList .tab2content").hide();
                a.data.handle.isAppEdit = !1;
                location.hash = "#app";
                TUI.env.us.isHashChange = !1;
                $.ajax({
                    type: "get",
                    url: "/System/srv/readconfig.ejs",
                    dataType: "json",
                    context: a.data.handle,
                    error: function(a) {
                        playSound("error");
                        toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u4e2a\u4eba\u8bbe\u5b9a")
                    },
                    success: function(a) {
                        TUI.env.cfg = a;
                        a = $(".AppMenu .AppSearch .searchKey").val();
                        this.loadSystemApp(a)
                    }
                })
            }),
            $(".AppMenu .AppList .tab1").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(this).addClass("active");
                $(".AppMenu .AppList .tab2").removeClass("active");
                $(".AppMenu .AppList .tab1content").show();
                $(".AppMenu .AppList .tab2content").hide();
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1)
            }),
            $(".AppMenu .AppList .tab2").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(this).addClass("active");
                $(".AppMenu .AppList .tab1").removeClass("active");
                $(".AppMenu .AppList .tab1content").hide();
                $(".AppMenu .AppList .tab2content").show();
                a.data.handle.bDashBoard || ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1)
            }),
            $(".AppMenu .AppSearch .searchBtn").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                var c = $(".AppMenu .AppSearch .searchKey").val();
                a.data.handle.loadSystemApp(c)
            }),
            $(".AppMenu .AppSearch  .searchKey").change({
                handle: this
            }, function(a) {
                var c = $(this).val();
                a.data.handle.loadSystemApp(c)
            }),
            $(".AppMenu .AppSearch .edit").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.isAppEdit ? ($(".AppMenu .AppList .tab1content").find(".item").removeClass("select"),
                $(".AppMenu .AppList .tab2content").find(".item").removeClass("select"),
                $(this).removeClass("active"),
                a.data.handle.isAppEdit = !1) : ($(".AppMenu .AppList .tab1content").find(".item").addClass("select"),
                $(".AppMenu .AppList .tab2content").find(".item").addClass("select"),
                $(this).addClass("active"),
                a.data.handle.isAppEdit = !0)
            })) : "theme" == d && ($("#" + this.containerBar + "_System ul").append('\t\t\x3cli\x3e \t\t\t\x3cdiv  id\x3d"' + this.containerBar + "_" + d + '" class\x3d"' + a + '"\x3e\x3c/div\x3e\t\t\t\x3cdiv class\x3d"ThemeMenu"\x3e\t\t\t\t\x3cdiv class\x3d"ThemeList"\x3e\t\t\t\t\t\x3cdiv class\x3d"tab1 active"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab1content"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab2"\x3e\x3c/div\x3e\t\t\t\t\t\x3cdiv class\x3d"tab2content"\x3e\x3c/div\x3e\t\t\t\t\x3c/div\x3e\t\t\t\t\x3cdiv class\x3d"ThemeSearch"\x3e\t\t\t\t\t\x3cdiv class\x3d"searchBtn"\x3e\x3ci class\x3d"fa fa-search"\x3e\x3c/i\x3e\x3c/div\x3e\t\t\t\t\t\x3cinput type\x3d"text" class\x3d"searchKey" placeholder\x3d"\u641c\u7d22..." required\x3e\t\t\t\t\t\x3cdiv class\x3d"edit"\x3e\u7f16 \u8f91\x3c/div\x3e\t\t\t\t\x3c/div\x3e\t\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e\t\t\t\x3c/div\x3e\t\t\x3c/li\x3e '),
            $("#" + this.containerBar + "_" + d).bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.bDashBoard && ($("#desktopFrame1_Panel_Widget").animate({
                    opacity: 0,
                    avoidTransforms: !1,
                    useTranslate3d: TUI.env.ua.has3d
                }, "fast", function() {
                    $("#desktopFrame1_Panel_Home").show();
                    $("#desktopFrame1_Panel_Widget").hide();
                    $("#desktopFrame1").find(".desktopWrapper").removeClass("blur");
                    $(".TaskStatus .Search").hide()
                }),
                a.data.handle.bDashBoard = !1,
                a.data.handle.bDashBoard ? $("#" + a.data.handle.containerBar + "_Status").find(".DashBoard").html('\x3cimg src\x3d"/System/style/images/22.png"/\x3e') : $("#" + a.data.handle.containerBar + "_Status").find(".DashBoard").html('\x3cimg src\x3d"/System/style/images/11.png"/\x3e'));
                $(".HomeButton").removeClass("active");
                $(".ApplyButton").removeClass("active");
                $(".ThemeButton").removeClass("active");
                $(this).addClass("active");
                $(".StartMenu").hide();
                $(".AppMenu").hide();
                $(".ThemeMenu").show();
                $(".ThemeMenu .ThemeSearch .edit").removeClass("active");
                a.data.handle.isThemeEdit = !1;
                location.hash = "#theme";
                TUI.env.us.isHashChange = !1;
                $.ajax({
                    type: "get",
                    url: "/System/srv/theme.ejs",
                    dataType: "json",
                    context: a.data.handle,
                    error: function(a) {
                        playSound("error");
                        toastr.error("\u7f51\u7edc\u6216\u540e\u53f0\u670d\u52a1\u9519\u8bef,\u8bf7\u91cd\u8bd5\uff01", "\u684c\u9762\u4e3b\u9898")
                    },
                    success: function(a) {
                        this.themelist = a;
                        a = $(".ThemeMenu .ThemeSearch .searchKey").val();
                        this.loadSystemTheme(a)
                    }
                })
            }),
            $(".ThemeMenu .ThemeList .tab1").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(this).addClass("active");
                $(".ThemeMenu .ThemeList .tab2").removeClass("active");
                $(".ThemeMenu .ThemeList .tab1content").show();
                $(".ThemeMenu .ThemeList .tab2content").hide()
            }),
            $(".ThemeMenu .ThemeList .tab2").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                $(this).addClass("active");
                $(".ThemeMenu .ThemeList .tab1").removeClass("active");
                $(".ThemeMenu .ThemeList .tab1content").hide();
                $(".ThemeMenu .ThemeList .tab2content").show()
            }),
            $(".ThemeMenu .ThemeSearch .searchBtn").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                var b = $(".ThemeMenu .ThemeSearch .searchKey").val();
                a.data.handle.loadSystemTheme(b)
            }),
            $(".ThemeMenu .ThemeSearch  .searchKey").change({
                handle: this
            }, function(a) {
                var b = $(this).val();
                a.data.handle.loadSystemTheme(b)
            }),
            $(".ThemeMenu .ThemeSearch .edit").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: this,
                parent: this.home
            }, function(a) {
                a.data.handle.isThemeEdit ? ($(".ThemeMenu .ThemeList .tab1content").find(".item").removeClass("select"),
                $(".ThemeMenu .ThemeList .tab2content").find(".item").removeClass("select"),
                $(this).removeClass("active"),
                a.data.handle.isThemeEdit = !1) : ($(".ThemeMenu .ThemeList .tab1content").find(".item").addClass("select"),
                $(".ThemeMenu .ThemeList .tab2content").find(".item").addClass("select"),
                $(this).addClass("active"),
                a.data.handle.isThemeEdit = !0)
            }))
        },
        delAppUser: function(b, a) {
            $.ajax({
                type: "post",
                url: "/System/srv/delapp.ejs",
                data: {
                    appId: b,
                    urlPath: a
                },
                dataType: "text",
                context: this,
                error: function(a) {
                    playSound("error");
                    toastr.error("\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f")
                },
                success: function(d) {
                    "FORBIDDEN" == d ? (playSound("warn"),
                    toastr.warning("\u5f53\u524d\u7528\u6237\u7981\u6b62\u5378\u8f7d\u8be5\u5e94\u7528\u7a0b\u5e8f\uff01", "\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f")) : "OK" == d ? (playSound("info"),
                    this.home.uninstall(b, a),
                    toastr.info("\u5f53\u524d\u7528\u6237\u5378\u8f7d\u8be5\u5e94\u7528\u7a0b\u5e8f\u6210\u529f\uff01", "\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f"),
                    $("#" + this.containerBar + "_System").find(".ApplyButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)) : (playSound("warn"),
                    toastr.warning("\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f\u5931\u8d25\uff01" + d, "\u5378\u8f7d\u5e94\u7528\u7a0b\u5e8f"))
                }
            })
        },
        delWidget: function(b, a) {
            $.ajax({
                type: "post",
                url: "/System/srv/remove_widget.ejs",
                data: {
                    appId: b,
                    urlPath: a
                },
                dataType: "text",
                context: this,
                error: function(a) {
                    playSound("error");
                    toastr.error("\u5378\u8f7d\u684c\u9762\u90e8\u4ef6\u5931\u8d25,\u8bf7\u91cd\u8bd5\uff01", "\u5378\u8f7d\u684c\u9762\u90e8\u4ef6")
                },
                success: function(a) {
                    "FORBIDDEN" == a ? (playSound("warn"),
                    toastr.warning("\u5f53\u524d\u7528\u6237\u7981\u6b62\u5378\u8f7d\u8be5\u684c\u9762\u90e8\u4ef6\uff01", "\u5378\u8f7d\u684c\u9762\u90e8\u4ef6")) : "OK" == a ? (playSound("info"),
                    this.home.delWidget(b),
                    toastr.info("\u5f53\u524d\u7528\u6237\u5378\u8f7d\u8be5\u684c\u9762\u90e8\u4ef6\u6210\u529f\uff01", "\u5378\u8f7d\u684c\u9762\u90e8\u4ef6"),
                    $("#" + this.containerBar + "_System").find(".ApplyButton").trigger(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp)) : (playSound("warn"),
                    toastr.warning("\u5378\u8f7d\u684c\u9762\u90e8\u4ef6\u5931\u8d25\uff01" + a, "\u5378\u8f7d\u684c\u9762\u90e8\u4ef6"))
                }
            })
        },
        addTaskButton: function(b, a, d, c, e) {
            $("#" + this.containerBar + "_Button ul").append('\t\t\x3cli  id\x3d"' + this.containerBar + "_" + d + '"\x3e \t\t\t\x3cdiv class\x3d"icon"\x3e \t\t\t\t\x3cdiv class\x3d"label"\x3e \t\t\t\t\t\x3cem\x3e' + b + '\x3c/em\x3e \t\t\t\t\t\x3cspan class\x3d"pointer"\x3e\x3c/span\x3e \t\t\t\t\x3c/div\x3e \t\t\t\x3c/div\x3e \t\t\t\x3cdiv  id\x3d"' + this.containerBar + "_" + d + '_Button" class\x3d"ButtonItem"\x3e\t\t\t\t\x3cimg src\x3d"' + a + '"   onmousedown\x3d"return false;"/\x3e          \x3c/div\x3e\t\t\t\t\x3c/li\x3e ');
            $("#" + this.containerBar + "_" + d + "_Button").bind(TUI.env.ua.ontouch ? "tap" : TUI.env.ua.clickEventUp, {
                handle: c,
                taskID: d
            }, e)
        },
        mdyTaskButton: function(b, a, d) {},
        delTaskButton: function(b) {
            $("#" + this.containerBar + "_" + b).remove()
        },
        setTaskActive: function(b) {
            $("#" + this.containerBar + "_" + b + "_Button").removeClass();
            $("#" + this.containerBar + "_" + b + "_Button").addClass("ButtonItemActive")
        },
        setTaskNormal: function(b) {
            $("#" + this.containerBar + "_" + b + "_Button").removeClass();
            $("#" + this.containerBar + "_" + b + "_Button").addClass("ButtonItem")
        },
        clearTaskButton: function() {
            $("#" + this.containerBar + "_Button ul").empty()
        },
        showTaskButton: function() {
            $("#" + this.containerBar + "_Button").show()
        },
        hideTaskButton: function() {
            $("#" + this.containerBar + "_Button").hide()
        }
    }
}
;
function Widget(f, b) {
    b = $.extend({
        top: 60,
        right: 20,
        draggable: !0,
        fixed: !1,
        time: 0,
        id: !1
    }, b);
    b.id = b.id ? b.id : "widget-" + Widget.__count;
    var d = b.id + "-mask"
      , p = null
      , l = !1
      , h = !1
      , m = b.appId
      , k = b.top
      , n = b.right
      , q = b.width ? b.width : 300
      , r = b.height ? b.height : 300
      , u = b.launchFile
      , t = b.fullscreen
      , g = 0;
    Widget.__count++;
    Widget.__top = k;
    var a = $('\x3cdiv id\x3d"' + b.id + '" class\x3d"widget"\x3e\x3cdiv class\x3d"content"\x3e\x3c/div\x3e\x3cdiv class\x3d"bar"\x3e\x3ca class\x3d"close"\x3e\x3c/a\x3e\x3ca class\x3d"setup"\x3e\x3c/a\x3e\x3ca class\x3d"move"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv id\x3d"' + d + '" class\x3d"mask"\x3e\x3c/div\x3e\x3c/div\x3e');
    a.css({
        top: b.top,
        right: b.right,
        width: q,
        height: r
    });
    $("#" + f.container).append(a);
    this.getAppId = function() {
        return m
    }
    ;
    this.getZindex = function() {
        return parseInt(a.css("z-index"))
    }
    ;
    this.getShowFlag = function() {
        return l
    }
    ;
    this.getTop = function() {
        return parseInt(a.css("top"))
    }
    ;
    this.getRight = function() {
        return parseInt(a.css("right"))
    }
    ;
    this.getWidth = function() {
        return parseInt(a.css("width"))
    }
    ;
    this.getHeight = function() {
        return parseInt(a.css("height"))
    }
    ;
    this.setContent = function(v) {
        void 0 != t && t || (a.find(".setup").hide(),
        a.find(".bar").css({
            height: 42
        }));
        a.find(".content").append($('\x3ciframe id\x3d"' + b.id + '_mainFrame" allowtransparency\x3d"true" style\x3d"background-color:transparent;position:relative"  marginwidth\x3d"0" marginheight\x3d"0"   width\x3d"100%"  height\x3d"100%" frameborder\x3d"no" allowtransparency\x3d"true" scrolling\x3d"no"  hidefocus src\x3d"' + v.value + "/" + u + '"/\x3e'))
    }
    ;
    this.show = function() {
        if (void 0 == b.beforeShow || b.beforeShow()) {
            var a = function(a) {
                if (!TUI.env.ua.ie)
                    return $("#" + a).css("opacity");
                a = document.getElementById(a);
                return void 0 != a && void 0 != a.filters && void 0 != a.filters.alpha && void 0 != a.filters.alpha.opacity ? a.filters.alpha.opacity / 100 : 1
            };
            b.modal && $("#" + overlayId).fadeTo("slow", a(overlayId));
            0 != b.time && (p = setTimeout(this.close, b.time));
            l = !0
        }
    }
    ;
    this.close = function() {
        l && (void 0 == b.beforeClose || b.beforeClose()) && (a.remove(),
        l = !1,
        void 0 != b.afterClose && b.afterClose(),
        b.modal && $("#" + overlayId).fadeOut("slow", function() {
            $(this).remove()
        }),
        clearTimeout(p),
        $.ajax({
            type: "post",
            url: "/System/srv/delwidget.ejs",
            data: {
                appId: m,
                deskTop: TUI.env.desktop
            },
            dataType: "json",
            error: function(a) {},
            success: function(a) {
                TUI.env.cfg = a;
                playSound("info")
            }
        }))
    }
    ;
    (function() {
        function f(b) {
            var c = b || window.event;
            TUI.env.ua.ontouch && "windows" != TUI.env.ua.os && (b.preventDefault(),
            c = b.originalEvent.touches[0] || b.originalEvent.changedTouches[0]);
            b = parseInt(a.css("top")) + (c.clientY - e.y);
            var d = parseInt(a.css("right")) - (c.clientX - e.x);
            0 <= b && 0 <= d && (a.css({
                top: b,
                right: d
            }),
            g = (new Date).getTime() / 1E3,
            k = b,
            n = d);
            e.x = c.clientX;
            e.y = c.clientY
        }
        Widget.__zindex++;
        a.css({
            "z-index": Widget.__zindex,
            position: b.fixed ? "fixed" : "absolute"
        });
        var e = {
            x: 0,
            y: 0
        };
        TUI.env.ua.ontouch && "windows" != TUI.env.ua.os ? (a.find(".move").bind("touchstart", function(c) {
            a.find(".bar").animate({
                opacity: 1
            }, 400);
            h = !0;
            b.draggable && ($("#" + d).addClass("active"),
            a.find(".content iframe").fadeOut("fast"),
            c.preventDefault(),
            c = c.originalEvent.touches[0] || c.originalEvent.changedTouches[0],
            e.x = c.clientX,
            e.y = c.clientY,
            g = 0,
            $(document).bind("touchmove", f))
        }),
        $(document).bind("touchend", function(b) {
            a.find(".bar").animate({
                opacity: .3
            }, 600);
            h = !1;
            $("#" + d).removeClass("active");
            a.find(".content iframe").fadeIn("fast");
            $(document).unbind("touchmove");
            0 < g && (g = 0,
            $.ajax({
                type: "post",
                url: "/System/srv/mdywidget.ejs",
                data: {
                    appId: m,
                    top: k,
                    right: n,
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {},
                success: function(a) {
                    TUI.env.cfg = a
                }
            }))
        })) : (a.find(".move").mousedown(function(c) {
            b.draggable && ($("#" + d).addClass("active"),
            a.find(".content iframe").fadeOut("fast"),
            c = c || window.event,
            e.x = c.clientX,
            e.y = c.clientY,
            g = 0,
            $(document).bind("mousemove", f))
        }),
        $(document).mouseup(function(b) {
            $("#" + d).removeClass("active");
            a.find(".content iframe").fadeIn("fast");
            $(document).unbind("mousemove");
            0 < g && (g = 0,
            $.ajax({
                type: "post",
                url: "/System/srv/mdywidget.ejs",
                data: {
                    appId: m,
                    top: 100 * k / ($(window).height() - 70) + "%",
                    right: 100 * n / ($(window).width() - 5) + "%",
                    deskTop: TUI.env.desktop
                },
                dataType: "json",
                error: function(a) {},
                success: function(b) {
                    TUI.env.cfg = b;
                    a.css({
                        top: 100 * k / ($(window).height() - 80) + "%",
                        right: 100 * n / $(window).width() + "%"
                    })
                }
            }))
        }));
        a.find(".close").bind(TUI.env.ua.clickEventDown, this.close);
        a.find(".setup").bind(TUI.env.ua.clickEventDown, function() {
            var c = parseInt(a.css("z-index"));
            1E3 > c ? ($(".widget").hide(),
            a.css("z-index", c + 1E3),
            a.css({
                top: 0,
                left: 20,
                bottom: 0,
                right: 0
            }),
            a.css("width", "initial"),
            a.css("height", "initial"),
            a.show()) : ($(".widget").show(),
            a.css("z-index", c - 1E3),
            a.css({
                top: b.top,
                right: b.right,
                width: q,
                height: r
            }),
            a.css("left", "initial"),
            a.css("bottom", "initial"))
        });
        a.bind(TUI.env.ua.clickEventUp, function() {
            parseInt(a.css("z-index")) < Widget.__zindex && (Widget.__zindex++,
            a.css("z-index", Widget.__zindex),
            a.css("opacity", 1),
            void 0 != b.afterSwitch && b.afterSwitch())
        });
        TUI.env.ua.ontouch && "windows" != TUI.env.ua.os || (a.find(".bar").css({
            opacity: .3
        }),
        a.find(".bar").bind("mouseover", function() {
            h || (a.find(".bar").stop(),
            a.find(".bar").animate({
                opacity: 1
            }, 400),
            h = !0)
        }),
        a.find(".bar").bind("mouseleave", function() {
            h && (a.find(".bar").stop(),
            a.find(".bar").animate({
                opacity: .3
            }, 600),
            h = !1)
        }));
        0 != b.time && (p = setTimeout(this.close, b.time))
    }
    ).call(this);
    this.setContent(f);
    Widget.__count++
}
Widget.__zindex = 400;
Widget.__count = 0;
Widget.__top = 5;
Widget.__left = 0;
Widget.version = "1.0 beta";
function widget(f, b) {
    var d = new Widget(f,b);
    d.show();
    return d
}
;